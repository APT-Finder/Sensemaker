{
  "chain_3558": {
    "alerts_info": [
      "第1步攻击：T1593: 本规则检测到HTTP流量中携带有疑似恶意Powershell代码，使用System.Net.FtpWebRequest组件，可能通过恶意内容投递到受害终端并诱使用户执行，属于攻击者初步渗透的环节。  从08/13/2024-07:30:15开始到08/20/2024-08:47:21结束，共5条，其关键特征为检测到HTTP报文Body中包含System.Net.FtpWebRequest字符串|匹配到Powershell恶意模块特征，且流量方向为to_client（流入内部终端）|告警针对Windows平台客户端，说明攻击面主要为终端用户",
      "第2步攻击：T1140: 此规则检测到Qbot恶意文档在下载其恶意有效载荷（‘/Bmnby.png’）的过程。该行为通常通过将有效载荷伪装为图片文件以逃避安全检测，实现传输过程的隐藏和混淆。  从09/02/2024-04:50:11开始到09/02/2024-04:50:11结束，共4条，其关键特征为HTTP GET请求，URI以'/Bmnby.png'结尾并前有8-12位字母/数字目录，例如 '/abcdefghij/Bmnby.png'|Accept请求头包含'*/*'，且Connection请求头为Keep-Alive|HTTP请求头中无Referer字段，符合无典型浏览器访问源的恶意流量特征",
      "第3步攻击：T1059.005: 该告警检测到了攻击者通过Squiblydoo技术利用Windows的regsvr32.exe结合远程下载的脚本（.sct文件）实现代码执行。攻击者通常借助合法的系统工具（regsvr32）拉取并执行远程恶意脚本从而达到无需显式下载落地文件即可执行恶意代码的目的，绕过安全防护。  从09/11/2024-16:24:41开始到09/11/2024-16:24:41结束，共7条，其关键特征为HTTP响应体中包含<?XML且开头在前5字节，表明内容为XML格式脚本|响应中包含<scriptlet>和<registration>，明确特指Windows Scriptlet脚本注册组件|同时排除了<html>内容，避免与普通网页内容混淆；特征字符串FEEDACDC与已知Squiblydoo恶意样本相关",
      "第4步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/29/2024-00:15:20开始到09/29/2024-00:15:20结束，共2条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第5步攻击：T1021.002: 攻击者利用 SMB 协议在受害主机之间移动，通过访问或滥用命名管道实现横向传播。在攻击案例中，这可能用于在已感染的网络中扩展控制权。  从10/14/2024-12:03:53开始到12/28/2024-21:40:00结束，共6条，其关键特征为目的端口包括 139、445（标准 SMB 协议端口）|特定内容匹配：ASCII ‘SMB’ 字符串和 GUID '{7F9BCFC0-B36B-45EC-B377-D88597BE5D78}'，相关命名管道通讯|TCP 流向服务器，已建立连接，符合高级持续性威胁（APT）恶意软件典型通信行为",
      "第6步攻击：T1070.001: 攻击者通过SQL命令（sp_delete_alert）试图删除日志文件，以清除自身活动痕迹和入侵证据，规避检测。  从02/01/2025-19:19:44开始到02/01/2025-19:19:44结束，共3条，其关键特征为TCP协议，目的端口139（NetBIOS Session Service）|检测到sp_delete_alert存储过程的Unicode编码（混杂UTF-16）|流向内网数据库服务器，有长连接（established TCP session），发往高优先级目标"
    ],
    "此攻击链关联的原因": "该链条按TTP顺序及行为语义连接，包括武器化、恶意载荷获取、利用Windows系统工具远程执行、持久化计划任务创建、SMB协议横向移动及后续清痕，事件间时间间隔均在合理范围，APT典型攻击流程。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者起初通过HTTP流量携带恶意Powershell代码进行初步渗透（武器化、诱导），诱骗用户下载Qbot变种与恶意payload并混淆（载荷伪装），后续利用Squiblydoo技术远程代码执行（regsvr32执行.sct脚本），通过计划任务维持持久性，再利用SMB横向移动，最后清除日志规避检测，体现持续隐蔽攻击链。"
  },
  "chain_11251": {
    "alerts_info": [
      "第1步攻击：T1588.003: 攻击者生成或获取伪造的SSL证书，以用于加密通信，从而隐藏与恶意基础设施的连接并规避检测。  从08/19/2024-15:32:22开始到08/19/2024-15:32:22结束，共1条，其关键特征为特定SSL证书主题字段（Subject）中存在C=--, ST=SomeState, root@localhost.localdomain等可疑标识|SSL证书序列号中包含12:85，进一步指向特定恶意SSL证书|流量方向为外部网络到内部终端（from $EXTERNAL_NET:443 to $HOME_NET:any），建立状态为to_client",
      "第2步攻击：T1583.001: 检测到Havoc/Sliver等渗透测试工具框架自签名的TLS证书，这说明攻击者已建立并配置恶意C2服务器用于后续命令与控制通信。  从08/24/2024-20:16:44开始到08/27/2024-03:27:55结束，共3条，其关键特征为检测TLS证书字段内容（如US，Illinois，Naperville等与Havoc/Sliver保存一致）|匹配co字符串，表明使用特定的Issuer/Organization标识|未出现常规ASN.1 email OID（2a 86 48 86 f7 0d 01 09 01），强化活跃检测特征",
      "第3步攻击：T1090: 攻击者利用非法或特制的代理工具（如HTran），通过代理或隧道中转通讯流量，实现隐藏通信源头、绕过安全检测与网络边界管控，提升对目标的长期控制能力。  从10/23/2024-11:03:51开始到11/04/2024-21:49:29结束，共7条，其关键特征为代理流量匹配特定HTran协议标识|TCP协议，流向服务器端，状态已建立（flow:established,to_server）|数据报文中间具有固定特征|00 00 04 00 00 00|，高度说明为隐蔽通信协议的数据结构"
    ],
    "此攻击链关联的原因": "以TTP主线串联：T1588.003（伪造SSL证书用于隐藏基础设施）→T1583.001（搭建恶意C2服务器）→T1090（通过代理通信隐藏来源），三者可作为APT攻击链“资源获取—C2基础设施搭建—流量隧道与隐匿通信”阶段连续推进，时间顺序合理，存在“POTENTIAL_GAP（时间长，可能为持久渗透）”。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先伪造恶意SSL证书，为后续隐蔽通信做准备。随后检测到Havoc/Sliver框架的自签TLS证书，显示C2服务器建立。最终，HTran代理流量表明攻击流量已通过特殊隧道与C2隐藏通信，体现出高度隐蔽的持久化控制与后门管理。"
  },
  "chain_16060": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击者通过发送包含恶意Word文档（带有远程模板引用）的邮件诱使受害者打开，从而实现初始访问。此告警检测到.docx文档尝试从远程服务器（以IP为主机名）下载模板，属于远程模板注入，是典型的鱼叉式钓鱼附件技术。  从08/21/2024-09:12:34开始到08/21/2024-10:00:02结束，共3条，其关键特征为HTTP GET 请求，远程 URI 结尾为 .docx|User-Agent 包含 \"ms-office\" 字样|Host 字段为纯数字 IP（无域名），无 Referer 头",
      "第2步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从08/23/2024-14:56:13开始到08/23/2024-14:56:13结束，共1条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第3步攻击：T1059.005: 攻击者利用VBS脚本在受害主机上执行命令。该规则检测到VBS对象调用Shell.Application，进一步通过ShellExecute运行PowerShell命令，实现恶意代码在系统上的执行。  从09/02/2024-18:14:45开始到09/05/2024-03:36:58结束，共4条，其关键特征为HTTP响应状态码为200，内容来自服务器端|文件数据中出现ActiveXObject('Shell.Application')的VBS脚本代码，暗示在客户端执行脚本|VBS利用ShellExecute调用Base64编码的PowerShell命令（-EncodedCommand），实现恶意脚本落地执行",
      "第4步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从09/18/2024-06:04:09开始到09/18/2024-06:04:09结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。"
    ],
    "此攻击链关联的原因": "本链路依据TTP顺序（鱼叉式钓鱼→载荷解混淆→脚本执行→持久化）、时间连续（均为同一年内、无超长断点）、行为语义（文档诱导、脚本解混淆、落地持久化）串联全部告警。部分VBS与PowerShell关联通过sec_ttps辅助推理补充命令衔接。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过鱼叉式钓鱼邮件（远程模板注入恶意Word文档）诱导用户并初始入侵，在终端执行混淆PowerShell脚本完成载荷释放和规避检测，随后利用VBS启动PowerShell命令实现恶意代码深度执行，最终通过篡改Startup目录与rundll32设置持久化，形成一条从入侵到落地驻留的完整APT链路。"
  },
  "chain_10567": {
    "alerts_info": [
      "第1步攻击：T1588.002: 该告警检测到Havoc/Sliver等后门框架颁发的特征性TLS证书，表明攻击者针对中后期活动专门生成或滥用服务器数字证书，通常用于躲避检测、建立C2基础设施，从而构建恶意远控通信通道。  从08/22/2024-03:25:12开始到08/22/2024-03:37:08结束，共4条，其关键特征为匹配特定的TLS证书字段（如国家US、省份Connecticut、城市Norwalk等），与Sliver/Havoc默认或已知伪造证书结构特征高度吻合。|证书内存在字段内容如“Test”，属于常见的Sliver/Havoc框架自签名证书特征。|检测基于TLS握手，以流量到客户端为主，往往映射为远程控制服务器向被控主机进行证书下发，隐藏框架身份。",
      "第2步攻击：T1218.011: 攻击者利用Windows自带的CertUtil工具来下载和执行恶意可执行文件（.exe），以绕过安全检测并规避防御措施。CertUtil常被合法使用，因此易于被滥用，成为Living-off-the-land Binaries (LOLBins)的一部分。  从09/01/2024-10:23:08开始到09/01/2024-10:54:29结束，共6条，其关键特征为http请求URI结尾为.exe，表明请求可能是用于下载Windows可执行文件|User-Agent字段为'CertUtil URL Agent'，显示是用CertUtil工具发起的HTTP请求|HTTP头部顺序和内容极为特定且缺少Referer、Cookie和Accept-字段，指向自动化、非浏览器工具的下载行为",
      "第3步攻击：T1036.004: 攻击者通过将恶意流量的 User-Agent 伪装成主流浏览器（如'Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko'），绕过防护产品或欺骗流量分析工具，实现恶意通信的防御规避。  从09/07/2024-22:09:18开始到09/07/2024-22:09:18结束，共2条，其关键特征为HTTP 流量出站，目的地为外部网络（$EXTERNAL_NET）|User-Agent 伪造为 'Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko'",
      "第4步攻击：T1036.005: 该告警检测到了Dreambot、Ursnif等恶意软件通过HTTP POST请求上传文件，并伪装成图像资源（如 .png/.jpg 等），试图隐藏真实的上传行为以绕过安全检测。  从09/14/2024-19:33:27开始到09/14/2024-19:33:27结束，共1条，其关键特征为HTTP POST请求，目标路径为/images/，并且以_2F或_2B结尾，扩展名为.avi/.gif/.bmp/.jpeg/.png|Content-Length为2，且User-Agent头存在，Referer和Accept头无|与Dreambot/ISFB/Ursnif恶意家族相关，可能上传空文件（探测通信或信道建立行为）",
      "第5步攻击：T1562.004: 攻击者通过系统命令（如netsh）禁用或绕过主机防火墙，以规避检测并允许后续恶意活动（如数据渗出、远程控制等）。本告警检测到netsh防火墙相关输出，表明防火墙配置被修改或禁用。  从10/03/2024-03:17:59开始到10/03/2024-03:17:59结束，共1条，其关键特征为检测内容包含'netsh firewall|22| is deprecated|3b|'——识别系统防火墙配置相关输出|检测内容包含'use |22|netsh advfirewall'——表明与防火墙操作相关的系统消息|tcp流中存在'Ok.'输出，结合context为Windows命令行操作的响应"
    ],
    "此攻击链关联的原因": "凭借TTP时间进展及行为联系：伪造C2证书建立基础设施（T1588.002），后利用CertUtil下发恶意可执行文件（T1218.011），再伪装User-Agent实现通信和回传（T1036.004/005），最后通过系统命令规避防火墙（T1562.004）；部分跳步但链路逻辑连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先为C2通信准备伪造TLS证书，随后利用CertUtil下载恶意二进制文件植入系统，通过多种User-Agent伪装数据通信和文件上传行为，期间进行权限规避操作（如禁用防火墙），展现了典型的中后期攻击链，包括基础设施准备、工具投递、隐蔽通信和防御规避等阶段。"
  },
  "chain_2104": {
    "alerts_info": [
      "第1步攻击：T1027.003: 攻击者通过将配置信息隐藏（嵌入）到图片文件中来混淆恶意内容，实现数据隐藏并规避检测。这种利用图片文件传递配置数据的方式，是一种经典的隐写术（Steganography）手段。  从08/22/2024-08:21:45开始到08/22/2024-08:24:01结束，共3条，其关键特征为当前流量为 HTTP，方向为服务器到内部主机，且已建立连接（flow:from_server,established）|图片文件内存在特定的二进制与文本签名（内容 '0103F|00|'，后随'|ff fe|'，正则匹配完整特征）|利用文件内容长度、无零字节等细粒度检测表明为带有嵌入数据的图片结构，且流量已判定为Zberp家族活动（flowbits:isset,ET.Zberp）",
      "第2步攻击：T1059.001: 攻击者利用PowerShell脚本，在目标系统上下载执行恶意代码。这通常用于初始感染阶段，通过脚本自动化恶意payload的拉取和部署。  从08/25/2024-13:17:19开始到08/25/2024-15:14:13结束，共5条，其关键特征为从服务器返回的数据流中检测到经过Base64编码的PowerShell关键字（如 'Start-Process'、'Write-Host'），表明其中嵌有可疑脚本内容。|HTTP协议环境下传递，利用PowerShell downloader原语特征字符串，匹配典型PowerShell downloader流量特征。|命中特征的流量涉及Windows各版本常见终端，表现出针对端点客户端的攻击企图。",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从08/22/2024-06:13:44开始到08/22/2024-06:13:44结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从08/29/2024-07:44:49开始到08/29/2024-07:47:25结束，共2条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第5步攻击：T1071.004: 该规则检测到基于DNS协议（尤其是DNS TXT记录）的命令与控制通信。这种通信常见于恶意软件利用DNS隧道进行C2流量、规避检测。特定于PowerShell Implant通过DNS通道获取指令或发送回传信息。  从09/02/2024-00:22:19开始到09/02/2024-00:22:19结束，共5条，其关键特征为DNS协议，TCP 53端口，from_server流量|请求中包含特定字符串 mail、'=', '+', ';' 等特征码，疑似编码或协议标识符|正则检测Base64 编码片段及其它 PowerShell 相关指纹，表明为异常DNS TXT数据",
      "第6步攻击：T1071.004: 攻击者利用DNS协议的TXT记录进行命令与控制，将恶意PowerShell代码通过DNS数据通道下发至受害主机，绕过传统网络安全防御。  从09/10/2024-11:30:56开始到09/10/2024-12:54:21结束，共4条，其关键特征为DNS流量中TXT查询类型（content: \"|00 10|\"）|数据包内容包含PowerShell命令关键字（如powershell、New-Object Net.WebClient).DownloadString()）|协议特征位于DNS的application payload中，通常用于利用DNS隧道绕过内容安全检测",
      "第7步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏远控工具与攻击者C2服务器之间的通信，避免被检测。  从09/17/2024-16:19:37开始到09/17/2024-16:19:37结束，共4条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为加密C2通信生成的伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险"
    ],
    "此攻击链关联的原因": "根据TTP推进（混淆-初始执行-持久化-凭证窃取-命令与控制/C2隧道-加密流量后门）、时间顺序及各阶段行为语义连续，数个alert通过辅助TTP和特征脱敏行为串联，有力构成完整APT链。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP隐写术（图片配置混淆）进行渗透，随后以PowerShell脚本下发与执行，完成恶意代码植入，实现持久化。继而使用凭证dump导出敏感信息，借助DNS隧道及流量混淆实现持续C2和数据外泄，最终通过自签证书加密流量部署后门，完成全流程APT渗透与控制。"
  },
  "chain_13519": {
    "alerts_info": [
      "第1步攻击：T1547.006: 攻击者通过加载恶意内核模块GrayFish等专用rootkit来实现对受害Linux/Unix系统的持久化和隐蔽性控制。这种方式常被用于Rootkit类后门，能够长时间绕过检测。  从08/22/2024-06:14:48开始到08/22/2024-06:26:22结束，共3条，其关键特征为使用TCP协议，源端口为666，目标端口为4444，极富特征|流量未建立正常会话（not_established），包体数据小于40字节|包内含有典型字符串“hax0r”",
      "第2步攻击：T1059.001: 该告警检测到中国菜刀（China Chopper）Web Shell命令执行结构，利用PowerShell等脚本特性，远程执行攻击者发送的命令。攻击者通常通过webshell上传后控制Web服务器，利用如'FromBase64String'和'eval('等特征触发远程命令执行。  从09/07/2024-01:37:55开始到09/08/2024-04:46:19结束，共3条，其关键特征为HTTP POST方法携带恶意命令（http.method:POST）|特定请求体内容出现Base64解码及eval（FromBase64String, eval(, unsafe）|请求体参数（如&z）和正则命令结构（如pcre:/^\\d{1,3}=）匹配中国菜刀命令格式",
      "第3步攻击：T1547.001: 检测到Win32.TrojanProxy类木马下载其配置文件，这通常用于实现或维持该恶意软件的持久化。在目标主机上持续运行代理型木马程序，通常会通过配置文件下发命令和C2信息，保证木马自动启动与反复控制。  从08/22/2024-12:49:13开始到08/22/2024-12:49:13结束，共1条，其关键特征为HTTP协议传输，流量方向为服务器到客户端（from_server）|配置文件内容含有标志性字符串“@$@”，并紧接base64编码结构（详见正则规则）|敏感文件传递常出现在POST响应体或文件型URL路径",
      "第4步攻击：T1112: 攻击者模块实现注册表项创建或修改，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从12/28/2024-14:55:13开始到12/28/2024-14:55:13结束，共1条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含注册表操作相关特征|触发条件为恶意注册表操作与被控端交互，指向主动注册表操作",
      "第5步攻击：T1027: 该恶意采集器试图以压缩包数据文件（data.zip）进行数据传输，通过文件打包、编码或混淆的形式，避开防御系统监测，达到防御规避目的。  从08/24/2024-23:35:04开始到08/24/2024-23:46:08结束，共5条，其关键特征为TCP流已建立，并流向外部网络（flow:established,to_server）|数据内容中包含特定字符串“Grabbers\\data.zip”|威胁源自木马恶意采集器，涉及数据采集和外泄",
      "第6步攻击：T1564.001: 告警检测到HTTP POST请求体内包含特征码'PK'，表明数据为ZIP压缩格式，说明攻击者可能通过加密（压缩）文件隐藏、绕过安全检测，将敏感信息（如Cards_Google.txt）上传到外部网络，实现防御规避。  从09/21/2024-13:38:31开始到09/21/2024-13:38:31结束，共1条，其关键特征为HTTP POST方法（http.method; content:\"POST\"）|请求体中出现ZIP文件头特征值'PK'（http.request_body; content:\"PK\"）|请求体中传输名为'Cards_Google.txt'的文件（content:\"Cards_Google.txt\"）"
    ],
    "此攻击链关联的原因": "主要基于TTP相继推进（持久化、命令执行、注册表操作、混淆规避和数据渗漏），时间顺序及部分木马和后门持久化方式贯穿始终。次要关联部分借助辅助TTP和其行为描述实现链路闭合。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于通过rootkit实现内核级持久化及隐蔽，然后利用Web shell远程命令执行获取控制权，下载配置文件及利用注册表操作实现木马持久化。攻击者进一步通过数据打包混淆和压缩外泄敏感信息，贯穿多阶段防御规避、持久渗透和数据泄漏行为，展示复杂持续性攻击流程。"
  },
  "chain_7122": {
    "alerts_info": [
      "第1步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/22/2024-06:21:03开始到08/22/2024-06:21:03结束，共1条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第2步攻击：T1003.001: 告警检测到SMB流量中传输了由Mimikatz工具相关的mimidrv.sys模块，该模块常用于从LSASS等内存中提取凭证。攻击者通常在获取目标主机的访问权限后，使用Mimikatz提取操作系统存储的明文账户密码、哈希或其他认证信息，从而进行后续横向移动或提权。  从08/22/2024-09:36:52开始到08/25/2024-23:55:17结束，共3条，其关键特征为TCP 139 或 445 端口（SMB协议）|SMB数据包包含特定字节序列：|FF|SMB|a2||SMB流量中出现文件名字符串：mimidrv.sys",
      "第3步攻击：T1021.001: 该规则检测SMB（端口139/445）上的特殊Impacket工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从08/30/2024-17:51:45开始到09/04/2024-02:45:19结束，共5条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'出现在SMB流量内容中，指向Impacket工具的某种变体或obfuscation处理。",
      "第4步攻击：T1562.004: 攻击者通过系统命令（如netsh）禁用或绕过主机防火墙，以规避检测并允许后续恶意活动（如数据渗出、远程控制等）。本告警检测到netsh防火墙相关输出，表明防火墙配置被修改或禁用。  从09/19/2024-11:36:29开始到09/19/2024-11:36:29结束，共1条，其关键特征为检测内容包含'netsh firewall|22| is deprecated|3b|'——识别系统防火墙配置相关输出|检测内容包含'use |22|netsh advfirewall'——表明与防火墙操作相关的系统消息|tcp流中存在'Ok.'输出，结合context为Windows命令行操作的响应",
      "第5步攻击：T1562.001: 攻击者尝试绕过Windows反恶意软件扫描界面（AMSI），以避免恶意Powershell脚本被检测到。该技术通过利用AMSI的缺陷或对其进行禁用，使得后续恶意行为可以隐蔽执行。  从09/25/2024-23:41:02开始到09/25/2024-23:41:02结束，共1条，其关键特征为HTTP流量中包含 '<script' 关键字，指示为含脚本的网页内容。|脚本内容中带有关键字 'powershell'，表明涉及Powershell命令调用。|脚本内存在base64编码字符串 'YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBk'（解码为'amsiInitFailed'，是尝试绕过AMSI的典型指标）。",
      "第6步攻击：T1055.002: 该告警检测到Dtrack自定义RAT或恶意shellcode payload通过会话传输到主机，典型用于Dtrack等工具远程植入并执行驻留型恶意代码，属于进程注入或远程payload投递。  从10/08/2024-07:23:11开始到10/23/2024-21:20:05结束，共4条，其关键特征为流量为已建立TCP会话，方向为from_server，符合远程控制工具下发payload的常见流量特征。|内容特征匹配PE可执行文件头（‘MZ’和‘PE\\x00\\x00’），及特定的Windows DOS模式字符串，表明有效载荷为Windows可执行格式。|fast_pattern与flowbits设置配合累计上下文，减少误报并关联后续检测（如Dtrack session activity）。",
      "第7步攻击：T1555.003: 该告警检测到Win32/BrowserPassview恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从11/18/2024-12:14:07开始到12/01/2024-20:20:42结束，共3条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。",
      "第8步攻击：T1070.001: 攻击者通过SQL命令（sp_delete_alert）试图删除日志文件，以清除自身活动痕迹和入侵证据，规避检测。  从01/10/2025-03:46:51开始到01/10/2025-03:46:51结束，共1条，其关键特征为TCP协议，目的端口139（NetBIOS Session Service）|检测到sp_delete_alert存储过程的Unicode编码（混杂UTF-16）|流向内网数据库服务器，有长连接（established TCP session），发往高优先级目标"
    ],
    "此攻击链关联的原因": "基于TTP流转（持久化→凭证访问→横向移动→防御规避→注入与信息窃取→痕迹清除），时间顺序清晰且告警特征语义高度连贯，反映典型渗透-内网活动链。部分TTP有行为短跳但主线完整。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击以高权限计划任务持久化启动，使用Mimikatz窃取凭证，利用Impacket进行SMB横向移动，随后通过netsh及AMSI绕过进行防御规避，通过Dtrack自定义RAT或恶意shellcode payload远程植入shellcode并进一步信息窃取（如浏览器密码），末尾清理日志掩盖行踪，完整贯穿渗透、扩展、持久与痕迹清除阶段。"
  },
  "chain_22388": {
    "alerts_info": [
      "第1步攻击：T1190: 该告警检测到使用Mirai类恶意软件常见特征（JarryWut User-Agent），结合设备IoT/服务器的公开HTTP服务，表明攻击者尝试通过面向公网的应用服务进行攻击渗透。此行为通常属于主动探测和利用初始访问入口。  从08/22/2024-07:18:10开始到08/22/2024-09:02:28结束，共3条，其关键特征为HTTP User-Agent为Mirai变种常用JarryWut字符串|入站（inbound）HTTP请求流量，方向为external->内部|针对IoT或Linux系统的公网HTTP服务，流量已建立到服务器方向",
      "第2步攻击：T1583: 攻击者注册和使用 dwn-files.shop 这样的域名，作为后续攻击（如命令与控制、恶意文件分发等）中的基础设施. 从08/23/2024-08:21:15开始到08/23/2024-13:42:54结束，共3条，其关键特征为TLS SNI中包含恶意域名dwn-files.shop|流量特征为established连接且方向为to_server|适用TLS通信，关键字段为SNI（Server Name Indication），匹配14字节长度",
      "第3步攻击：T1566.002: 此规则检测到客户端在TLS握手过程中向外部主机发送的SNI包含恶意钓鱼域名（.nbcbcapital.com），可能关联钓鱼行动。攻击者可能借助该链接实施凭据收集或恶意载荷投递。  从08/24/2024-11:32:21开始到08/24/2024-11:32:21结束，共1条，其关键特征为捕获TLS握手阶段SNI字段包含“.nbcbcapital.com”钓鱼域征兆|数据流向从本地$HOME_NET向外部$EXTERNAL_NET，表明用户主动访问恶意外部服务",
      "第4步攻击：T1036.005: 此告警涉及恶意软件使用与合法应用类似的用户代理（如WinHttpRequest）和文件命名（/IERinstal.a），旨在欺骗监控工具或安全人员，使网络请求看起来像是正常的系统或应用行为，从而绕过安全防护和检测。  从08/24/2024-11:49:02开始到08/24/2024-12:03:14结束，共3条，其关键特征为HTTP协议、GET方法|请求的URI路径为/IERinstal.a，长度21|User-Agent为'Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)'，模拟合法流量特征",
      "第5步攻击：T1027: 攻击者通过对JavaScript代码进行十六进制和双反斜杠混合转义，实施堆喷射(shellcode heap spray)，以规避安全检测机制。这种混淆手段能掩盖恶意payload实际内容，增加安全设备分析难度。  从08/25/2024-09:15:11开始到08/25/2024-09:15:11结束，共3条，其关键特征为HTTP协议流，方向为外部到本地、面向客户端的HTTP流量|内容特征为多个‘\\\\x0b’样式的JavaScript代码（双反斜杠加十六进制0b，频繁重复）|通常出现在script标签、内嵌JavaScript或加载第三方脚本的HTTP响应体中",
      "第6步攻击：T1059.001: 告警内容检测到PowerShell启动脚本，这表明攻击者可能尝试远程在终端系统上执行恶意PowerShell代码。PowerShell常被攻击者用于下载、执行恶意载荷，并进一步控制受害者系统。  从08/28/2024-22:06:54开始到08/28/2024-22:06:54结束，共4条，其关键特征为HTTP响应内容包含<script与powershell关键字，指示存在嵌入型或交付型PowerShell脚本|匹配特定Base64字符串“KAAsACQAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAo”，表征Veil等工具生成的PowerShell编码片段|流量方向来自服务器端（from_server），说明恶意代码通过服务端发送下发给客户端（例如浏览器）",
      "第7步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从10/26/2024-11:15:18开始到10/26/2024-11:15:18结束，共2条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）"
    ],
    "此攻击链关联的原因": "以初始访问（T1190）、基础设施搭建（T1583）、钓鱼（T1566）、伪装流量及混淆（T1036.005/T1027）、最终到达远程代码执行（T1059.001），时间序与TTP进阶吻合；部分阶段仅依据辅助TTP或行为语义，存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该攻击链由Mirai类对IoT服务的初始渗透和扫描启动，结合新恶意域名搭建（可能作C2），继而出现类钓鱼和伪装流量行动，包含诱导恶意内容下载，并通过混淆及脚本（如Powershell）实现恶意代码下发及远程执行，体现由外部投递到目标系统控制的多步攻击流程。"
  },
  "chain_24220": {
    "alerts_info": [
      "第1步攻击：T1566.002: 攻击者通常利用社工邮件夹带高压缩ZIP文件，诱导用户下载并打开内含DLL远控木马PlugX，从而实现在目标主机初步植入。此次告警发现外部来源向内网主机下发高压缩zip格式附件，常配合邮件等钓鱼手段进行传播。  从08/22/2024-08:16:04开始到08/22/2024-08:47:25结束，共3条，其关键特征为HTTP响应内容为zip格式文件，内容体起始为ZIP文件头PK\\x03\\x04，表明实际传递的是压缩档案。|ZIP附件中含DLL文件(.dll)，高度压缩后传送（体积<1MB但原始数据>200MB，常见恶意免杀压缩特征）。|HTTP头部含Content-Disposition: attachment; filename=\".zip\"以及Content-Transfer-Encoding: binary，标明为主机下载型文件，且cookie字段带13位ID，具备恶意自动下载指征。",
      "第2步攻击：T1568.002: 该告警检测到恶意软件通过DNS协议来通信，用于命令与控制渠道，表现为DNS Sinkhole返回特定IP，说明受控主机尝试与C2（命令与控制服务器）联系，但被重定向到Dr. Web的Sinkhole（拦截）地址。  从08/27/2024-23:26:11开始到08/29/2024-11:43:37结束，共3条，其关键特征为DNS协议响应数据包（00 01 00 01）|包含特定A记录响应（00 04 5b e9 f4 6a，对应91.*.*.106 - Dr. Web Sinkhole地址）|与已知恶意域名或威胁情报匹配（virustracker.info作为参考来源）",
      "第3步攻击：T1056.001: Win32/Spy.Tuscas是一种信息窃取类木马，通过HTTP请求收集被感染主机的系统信息、组信息、客户端信息、操作系统版本和网络延迟等敏感数据，属于攻击者在感染主机后执行数据收集任务的表现。  从09/21/2024-21:30:27开始到10/08/2024-17:09:48结束，共5条，其关键特征为HTTP请求URI中包含参数：?version=&group=&client=&computer=&os=&latency=|HTTP请求缺少典型头部，如’Accept’和‘Referer’|目的地为外部网络（$EXTERNAL_NET），方向为from $HOME_NET to $EXTERNAL_NET，表示内网向外发送敏感数据"
    ],
    "此攻击链关联的原因": "依托TTP主线T1566.002（初始访问-钓鱼邮件压缩包）、T1568.002（DNS隧道C2通信）、T1056.001（信息收集与外发），均按照攻击链逻辑时间先后排列，主TTP间语义连贯，允许中间步骤缺失，根据TTP描述与行为特征合理推断阶段演进，符合常见木马感染-远控-窃取信息流程。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链从社工邮件携高压缩ZIP档案（含DLL木马）发起初始投递，实现目标主机植入。随后受控主机通过DNS隧道与C2通信（已被sinkhole拦截），表明后续远控活动。最终，木马收集并外发主机敏感信息，表现出自始至终的数据渗透和信息窃取行为，展现典型木马APT行动全貌。"
  },
  "chain_4000": {
    "alerts_info": [
      "第1步攻击：T1082: 该规则检测到通过PowerShell脚本对PROCESSOR_ARCHITECTURE环境变量的访问，该行为通常用于远程攻击者识别受害主机的处理器架构信息，从而确定后续载荷投放或利用路径。此类系统信息发现行为属于攻击者在受害主机上进行环境摸底的典型动作。  从08/22/2024-08:22:38开始到08/22/2024-08:22:38结束，共1条，其关键特征为HTTP响应体中包含“\\Environment\\PROCESSOR_ARCHITECTURE”关键字，指示访问了系统环境变量。|正则提取环境变量赋值，格式示例：[a-z0-9]{1,20} = 'x86' 或 'x64'，检出主机CPU架构信息。|为入站HTTP通信，响应状态码为200，排除了请求内容包含“\\Software\\InstallShield\\”的情况，降低了误报概率，并指向定制化PowerShell脚本行为。",
      "第2步攻击：T1105: 该Snort规则检测HTTP GET请求下载名为logo.png的文件，通常用于恶意软件通过HTTP渠道从远程服务器下载载荷或组件，属于典型的工具传送技术。APT攻击者利用该技术将后门或其他恶意工具传送到受害主机，实现远程控制和后续行动。  从08/23/2024-11:35:10开始到08/24/2024-16:49:58结束，共5条，其关键特征为HTTP协议流量，目标端口80|HTTP GET方法，URI为/images/logo.png|Accept头为*/*,,,,,,，使用异常或伪造HTTP头部可能试图绕过检测",
      "第3步攻击：T1105: 该行为表现为攻击者通过 HTTP 下载可执行文件（如恶意 payload）到受害主机，是投递远控木马、dropper 或后门等工具的常见方式，辅助后续控制或内网渗透操作。  从09/01/2024-03:19:27开始到09/10/2024-09:27:55结束，共3条，其关键特征为HTTP协议下，直接请求可疑域名获取PE型可执行文件|检测内容：文件以'MZ'魔数开头且有有效的PE头，确认下载对象为Windows可执行文件|检测请求头或流特征伪装为浏览器请求，且域名被标识为疑似恶意（flowbits: ET.Suspicious.Domain.Fake.Browser）",
      "第4步攻击：T1071.001: 威胁行为者利用HTTP POST请求，将受害主机的系统信息及敏感数据（如Cookie、操作系统、信用卡等）通过Web流量发送到攻击者控制的服务器，实现与C2服务器的通信。  从10/26/2024-18:48:41开始到10/26/2024-18:48:41结束，共6条，其关键特征为HTTP协议POST方法，通信方向为内网到外网（to_server）|HTTP请求体中特征字符串：data=[{\"Cookie\":\"...\",\"Os\":...,\"Creditcard\":...}]&type=&arg=|内容包含系统信息和敏感数据（Cookie、操作系统、信用卡信息）结构化打包上报，无URL参数和分隔符（如&、?、.）"
    ],
    "此攻击链关联的原因": "以TTP时间序列建立链路：初步信息收集（T1082, TA0007）后，连续2次工具投递（T1105, TA0009），最终出现通过HTTP通道外传敏感数据（T1071.001, TA0011）。虽然各环节间存在一定时间跨度（最大约半年，POTENTIAL_GAP），但TTP演进及行为描述合理，支撑攻击链推断。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先利用PowerShell脚本收集受害主机环境与处理器架构信息（T1082），随后两次通过HTTP分别下载伪装及PE可执行文件工具（T1105），表明在提升对主机控制权限或植入后门。攻击后期，通过HTTP POST方式将系统敏感数据结构化渗出（T1071.001），形成典型的“信息收集→工具投递→数据外泄”攻击流程。"
  },
  "chain_19430": {
    "alerts_info": [
      "第1步攻击：T1190: 该告警检测到攻击者利用CVE-2021-40444漏洞通过远程恶意Office文档中的嵌入式MSHTML组件对客户端应用进行远程代码执行。攻击者通过伪造的或恶意构造的HTTP响应，在用户端加载恶意ActiveX对象，实现远程执行代码，达到入侵目的。  从08/22/2024-08:34:20开始到08/22/2024-08:45:19结束，共3条，其关键特征为HTTP响应中的状态码为200，表明攻击载荷成功返回。|有效载荷包含< script >与new ActiveXObject(‘...’)等关键ActiveX相关内容，疑似利用MSHTML引擎漏洞|多次出现.cpl:文件和.. /路径，表明有意调用恶意控制面板项，同时存在目录穿越意图。",
      "第2步攻击：T1140: 检测到HTTP请求URL中存在Base64编码且疑似恶意（字符串“aGFja2Vk”解码后为“hacked”），攻击者常使用Base64编码隐藏命令、有效载荷、或将恶意内容隐藏于通信之中，从而规避检测。  从08/24/2024-21:03:18开始到08/24/2024-21:03:18结束，共1条，其关键特征为HTTP请求的URL中出现Base64编码的字符串（例如“aGFja2Vk”）|HTTP请求未包含Referer头，常见于自动化工具、恶意流量或无Referer的攻击代码|通信方向为$HOME_NET发起至$EXTERNAL_NET，表示内部主机主动访问外部，可能为回连或数据外泄行为",
      "第3步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件的持久化机制相关联。  从09/02/2024-13:56:51开始到09/02/2024-13:56:51结束，共4条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第4步攻击：T1071.001: 检测到POWRAT通过Web协议与C2服务器建立通信，进行命令与控制渠道的建立。该类通信常用于远控型木马与攻击者之间的数据和命令交换。  从09/16/2024-17:15:34开始到10/11/2024-09:29:29结束，共9条，其关键特征为TCP通信，方向为内网主机到外部服务器 (流向 established,to_server)|负载内容特征包含|负载内容特征：|00|ll0101010100 出现在偏移2的位置，16字节内|包含字符串特征：'00Win '等。"
    ],
    "此攻击链关联的原因": "告警T1190通过远程代码执行实现初始入侵，T1140显示数据隐藏传输，随后T1053.005反映持久化机制（SMB命名管道），最终T1071.001体现C2通讯，时序和TTP递进逻辑严密，链路完整；T1140阶段通过其辅助TTP与下游告警在语义与行为上形成衔接。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先利用CVE-2021-40444进行远程代码执行初步入侵，紧接着通过Base64编码隐藏通信内容实施流量伪装，再在目标系统上借助SMB命名管道与计划任务实现持久化，最终通过Web协议建立C2隧道，实现命令与控制及数据窃取，充分展示了多阶段APT攻击流程。"
  },
  "chain_13333": {
    "alerts_info": [
      "第1步攻击：T1566.002: 此告警检测到通过TLS SNI中带有已知钓鱼域名.bc1q6crq62w2sclm0cwwk6m2wugr6jkh.com的流量，攻击者通常通过伪装成微软相关登录页面，引导受害者点击链接输入凭据，达到窃取账号信息的目的。  从08/22/2024-08:41:42开始到08/22/2024-08:41:42结束，共1条，其关键特征为TLS SNI 字段中包含可疑钓鱼域名.bc1q6crq62w2sclm0cwwk6m2wugr6jkh.com|流量方向为内网主机到外部网络，处于已建立的TLS会话中|告警与Microsoft凭证钓鱼活动相关，重点针对Windows客户端终端",
      "第2步攻击：T1068: 该告警检测到利用CVE-2023-29324漏洞的可疑负载，攻击者通过构造恶意邮件，在Windows Microsoft Outlook客户端中触发权限提升，进而获得更高权限。  从08/23/2024-14:40:02开始到08/23/2024-14:40:02结束，共2条，其关键特征为SMTP协议流量，目标为$HOME_NET或$SMTP_SERVERS|邮件内容含有特定的base64编码（如AElQTS5UYXNr）及可解码IPM.Task字符串|存在特定的二进制及路径特征（如\\IPM.Task\\），与CVE-2023-29324漏洞利用方式密切相关",
      "第3步攻击：T1083: 该告警检测恶意Payload（如DiceLoader）尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从08/26/2024-09:45:14开始到08/26/2024-17:32:29结束，共5条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与DiceLoader家族相关，且适用于Windows平台的多版本",
      "第4步攻击：T1562.004: 攻击者通过系统命令（如netsh）禁用或绕过主机防火墙，以规避检测并允许后续恶意活动（如数据渗出、远程控制等）。本告警检测到netsh防火墙相关输出，表明防火墙配置被修改或禁用。  从08/29/2024-02:22:45开始到08/29/2024-02:22:45结束，共1条，其关键特征为检测内容包含'netsh firewall|22| is deprecated|3b|'——识别系统防火墙配置相关输出|检测内容包含'use |22|netsh advfirewall'——表明与防火墙操作相关的系统消息|tcp流中存在'Ok.'输出，结合context为Windows命令行操作的响应",
      "第5步攻击：T1036: 攻击者尝试通过在HTTP POST数据中混入如“C:\\WINDOWS\\”等系统目录名称，使得恶意流量看起来像是合法的系统通信，从而迷惑检测机制，提高恶意行为的隐蔽性。  从08/25/2024-10:27:12开始到08/25/2024-10:27:12结束，共1条，其关键特征为HTTP POST请求（http.method: POST）|请求体（http.request_body）中包含十六进制编码的C:\\WINDOWS\\路径|目的主机过滤主流安全厂商和某些知名服务域名，且User-Agent规避Elastic-winlogbeat",
      "第6步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从10/15/2024-08:12:22开始到10/15/2024-08:12:22结束，共4条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第7步攻击：T1041: 恶意代码通过已建立的C2通道（HTTP POST请求）将系统信息回传至外部攻击者指定的服务器，典型的数据渗出手段。  从01/16/2025-23:48:54开始到01/17/2025-03:27:31结束，共3条，其关键特征为HTTP POST请求，URI为/log|请求体包含info=和特定分隔符“|7c|”|HTTP请求头无Referer字段，特征化恶意通信"
    ],
    "此攻击链关联的原因": "以初始钓鱼（T1566.002）为入口，借助辅助TTP（T1566.001）将提权（T1068）、主机发现（T1083）、防御绕过（T1562.004）、命令与控制（T1036）、凭证转储（T1003）和数据外泄（T1041）等阶段串联，涵盖信息窃取、渗透、数据回传主要行为，时间上前后紧密。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击从钓鱼入口引发，成功实现初始渗透后，通过漏洞提权（CVE-2023-29324）、主机枚举（Loda Logger）、修改系统防火墙、流量伪装实现持久控制与规避，再通过凭证转储（如procdump提取内存）和受控主机的数据外泄，逐步实现信息窃取、渗透、持久及数据传出，展示了典型APT链式攻击的完整过程。"
  },
  "chain_616": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击者通过HTTP协议将包含有恶意的 .lnk 文件的.zip压缩包传递给目标系统，通常用来诱导受害者打开，从而执行后续恶意操作。  从08/22/2024-08:51:31开始到08/22/2024-09:13:19结束，共3条，其关键特征为HTTP协议流量，方向为外部到内部（to_client）|.zip归档中包含文件名为.pdf.lnk的文件|文件数据以'PK' ZIP文件头标志开头，isdataat确保归档足够大",
      "第2步攻击：T1059.001: 攻击者利用带有PowerShell脚本的恶意文档对受害主机执行命令，并通过PowerShell加载、解码和运行后续载荷，常用于初始访问后自动化持久化和后门下载。  从08/26/2024-19:22:05开始到08/26/2024-19:22:05结束，共4条，其关键特征为HTTP协议，流向为 established, to_client，说明是服务器向客户端推送payload|特定的PowerShell关键词组合如Set-StrictMode -Version、GetType('Microsoft.Win32.UnsafeNativeMethods')、GetMethod('GetProcAddress')、SetImplementationFlags('Runtime')|Base64解码函数[System.Convert]::FromBase64String(“TVr...”)声明和使用，配合混淆payload",
      "第3步攻击：T1082: 该规则检测到通过PowerShell脚本对PROCESSOR_ARCHITECTURE环境变量的访问，该行为通常用于远程攻击者识别受害主机的处理器架构信息，从而确定后续载荷投放或利用路径。此类系统信息发现行为属于攻击者在受害主机上进行环境摸底的典型动作。  从01/14/2025-11:17:43开始到01/14/2025-11:17:43结束，共3条，其关键特征为HTTP响应体中包含“\\Environment\\PROCESSOR_ARCHITECTURE”关键字，指示访问了系统环境变量。|正则提取环境变量赋值，格式示例：[a-z0-9]{1,20} = 'x86' 或 'x64'，检出主机CPU架构信息。|为入站HTTP通信，响应状态码为200，排除了请求内容包含“\\Software\\InstallShield\\”的情况，降低了误报概率，并指向定制化PowerShell脚本行为。"
    ],
    "此攻击链关联的原因": "基于TTP链条由鱼叉式钓鱼（T1566.001，TA0001）诱骗.zip归档落地，再到恶意PowerShell脚本执行（T1059.001，TA0002），最后系统信息收集（T1082，TA0007）；行为语义连续，时间顺序合理，虽然时序有较大跨度，存在POTENTIAL_GAP，但整体链条成立。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP鱼叉钓鱼传递伪装的.zip归档诱使用户打开（T1566.001），随后利用PowerShell脚本实现命令与混淆payload的下发及远程代码执行（T1059.001），最后通过定制脚本对受害主机处理器架构等关键信息进行摸底侦查（T1082），链路反映了典型邮件诱导入侵—自动化载荷执行—系统侦查一体化流程。"
  },
  "chain_25366": {
    "alerts_info": [
      "第1步攻击：T1189: 攻击者通过操控网页向目标用户分发恶意ActiveX控件，利用浏览器漏洞实现初始访问。从流量来看，恶意HTTP流量向客户端分发带有特定CLSID的ActiveX控件，尝试触发缓冲区溢出，实现对主机的首次控制。 从08/22/2024-09:03:25开始到08/22/2024-09:15:48结束，共7条，其关键特征为HTTP协议中包含<OBJECT>标签，包含ActiveX控件定义|classid字段中存在0297D24A-F425-47EE-9F3B-A459BCE593E3（SaschArt SasCam Webcam Server控件CLSID）|HTTP流量方向为从Internet到内网用户（to_client, established），结合Head方法与已知公开漏洞相关",
      "第2步攻击：T1203: 攻击者通过利用Equation Editor (CVE-2017-11882) 的已知漏洞，诱导用户打开恶意RTF文档，实现远程代码执行，获取初步访问权限。 从08/23/2024-13:57:05开始到08/24/2024-17:06:15结束，共3条，其关键特征为HTTP协议下下载RTF文件（flowbits: ET.http.rtf.download）|RTF流中包含 Equation Editor OLE 对象令牌（objclass Equation.2）|缓冲区溢出exploit所需的特征性OLE标识内容（如0B00030000000000C000000000000046及若干十六进制特征码）",
      "第3步攻击：T1071.001: 恶意软件通过标准应用层协议（如HTTP、HTTPS等）与其C2服务器建立和保持通信，实现远程命令执行、数据回传等操作。此规则检测到了与VBCrypt/Spy.582013.2恶意代码相关的CnC 'Keepalive'连接，说明受害主机正尝试与外部C2进行心跳通信以维持管理通道。 从09/11/2024-22:15:23开始到10/02/2024-01:30:55结束，共16条，其关键特征为目的端口81（常规Web端口以外，用于隐藏C2）|固定数据包（14字节，前4字节为0x0a 00 00 00）|TCP协议，向外部（to_server）建立的持久连接"
    ],
    "此攻击链关联的原因": "三条告警均表现出典型的攻击链：初始访问（T1189，恶意ActiveX控件分发，2011207）→利用漏洞实现远程执行（T1203，Equation Editor漏洞利用，2829385，主TTP、与上一步可视为攻击路径递进，同为远程代码执行方式）→C2通信（T1071.001，明确外联心跳，2802161）。时间虽有较大断档（POTENTIAL_GAP）但符合APT持续渗透手法，TTP序列及特征具强相关性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者通过ActiveX控件与RTF漏洞实现初始渗透及远程代码执行，随后在主机中植入恶意代码并利用HTTP协议基于非常规端口与C2服务器持续通信，实现远程控制与维持访问，全链条涵盖初始入侵、漏洞利用与命令与控制等主要阶段。"
  },
  "chain_1321": {
    "alerts_info": [
      "第1步攻击：T1583.001: 攻击者注册并配置可疑的域名及相关的恶意Nameserver（nameserver为ns-usa.topdns.com，注册地为internet.bs），以便于后续攻击活动中的命令与控制、钓鱼、间谍等用途，此类行为属于资源准备阶段。  从08/22/2024-09:13:05开始到08/22/2024-09:13:05结束，共1条，其关键特征为DNS响应中包含恶意可疑的registrar nameserver（ns-usa.topdns.com, 注册于internet.bs）|UDP协议DNS流量，数据包内容特征“|00 02 00 01|”匹配类型字段|DNS权威记录section中显现 suspect nameserver 字符串分段匹配：ns-usa、topdns、com",
      "第2步攻击：T1568: 攻击者通过对特定恶意域名（如c_panel-sldns.com）的DNS查询，来实现命令与控制的通信信道动态定位。这种方式能够帮助命令与控制服务器隐藏自身真实地址，同时便于绕过静态黑名单等防护措施。  从08/25/2024-18:45:38开始到08/27/2024-03:25:14结束，共3条，其关键特征为DNS查询请求报文|查询域名为c_panel-sldns.com|适用于客户端终端，恶意程序通过DNS主动发起通信"
    ],
    "此攻击链关联的原因": "两条告警通过TTP主序列（T1583.001→T1568）形成资源准备到C2通信的合理攻击链，时间顺序相符，辅助TTP和行为语义均支持该攻击流程。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先注册并配置恶意Nameserver（ns-usa.topdns.com），为后续C2及恶意活动搭建基础设施，随后利用已注册的恶意域名c_panel-sldns.com进行DNS查询，动态定位命令与控制服务器，完成C2通信路径的搭建，体现了典型的分阶段APT攻击链条。"
  },
  "chain_16829": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到通过SMTP协议向内部邮件服务器投递被植入AutoOpen宏（自动运行宏）的Office文档，属于通过恶意邮件附件进行初始访问的典型手法。攻击者通常利用邮件携带恶意Office文档，诱使收件人打开，触发恶意宏代码的自动执行，进而实现后续渗透动作。  从08/22/2024-09:17:15开始到08/22/2024-09:17:15结束，共1条，其关键特征为SMTP邮件流量检测，方向为外部至内部邮件服务器|检测Email附件内容中存在Base64编码的'AutoOpen'标志（\"QQB1AHQAbwBPAHAAZQBu\"）|告警针对含有潜在恶意宏的Office文档附件，利用自动运行宏提升社会工程攻击成功率",
      "第2步攻击：T1071.002: 此告警检测到从服务器端口向内部主机发送的TCP流数据包，前两字节为'x0'，表明该流量可能属于恶意软件（如x0Proto后门）的自定义或伪装协议，用于建立或初始化命令与控制信道。  从08/22/2024-10:46:49开始到08/23/2024-13:22:10结束，共4条，其关键特征为检测TCP流方向为from_server，说明是恶意服务器主动向内网主机通信|TCP载荷前两字节固定为'x0'，为恶意协议标记|启用flowbits标记与流量跟踪，为多阶段通信或行为关联分析做准备",
      "第3步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件的持久化机制相关联。  从08/29/2024-01:10:28开始到09/07/2024-16:14:16结束，共5条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，与高度隐蔽的后门工具相关|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第4步攻击：T1105: 该行为表现为攻击者通过 HTTP 下载可执行文件（如恶意 payload）到受害主机，是投递远控木马、dropper 或后门等工具的常见方式，辅助后续控制或内网渗透操作。  从10/02/2024-03:08:11开始到01/16/2025-09:44:20结束，共3条，其关键特征为HTTP协议下，直接请求可疑域名获取PE型可执行文件|检测内容：文件以'MZ'魔数开头且有有效的PE头，确认下载对象为Windows可执行文件|检测请求头或流特征伪装为浏览器请求，且域名被标识为疑似恶意（flowbits: ET.Suspicious.Domain.Fake.Browser）"
    ],
    "此攻击链关联的原因": "基于TTP时间顺序与阶段性递进：钓鱼邮件初始访问（T1566.001）后，高度怀疑建立C2（T1071.002），随后实现持久化（T1053.005，期间辅助T1071.002辅助关联）并下载工具或payload（T1105）。中间阶段主逻辑衔接合理，但T1053.005与T1105阶段间存在POTENTIAL_GAP（时间跨度大），认定攻击链整体关联中等可信。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于投递恶意宏文档实现初始访问，随后建立自定义协议C2信道与持续控制，利用计划任务及SMB命名管道实现持久化。较晚阶段，攻击者通过HTTP下载新PE型payload，疑似用于权限扩展或持久化工具升级。整体展现持续渗透、稳定控制及工具更新的APT攻击流程，跨越数月间隙。"
  },
  "chain_1867": {
    "alerts_info": [
      "第1步攻击：T1566.001: 此规则检测到CVE-2017-0199漏洞攻击，典型用于通过恶意Office文档（嵌入HTA文件）进行钓鱼欺骗，诱导目标打开并激活恶意代码，从而为攻击者获取初始访问权限。  从08/22/2024-09:20:32开始到08/22/2024-09:20:32结束，共1条，其关键特征为HTTP流量流向内网终端（$EXTERNAL_NET -> $HOME_NET）|Content-Type为application/hta（检测HTA文件传递）|内容中包含.expandedEnvironmntStrings与特定Microsoft Office宏相关字节特征，以及'|Menu\\Programs\\Startup\\'等可利用HTA绕过执行的痕迹",
      "第2步攻击：T1574.001: 攻击者通过 DLL 劫持（尤其是 Windows Service Control Manager 的 DLL 劫持）实现横向移动。该技术允许攻击者通过将恶意 DLL 插入服务启动路径，以提升权限或远程执行恶意代码。  从08/23/2024-14:16:02开始到08/27/2024-11:56:18结束，共3条，其关键特征为HTTP 200 状态码响应，表明是服务器向客户端成功返回内容。|HTTP 文件内容包含 UTF-16 编码的命令字符串，如 'stop copy Tsvipsrv.dll'。|传输路径中出现 C:\\Windows\\System32\\TSMSISrv.dll 等指向 Windows 系统目录的 DLL 文件劫持行为迹象。",
      "第3步攻击：T1548.002: 该Snort规则检测的是CVE-2023-23397，这是一个影响Microsoft Outlook的特权提升漏洞。攻击者可以通过特制邮件包在用户无需交互的情况下提升权限、收集NTLM哈希等敏感信息。此操作本质上属于利用客户端应用漏洞实现权限升级。  从09/01/2024-20:17:17开始到09/01/2024-20:17:17结束，共1条，其关键特征为SMTP协议邮件流量，邮件内容中包含特定Base64编码|邮件正文以特定压缩内容或标识（如|78 9f 3e 22|，'IPM.Microsoft Mail.Note'）开头|PCRE正则检测邮件中携带有特殊SMB路径结构（如'\\服务器名\\...'），配合CRLF标志邮件结构分界",
      "第4步攻击：T1071.001: 该告警检测到Ratsnif通信流量，其特征是伪装正常浏览器的User-Agent，从被感染终端向外部C2服务端建立命令与控制通道。这种行为通常通过HTTP协议隐藏流量特征，对抗检测。  从10/28/2024-03:16:49开始到10/29/2024-13:22:14结束，共10条，其关键特征为可疑的User-Agent特征：Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; BOIE9;ENGB)|HTTP协议通信，流量从内网终端指向外部|通信过程已建立且流向服务器（to_server）",
      "第5步攻击：T1071.001: Ratsnif 经常利用合法的应用层协议（如 HTTPS）与 C2（指挥与控制）服务器通信，用于绕过流量监测。该告警检测在 TLS 会话中出现了伪造的恶意 SSL 证书（CN=www.corpbonus.com），表明内部主机可能正与 Ratsnif 控制服务器通信。  从01/17/2025-01:03:57开始到02/06/2025-22:29:33结束，共9条，其关键特征为TLS 流量方向为 EXTERNAL_NET 到 HOME_NET（即外部到内部）|X.509 证书主题字段（Subject）包含 CN=www.corpbonus.com|已建立的 TLS 连接，且证书与已知 Ratsnif C2 签发信息匹配"
    ],
    "此攻击链关联的原因": "以TTP推进顺序建立链路：从钓鱼投递（T1566.001）到DLL劫持（T1574.001）、特权提升（T1548.002），再到C2通信（T1071.001）。虽存在时间和TTP阶段性跳跃，但整体行为与APT典型攻击路径吻合，部分阶段存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于利用恶意Office文档的钓鱼攻击获取初始访问，随后通过DLL劫持实现持久化与横向渗透。后续攻击用Outlook特权提升（包括NTLM哈希收集），最终采用Ratsnif实施C2远控和数据可能外渗。整体反映了典型APT渗透、横向移动和持久控制的完整生命周期。"
  },
  "chain_2048": {
    "alerts_info": [
      "第1步攻击：T1189: 攻击者通过利用受感染或恶意制作的网站，触发利用工具包Exploit Pack，EternalSynergy，在无须用户交互的情况下对访问该网站的用户自动发起攻击，尝试利用浏览器、插件等漏洞下载或执行恶意文件。  从08/22/2024-09:30:12开始到08/22/2024-10:16:29结束，共4条，其关键特征为匹配GIF文件头特征（|47 49 46 38 39 61...|）以及Exploit Payload字节序列，表明利用包隐藏或 masquerade 用于Payload传递。|规则触发布署于 perimeter，流量方向为自服务器至客户端 (from_server)，payload阶段抓取。|涉及目标为通用Web浏览器，平台为Windows系列，显示典型的浏览器利用场景。",
      "第2步攻击：T1566.001: 该告警检测到利用CVE-2017-11882漏洞的恶意RTF文档下载行为。攻击者常将此漏洞嵌入带有恶意OLE对象的Office文档，通过邮件等方式投递给受害者，实现初步访问。  从08/22/2024-10:25:33开始到08/22/2024-12:07:12结束，共5条，其关键特征为HTTP协议，检测到RTF文档下载流量|文件内容包含特征字符串 'objclass Equations}' 及特定十六进制标识 ('02CE020000000000C000000000000046')，表明嵌入OLE对象|流量方向为外部(攻击者)到内部(受害者)，常见于钓鱼攻击传输阶段",
      "第3步攻击：T1055: 本告警检测到了对存在漏洞的 Microsoft Windows cmd.exe 的远程访问横幅信息，说明攻击者可能通过利用远程命令执行漏洞获取了高级权限。此类行为常用于权限提升，通过漏洞或者后门以管理员权限执行命令。  从08/28/2024-14:23:43开始到08/28/2024-14:23:43结束，共2条，其关键特征为检测到TCP会话中包含'String: Microsoft Windows '与版权信息，表明响应内容为Windows命令行界面横幅|起始端口号非21-23（排除了FTP和Telnet常见端口），暗示访问为非标准服务暴露|流量方向属于内网主机出站至外部（$HOME_NET -> $EXTERNAL_NET），可能表明内网主机被攻击后进行外部交互",
      "第4步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与SMB隐蔽持久化模块相关联。  从09/14/2024-03:48:17开始到09/14/2024-03:48:17结束，共6条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，流向为to_server，内容特征包含特定的管道内容片段",
      "第5步攻击：T1547: 检测到DoubleFantasy等，通过设置持久化命令，以确保恶意代码在系统重启或者用户登录后能够自动执行，实现长期驻留。  从10/01/2024-18:08:13开始到10/01/2024-18:08:13结束，共1条，其关键特征为Snort规则检测TCP从外部服务器回送到内部主机，端口大于1024|特定payload内容：\"persistent\\x0a\"，表示持久化操作命令|流量方向为已建立连接（流量为from_server），主要影响Windows客户端",
      "第6步攻击：T1112: 攻击者通过EquationDrug组件的注册表操作功能创建或修改 Windows 注册表项，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从01/22/2025-20:13:10开始到02/05/2025-14:25:58结束，共4条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含注册表操作命令，触发条件为后门与被控端交互，指向主动注册表操作"
    ],
    "此攻击链关联的原因": "通过TTP序列（初始访问→权限提升→持久化）、时间顺序和行为描述建立因果链。后续持久化及权限操作警报采用主要或辅助TTP及功能语义强化链路，部分步骤时间跨度较长（POTENTIAL_GAP）。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于利用Web Exploit Kit与钓鱼文档实现多渠道初始访问，随后攻击者通过RCE获取远程权限并执行命令。内网主机使用SMB命名管道建立隐蔽持久化，接着通过后门设置持久机制与注册表修改巩固长期控制，实现完整渗透至持久驻留的攻击流程。"
  },
  "chain_23563": {
    "alerts_info": [
      "第1步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从08/22/2024-09:33:17开始到08/22/2024-09:33:17结束，共1条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第2步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/24/2024-02:15:49开始到09/03/2024-05:45:13结束，共3条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第3步攻击：T1071.001: 该规则检测来自被感染主机通过HTTP协议向外部C2服务器发起GET请求，属于威胁行为者通过授权网络通信方式对目标实现远程控制的典型场景。使用了特定User-Agent伪装以及特定URI特征，表现为典型C2流量。  从09/21/2024-11:02:43开始到09/21/2024-11:02:43结束，共1条，其关键特征为HTTP GET请求，URI包含以.php?*为特征的脚本调用及参数，紧跟有分隔符0x2a（*号），说明流量存在与特定恶意样本相关的特征化行为。|HTTP User-Agent被伪造为‘Windows Installer’，与正常浏览器或合法软件不符，属于典型伪装及钓鱼流量特征。|HTTP请求Header顺序固定，包括Connection, Accept, User-Agent, Host字段，header排列及组合均与恶意工具生成的流量模型相符。",
      "第4步攻击：T1568.002: 检测到内部主机对经算法生成的Zeus C2域名（DGA域名，.ru后缀）的DNS查询，表明恶意软件试图通过DGA动态寻找C2服务器并建立通信通道。  从10/13/2024-19:26:08开始到12/29/2024-22:33:41结束，共6条，其关键特征为检测到含有33位及以上字母数字组合的.ru顶级域DNS查询|使用正则表达式和内容关键字进行DGA域名的模式匹配|告警类型为command-and-control，关联Zeus家族特征",
      "第5步攻击：T1071.001: 该流量通过TLS协议建立，使用特定SNI字段 (.statisticscripts.com)，显示被感染主机主动向恶意C2服务器建立通信通道。  从01/19/2025-07:34:11开始到01/19/2025-07:34:11结束，共1条，其关键特征为TLS协议流量|SNI包含字符串.statisticscripts.com，精确匹配后缀|flow: established, to_server，室内主机主动向外部建立的TLS连接"
    ],
    "此攻击链关联的原因": "链条以T1027初步混淆执行为起点，随后通过计划任务（T1053.005）实现持久化，继而出现多阶段C2通信（T1071.001、T1568.002、T1071.001），时间顺序与TTP逻辑基本吻合。中间TTP缺失但通过整体语义和攻击行为推断关联，存在较长时间间隔，已用POTENTIAL_GAP标注。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击初期通过Powershell脚本混淆解压（T1027）实现恶意代码下发，继而计划任务（T1053.005）维持持久性，后分阶段通过HTTP与TLS外联C2（T1071.001），期间通过DGA生成域名动态寻找C2（T1568.002），展现出较完整的APT攻击链，包含隐蔽通信与持久化多阶段行为。POTENTIAL_GAP：C2阶段前后存在数月间隔，疑似长期控制。"
  },
  "chain_13161": {
    "alerts_info": [
      "第1步攻击：T1204.002: 攻击者通过HTTP协议在传输内容时将Content-Type设置为application/x-sh，意味着传递的是Shell脚本，有可能引导用户或终端自动执行恶意脚本文件，实现初步投放。  从08/22/2024-10:09:03开始到08/22/2024-10:09:19结束，共4条，其关键特征为HTTP响应包中的Content-Type头部包含application/x-sh，指向Shell脚本。|流量方向为外部网络到企业内部，已建立会话，流向客户端。|流量包含HTTP特征，可作为检测潜在恶意payload分发的依据。",
      "第2步攻击：T1027: 攻击者通过传输经过加密或混淆处理的恶意二进制文件躲避传统检测机制，增加分析和检测难度。本规则匹配的是PlugX等自定义loader使用的特定加密二进制文件签名。  从09/01/2024-11:02:47开始到09/01/2024-11:02:47结束，共2条，其关键特征为HTTP协议，流量方向为外部到内部，已建立连接|文件数据中存在特征十六进制序列“f2 fd 90 00 bc a7 00 00”，匹配Karagany家族加密二进制文件头|flowbits功能表明其与漏洞利用包（exploit kit）活动相关",
      "第3步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件（如Duqu 2.0）的持久化机制相关联。  从08/22/2024-14:14:59开始到08/24/2024-22:18:02结束，共5条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，与Duqu 2.0相关|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第4步攻击：T1083: 该告警检测到Loda Logger恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从08/25/2024-08:45:10开始到08/26/2024-03:03:50结束，共6条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与Loda Logger家族相关，且适用于Windows平台的多版本",
      "第5步攻击：T1083: 攻击者通过访问受害主机上/listdir.php?dir=接口，尝试列出目录内容以收集存储的文件和目录信息。这属于对文件系统结构的初步侦查行为。  从08/26/2024-09:14:22开始到08/26/2024-09:14:22结束，共3条，其关键特征为GET方法，URI携带/listdir.php?dir=参数——表明意图列举服务器目录列表|HTTP头部特定顺序（Host、Pragma、Accept）及其组合，通常是恶意通信的指纹|流量方向为本地主机到外部网络，表现为到伪装C2服务器的通信企图",
      "第6步攻击：T1016: 此告警检测到主机执行了Windows网络配置信息查询（如ipconfig命令），该行为常用于攻击者收集目标主机的网络信息（如IP、子网掩码、网关等），为后续 lateral movement 或数据渗透做准备。  从10/22/2024-02:14:20开始到10/22/2024-02:18:04结束，共3条，其关键特征为Payload中包含字符串 'Windows IP Configuration\\x0d'|Payload中包含 'Ethernet adapter Local Area Connection:'|同时出现 'Physical Address'、'IP Address'、'Subnet Mask'、'Default Gateway' 等网卡配置信息关键词",
      "第7步攻击：T1057: 攻击者利用恶意软件从受害主机枚举或收集活动进程列表，例如列举svchost.exe等系统进程。该信息可用于对主机态势感知、后续权限提升、规避检测等操作。  从10/12/2024-18:57:13开始到10/12/2024-18:57:13结束，共3条，其关键特征为HTTP协议向外发起GET请求，目的为EXTERNAL_NET|URL参数中包含\"&pl=[System Process]\"，指代进程信息|HTTP URI中出现\"svchost.exe\"关键字，指向关键系统进程相关信息",
      "第8步攻击：T1056.001: Win32/Spy.Tuscas是一种信息窃取类木马，通过HTTP请求收集被感染主机的系统信息、组信息、客户端信息、操作系统版本和网络延迟等敏感数据，属于攻击者在感染主机后执行数据收集任务的表现。  从10/10/2024-08:47:29开始到10/10/2024-08:47:29结束，共7条，其关键特征为HTTP请求URI中包含参数：?version=&group=&client=&computer=&os=&latency=|HTTP请求缺少典型头部，如’Accept’和‘Referer’|目的地为外部网络（$EXTERNAL_NET），方向为from $HOME_NET to $EXTERNAL_NET，表示内网向外发送敏感数据",
      "第9步攻击：T1071.001: Ars Stealer 恶意软件通过HTTP协议与其命令与控制（C2）服务器进行通信，实现对被感染主机的远程控制和数据收集。该规则检测的是恶意样本向C2服务器发出的GET请求，包含硬件ID、操作系统、用户名、防病毒及防火墙信息等内容。  从11/05/2024-21:11:46开始到11/05/2024-21:11:46结束，共6条，其关键特征为HTTP GET请求，URI 中包含 .php?hwid= 和多个参数 (&os=, &user=, &av=, &fw=, &x=)|请求头部不包含 Referer 和 Connection 字段，符合恶意通信伪造特征|流量方向为内部主机对外部服务器的已建立会话，配合已知恶意家族 Ars Stealer 的 C2 检查编码特征",
      "第10步攻击：T1005: 攻击者利用RedLine Stealer或MetaStealer等信息窃取家族，通过恶意代码在受害主机系统中收集诸如凭证、浏览器数据、文件等敏感信息。此类行为通常为数据外泄的前奏。  从09/19/2024-04:13:34开始到09/22/2024-12:09:12结束，共6条，其关键特征为TCP建立连接，流向目标服务器，流长度为2字节——典型于初始认证或握手阶段的数据包。|特征内容匹配：‘|02 0B 01 73 ... Authorization|08 03|ns1|99 20|’，指示特定恶意通信格式及内含Authorization字段，疑似为自定义认证或数据上传协议。|影响操作系统范围为Windows全系列，且流量方向为内网主机到外部网络，契合数据窃取型木马的典型行为模式。",
      "第11步攻击：T1113: 该规则侦测到MICROPSIA恶意软件通过HTTP POST方式上传屏幕截图文件，表明攻击者在受害主机上采集屏幕内容以实施信息收集。  从09/23/2024-23:22:19开始到09/23/2024-23:22:19结束，共1条，其关键特征为HTTP POST方法，目标为外部网络|请求体中的Content-Disposition头指示上传名为‘kerna’的表单数据，并包含名为图片的JFIF头（JPEG文件特征）|请求缺少常见的Referer和User-Agent头部，表现出自动化/非浏览器客户端特征",
      "第12步攻击：T1041: 检测到恶意软件Win32.Diztakun.zsg（信息窃取器）通过HTTP POST请求向外部网络进行敏感数据的渗出。其利用C2服务器通道将信息文件（如Information.txt）作为HTTP请求体发送出网络，属于典型的数据渗出行为。  从01/15/2025-13:44:02开始到01/17/2025-16:09:28结束，共3条，其关键特征为HTTP POST请求，且HTTP头部含有 Expect: 100-continue 字段|请求体中包含 'filename=\"Information ' 字样，符合典型的数据渗出格式|PCRE 匹配/(?:\\d{1,3}\\.){4}txt/R，用于识别以IP地址为路径的txt文件上送，结合Content-Type为application/"
    ],
    "此攻击链关联的原因": "各告警TTPS沿攻击链典型阶段（初始投送-防御规避-持久化-发现-数据收集-外连C2-信息窃取-数据渗出）递进，时序基本合理。部分阶段通过辅助TTPS和行为语义连贯，允许部分阶段缺失。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链自外部通过恶意Shell脚本初步投送，随即分发加密木马并利用SMB/命名管道持久化，进入主机发现与信息收集阶段（系统、进程、磁盘等），随后频繁与外部C2交互，实施凭证与敏感数据窃取及屏幕截图，终以HTTP POST隐蔽外传。链路展现典型APT长线渗透与分阶段窃密行为。"
  },
  "chain_7958": {
    "alerts_info": [
      "第1步攻击：T1190: 攻击者试图利用IIS 5.0/6.0存在的EXPLODINGCAN漏洞（针对WebDAV组件），通过特制的HTTP请求入侵面向外网的Web应用服务器，实现对目标系统的初始访问或远程代码执行。  从08/22/2024-10:13:45开始到08/22/2024-10:13:45结束，共1条，其关键特征为HTTP请求方法为PROPFIND，针对WebDAV服务，通常不被常规网站流量所用。|Header包含Content-Length: 0和特定的Host、If字段，模拟漏洞触发场景。|URL长度为1字符，非常异常，通常为漏洞利用所特有（如/）。",
      "第2步攻击：T1203: 攻击者利用 Internet Explorer 的远程代码执行漏洞（CVE-2014-6332），通过特制网页或脚本诱导受害者访问，实现恶意代码的执行，从而获得初始访问权限。  从08/22/2024-22:05:13开始到08/22/2024-22:05:13结束，共1条，其关键特征为HTTP协议流量，方向为from_server，即服务器返回数据至客户端|文件内容特征匹配特定的恶意payload片段，如|26 63 68 72 77 (相关于漏洞环境变量操作代码)||出现与父漏洞利用相关的脚本关键字，例如setnotsafemode()、runshellcode()，进一步指示利用IE脚本解释器远程执行能力",
      "第3步攻击：T1112: 攻击者通过 Meterpreter 攻击框架的 stdapi_registry_create_key 创建或修改 Windows 注册表项，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从08/23/2024-03:23:59开始到08/24/2024-18:41:25结束，共3条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含关键词 'stdapi_registry_create_key'，与Meterpreter的注册表操作模块特征吻合|触发条件为Metasploit Meterpreter shell与被控端交互，指向主动注册表操作",
      "第4步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/01/2024-08:57:41开始到09/09/2024-17:36:26结束，共5条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第5步攻击：T1090.003: 攻击者通过HTTP CONNECT方法建立代理通道，实现与受控主机间的多跳命令与控制流量穿透，隐蔽真实C2通信路径。此检测行为表明已感染主机可能正充当恶意代理节点，帮助C2隐藏分布和访问路径。  从10/15/2024-20:15:01开始到10/15/2024-20:15:01结束，共4条，其关键特征为HTTP协议的CONNECT方法请求|请求路径包含 '/_controlPath/'，该行为为HTTP Proxy隧道手法|流量方向为内网主机到外部网络，并采用已建立的会话（flow:established,to_server）",
      "第6步攻击：T1071: 检测到受感染终端尝试与已知的Feodo恶意C2（CNC）服务器 (162.*.*.246) 建立通信，通常用于攻击者远程管理受控主机、发送指令、接收窃取数据等。与C2的通信属于MITRE ATT&CK命令与控制（Command and Control）阶段，通过标准或自定义应用层协议（如HTTP、HTTPS等）进行数据交换。  从12/08/2024-12:33:11开始到01/17/2025-09:21:50结束，共4条，其关键特征为目的IP为Feodo Tracker已确认的C2地址（162.*.*.246）|通用IP协议（不限端口或协议），可用于多种应用层协议通信|流量发生在$HOME_NET向外发起，表明内部主机主动连接外部C2",
      "第7步攻击：T1041: 检测到通过HTTP GET请求与外部C2服务器通信，疑似在C2信道中暗含数据渗出行为。攻击者通过在正常通信信道中混杂敏感数据渗出，规避传统检测。  从02/01/2025-22:48:31开始到02/16/2025-04:10:15结束，共8条，其关键特征为HTTP GET方法，URI参数包含os、osmajorver、osminorver、osmajorsp、lang、country、ossname、brand、bits等设备信息；依序出现，疑似批量信息回传。|HTTP请求头部携带特征性X-OSSProxy头，值为3a（冒号），该行为属于典型的数据外泄信道手法|告警分类为命令与控制（C2），通信目的地为外部网络（$EXTERNAL_NET），与多种信息泄露行为相关。"
    ],
    "此攻击链关联的原因": "按照TTP时间推进，从外部Web服务漏洞利用（T1190/T1203）至持久化（T1112）、防御规避及载荷混淆（T1027），再到命令与控制阶段（T1090.003、T1071）、数据渗出（T1041），链路行为与攻击框架吻合，部分环节时间跨度较长，存在POTENTIAL_GAP与MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "此攻击链自Web服务漏洞（EXPLODINGCAN、IE远程代码执行）被利用实现初始入侵，后通过Meterpreter注册表持久化与PowerShell脚本混淆规避检测，接着建立代理及C2信道（含Feodo Botnet特征），最终通过HTTP通道将设备信息外泄至外部，完整呈现从初始访问到命令与控制、数据渗出的APT攻击全景。"
  },
  "chain_4588": {
    "alerts_info": [
      "第1步攻击：T1055.003: 攻击者通过向目标进程的堆内存注入大量NOP或特定字节（如0x41，实现Heap Spray），以人为创造可控的代码执行区，常辅以后续漏洞利用。这种方式常用于网页浏览器等客户端，达到攻击代码的顺利注入。  从08/22/2024-11:04:15开始到08/22/2024-12:21:09结束，共3条，其关键特征为HTTP协议流量，方向为established,to_client（从外部到内部主机）|特征payload包含URL编码的%41%41%41%41（即AAAA）字节序列，属于常见NOP-sled填充，表明Heap Spray攻击特征|使用heap spray技术特征明显，通常出现在利用网页漏洞或未授权脚本加载场景",
      "第2步攻击：T1055: 该告警检测到网络流量中包含典型的shellcode字节序列，shellcode常被用于在目标主机内存中注入恶意代码，从而提高权限、规避安全检查并实现后续操作。  从10/03/2024-08:24:10开始到10/03/2024-08:24:10结束，共1条，其关键特征为检测到特定shellcode字节序列 |D9 74 24 F4 5B 81 73 13| 和 |83 EB FC E2 F4||在TCP已建立连接（flow: established）中出现|无特定协议或端口限制，适用于任意TCP流量",
      "第3步攻击：T1112: 攻击者通过VBS脚本向受害主机的注册表写入值，降低Office安全级别（如设置VBAWarnings），从而启用所有Office宏，绕过安全保护机制，为后续宏恶意代码执行提供条件。  从08/23/2024-17:55:03开始到08/23/2024-17:55:03结束，共1条，其关键特征为HTTP流量，响应码为200，文件数据中包含 '.RegWrite \"HKCU\\Software\\Microsoft\\Office\\...\\VBAWarnings',1'|VBS脚本通过'WScript.Shell.RegWrite'方法修改注册表路径，指定Office宏安全设置|针对Windows客户端（XP/Vista/7/8/10/Server等），可能作为钓鱼传播和宏恶意代码投递链的一部分",
      "第4步攻击：T1562.001: 攻击者通过下发特定的 .reg 注册表文件，修改 Windows 注册表项，禁用受害者系统的任务管理器，以规避检测与分析，延缓威胁响应。  从08/26/2024-16:20:12开始到08/26/2024-16:20:12结束，共1条，其关键特征为HTTP协议下，服务器返回包含注册表修改内容的.reg类型文件|UTF-16编码内容中包含关键注册表路径，如HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System|数据中存在 'DisableTaskMgr' 字段设为1（DWORD:1），明确禁用任务管理器",
      "第5步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从09/13/2024-20:19:24开始到09/14/2024-23:13:19结束，共2条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第6步攻击：T1027: 攻击者通过未包含Referer头并利用特殊请求路径进行敏感信息传输，意图避开基于常规请求模式的检测，增强其命令与控制以及数据外泄活动的隐蔽性。  从08/24/2024-01:13:24开始到08/26/2024-09:08:17结束，共4条，其关键特征为HTTP URI包含/a?act=App&method=updatePhone&content=，表明特定API用于数据上传|HTTP请求头中不包含Referer字段，规避常规追踪与安全检测|流量方向为内网到外网，通常与移动恶意软件数据上报或远控相关",
      "第7步攻击：T1041: 此告警检测到恶意应用通过命令与控制（C2）信道，将敏感信息（如Subid, Vid, Pjid, Imsi, Imei, Uid, Cptime等参数）主动发送到远程服务器，属于通过C2通道的数据渗出行为。  从12/26/2024-02:38:12开始到12/29/2024-13:44:57结束，共6条，其关键特征为HTTP请求URI中包含Subid=、&Vid=、&Pjid=、&Imsi=、&Imei=、&Uid=、&Cptime=等参数，反映出敏感设备信息被上报。|User-Agent头为'Apache-HttpClient/'，表明此应用较常见于Android恶意程序，使用此HTTP库进行通信。|HTTP请求头中无Referer字段，配合fast_pattern，典型数据上报特征，指向恶意自定义客户端通信。",
      "第8步攻击：T1056.001: 该告警检测到恶意键盘记录程序通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从11/01/2024-19:52:21开始到11/01/2024-19:52:21结束，共2条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知恶意键盘记录程序的通信行为，针对 Windows 系统客户端",
      "第9步攻击：T1573: 检测到Sanitizer通过加密信道（可能使用自定义加密或协议封装）与其C2服务器进行指令通信，行为表现为固定加密特征值的Outbound流量，常用于隐藏命令与控制流量，绕过防御检测。  从01/18/2025-15:07:00开始到01/18/2025-15:07:00结束，共2条，其关键特征为流量方向为HOME_NET到EXTERNAL_NET，目的为外部服务端，Outbound通信|TCP数据包大小为19字节，Payload固定：31 36 00 40 F1 76 6A 78 DF 7F 98 37 C8 1B B7 7A 54 95 E5|表现出Sanitizer的C2通信流量特征。"
    ],
    "此攻击链关联的原因": "主TTP间存在内存注入、注册表修改、持久化、隐写、数据渗出等ATT&CK顺序推进，时间连续（最大间隔275天，合理覆盖APT），且有明显恶意操作行为和阶段递进，辅助TTP（如T1203、T1071.001等）进一步支撑链路合理性。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链始于堆喷射与shellcode注入实现初始入侵与权限提升，随后修改注册表降低Office安全、禁用任务管理器，再通过启动项持久化，实现长期驻留。攻击流程历经流量隐写与无Referer通信，逐步扩展到敏感信息窃取（如键盘记录和数据外传），最终通过Sanitizer远控加密C2信道建立完整渗透和数据外泄闭环。"
  },
  "chain_2373": {
    "alerts_info": [
      "第1步攻击：T1105: 检测到恶意文档（Maldoc）通过HTTP协议直接从外部服务器检索二进制有效载荷（/555555.png）。该行为通常是恶意代码控制阶段常见的操作方式，意在下载额外的恶意组件。  从09/14/2024-06:51:19开始到01/04/2025-20:09:57结束，共15条，其关键特征为HTTP GET请求针对资源/555555.png，目标外部网络。|请求缺少常见HTTP头部（无User-Agent、Accept、Cache-Control、Pragma、Referer等）。|请求头符合典型恶意载荷拉取特征，伪装文件类型以图片扩展名掩盖实际二进制内容。",
      "第2步攻击：T1036: 检测到SMB协议中mimikatz.exe的传输，攻击者可能使用恶意工具进行凭证导出，并尝试以正常文件名进行伪装，以逃避检测。  从08/22/2024-11:30:15开始到08/23/2024-17:08:59结束，共3条，其关键特征为基于TCP的SMB流量（端口139或445）|流量中包含Unicode编码的文件名“mimikatz.exe”|SMB协议标识（|FF|SMB|a2|），特点为攻击后响应流量",
      "第3步攻击：T1574.002: 该告警检测到对受 CVE-2012-1854 漏洞影响的 imeshare.dll 的不安全库加载操作。攻击者可通过放置恶意 DLL 于特定路径，并利用受影响应用（如 Microsoft Word）错误搜索顺序，诱使应用加载攻击者提供的恶意 DLL，实现持久化或绕过安全防护。  从08/28/2024-09:12:03开始到08/28/2024-09:12:03结束，共1条，其关键特征为流量为 TCP 445 端口（SMB协议）|SMB请求包含特征内容：“\\imeshare.dll” (Unicode编码)|匹配到 CVE-2012-1854 相关的 DLL Side-Loading 攻击行为"
    ],
    "此攻击链关联的原因": "以TTP推进为主，首先通过外部服务器HTTP拉取伪装为图片的恶意有效载荷（T1105），后出现SMB协议mimikatz.exe凭证窃取行为（T1036/T1003.001，辅助TTP），最后检测到DLL侧载实现持久化（T1574.002）；两者均可视作典型APT链中的下载-凭证窃取-持久化顺序。存在较大时间间隔（POTENTIAL_GAP），中间行为或存在遗漏（MISSING_STEP），但整体行为语义较一致。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击首先通过HTTP协议从外部服务器获取伪装成图片的恶意二进制（初步投递及下载组件），随后检测到通过SMB协议传输并执行了mimikatz凭证窃取工具，完成敏感信息盗取，最终通过利用CVE-2012-1854相关DLL侧载技术，实现攻击链持久化。整体展现了恶意软件下载、凭证窃取及持久控制的完整攻击路径，符合APT链条常见模式。"
  },
  "chain_14094": {
    "alerts_info": [
      "第1步攻击：T1082: 该规则检测到通过PowerShell脚本对PROCESSOR_ARCHITECTURE环境变量的访问，该行为通常用于远程攻击者识别受害主机的处理器架构信息，从而确定后续载荷投放或利用路径。此类系统信息发现行为属于攻击者在受害主机上进行环境摸底的典型动作。  从08/22/2024-12:10:10开始到08/25/2024-09:33:52结束，共5条，其关键特征为HTTP响应体中包含“\\Environment\\PROCESSOR_ARCHITECTURE”关键字，指示访问了系统环境变量。|正则提取环境变量赋值，格式示例：[a-z0-9]{1,20} = 'x86' 或 'x64'，检出主机CPU架构信息。|为入站HTTP通信，响应状态码为200，排除了请求内容包含“\\Software\\InstallShield\\”的情况，降低了误报概率，并指向定制化PowerShell脚本行为。",
      "第2步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/10/2024-03:24:07开始到09/10/2024-03:24:07结束，共2条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第3步攻击：T1573: 该规则检测到SharpNBT恶意软件与其C&C服务器之间通过加密信道进行定期通信（check-in）。攻击者利用加密流量隐藏C&C指令，从而绕过传统检测手段，保持对受感染主机的远程访问及控制。  从11/18/2024-22:11:54开始到12/21/2024-09:33:14结束，共2条，其关键特征为检测到特定的SharpNBT二进制协议头（60 ae d9 c0 07 8e 92 6b）对齐包首|特定二进制流量特征（以51 9d c5 e4 0d 07 5d cb结尾），分割包的大小为64字节|与外部服务器已建立TCP连接，流量极短 (<5 字节响应)，典型用于恶意软件check-in动作"
    ],
    "此攻击链关联的原因": "TTP链条从主机信息收集（T1082）到恶意载荷混淆执行（T1027），再到利用加密C2协议维持控制（T1573），符合攻击过程递进；三次告警时间线亦顺序推进，具有攻击链逻辑。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过PowerShell脚本收集主机环境及架构信息，随后利用混淆和解压技术在目标主机执行疑似恶意载荷，最终通过加密C2通道实现持久遥控与对外通信，呈现自环境侦查到植入并遥控的完整攻击流程。"
  },
  "chain_4146": {
    "alerts_info": [
      "第1步攻击：T1566.001: 检测到TLS连接的SNI包含可疑钓鱼域名，表明用户可能被诱导点击恶意链接并访问仿冒站点，为典型鱼叉式钓鱼攻击（Spearphishing Link）行为。  从08/22/2024-13:12:36开始到08/22/2024-13:12:36结束，共1条，其关键特征为TLS SNI字段包含“.creditals-email.space”域名，疑似钓鱼仿冒站点|事件发生在SSL/TLS加密通道中，采用SNI指纹检测|Snort规则基于流量向服务器端建立，且流向外网",
      "第2步攻击：T1027: 攻击者通过对JavaScript代码进行十六进制和双反斜杠混合转义，实施堆喷射(shellcode heap spray)，以规避安全检测机制。这种混淆手段能掩盖恶意payload实际内容，增加安全设备分析难度。  从08/31/2024-19:13:53开始到08/31/2024-19:13:53结束，共4条，其关键特征为HTTP协议流，方向为外部到本地、面向客户端的HTTP流量|内容特征为多个‘\\\\x0b’样式的JavaScript代码（双反斜杠加十六进制0b，频繁重复）|通常出现在script标签、内嵌JavaScript或加载第三方脚本的HTTP响应体中",
      "第3步攻击：T1059.005: 攻击者通过利用恶意VBScript（如'poc.vbs'），结合'cscript'命令行工具执行脚本，达成初步代码执行。Hunter Exploit Kit的落地页可能诱导浏览器/脚本引擎下载并执行VBS恶意代码，实现主机控制。  从08/22/2024-16:11:45开始到08/22/2024-16:11:45结束，共2条，其关键特征为HTTP流量，通过GET方式获取'poc.vbs'脚本|内容包含关键字符串'ADODB.Stream'与'cscript'，指向脚本写文件与执行功能|流量为源自外网到内网，且HTTP响应阶段file_data触发，符合Exploit Kit常见传递载荷落地行为",
      "第4步攻击：T1059.001: 本规则检测到利用PowerShell进行恶意脚本执行的行为。通过'GetProcAddress'、'InMemoryModule'等特征关键字，结合正则检测到XOR解码与Base64字符串处理，判定攻击者利用PowerShell脚本在内存中加载并执行payload。  从08/22/2024-14:32:01开始到08/22/2024-14:48:22结束，共6条，其关键特征为HTTP 200 正常响应，流量方向为from_server，payload可疑|出现PowerShell相关标志，如GetProcAddress、InMemoryModule、FromBase64String|脚本内有Base64及XOR解密、特定的PowerShell变量混淆和按位异或计算",
      "第5步攻击：T1547.001: 此攻击通过向Microsoft Outlook投递特制任务（IPM.Task），利用CVE-2023-29324漏洞尝试在目标系统上提升权限，实现恶意代码在系统启动或用户登录时的自动执行，达成持久存在。  从08/23/2024-12:25:55开始到08/23/2024-12:25:55结束，共1条，其关键特征为使用SMTP协议进行投递，目标为SMTP服务器|邮件内容中含有Base64编码的IPM.Task消息类型|内容结构包含十六进制特征（如78 9f 3e 22、5c），并结合正则检测以匹配特殊UNC或本地路径格式，利用CVE-2023-29324特性",
      "第6步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，恶意软件在SMB命名管道中注册持久后门机制。  从08/28/2024-09:34:28开始到08/28/2024-09:34:28结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道以增强持久化隐蔽性|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第7步攻击：T1055.001: 利用MySQL服务器将自定义可执行文件（.exe）写入Windows系统目录（C:\\windows\\system32），以便后续执行，以达到绕过安全控制、潜在获取SYSTEM权限等目的。该方法被一些APT利用实现后门持久化。  从09/12/2024-08:44:59开始到09/12/2024-08:50:39结束，共5条，其关键特征为对MySQL服务（TCP 3306）的写入型SQL命令检测（INTO DUMPFILE 指向 C:\\windows\\system32\\*.exe）|SQL查询中带有SELECT data FROM ..., INTO DUMPFILE，目标为可执行文件（.exe）|利用MYSQL DUMPFILE功能直接在系统关键目录写入新文件，实现恶意持久化或远程利用",
      "第8步攻击：T1021.001: 该规则检测SMB（端口139/445）上的特殊远控工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从09/25/2024-17:02:26开始到09/25/2024-17:02:26结束，共5条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'出现在SMB流量内容中，指向特殊工具的某种变体或obfuscation处理。",
      "第9步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从09/27/2024-22:15:43开始到09/27/2024-22:15:43结束，共3条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第10步攻击：T1048: 攻击者利用SMTP协议，通过邮件将被感染Android设备中的信息出站渗透到外部，从而规避常规HTTP/HTTPS安全检测或审查。  从10/01/2024-10:51:07开始到10/04/2024-13:20:14结束，共7条，其关键特征为UDP协议端口25和587（标准SMTP传输端口）|邮件主题以MIME-BASE64编码，且包含“=?UTF-8?B?55S16K+d?=”等混淆字符|邮件体内容含MIME多部件及混合类型头部（MIME-Version、Content-Type: multipart/mixed）"
    ],
    "此攻击链关联的原因": "根据钓鱼入口（T1566.001）起始，后续多阶段有效载荷混淆与多种脚本执行（T1027，T1059.005，T1059.001），中间插入提权与持久化（T1547.001，T1053.005，T1055.001），后面则依次实现横向移动、凭据窃取及最终数据渗出（T1021.001，T1003，T1048），TTP序列完整，时间连续，举证充分。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链起始于钓鱼链接引诱（Spearphishing Link），诱导访问携带混淆JavaScript载荷的网页并执行恶意VBScript与PowerShell脚本，继而结合Outlook漏洞与计划任务提升权限与持久化，并利用MySQL写入后门和SMB横向移动。最后通过进程内存转储获取凭据并通过邮件外发数据，完成典型多阶段APT攻击闭环。"
  },
  "chain_22741": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到通过SMTP协议向内部邮件服务器投递被植入AutoOpen宏（自动运行宏）的Office文档，属于通过恶意邮件附件进行初始访问的典型手法。攻击者通常利用邮件携带恶意Office文档，诱使收件人打开，触发恶意宏代码的自动执行，进而实现后续渗透动作。  从08/22/2024-17:22:34开始到08/22/2024-21:45:18结束，共3条，其关键特征为SMTP邮件流量检测，方向为外部至内部邮件服务器|检测Email附件内容中存在Base64编码的'AutoOpen'标志（\"QQB1AHQAbwBPAHAAZQBu\"）|告警针对含有潜在恶意宏的Office文档附件，利用自动运行宏提升社会工程攻击成功率",
      "第2步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从08/23/2024-13:30:21开始到08/23/2024-13:30:21结束，共1条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。",
      "第3步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/24/2024-23:10:42开始到08/24/2024-23:10:42结束，共3条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第4步攻击：T1027: 攻击者通过对PowerShell代码进行字符编码和模糊处理（如Charcode Obfuscation），使得恶意代码难以被安全设备和人员识别，规避检测。  从08/30/2024-19:51:18开始到08/30/2024-19:51:18结束，共2条，其关键特征为HTTP响应体包含大量数字（20个及以上的逗号分隔的三位数字），符合Charcode编码的PowerShell脚本特征|内容中包含PowerShell反射加载常用的 .assembly.gettypes( ) 以及 '-join(((' 字样，暗示字符串拼接和代码重构手法|尝试匹配 .name -like \"amsi\"，通常用于寻找或绕过AMSI防护措施",
      "第5步攻击：T1071.001: 检测到了疑似恶意软件（Win32/FlyStudio/Agent.EW家族）使用HTTP协议（GET方法）与C2（Command and Control，命令与控制）服务器进行通信，属于利用Web协议进行C2流量的行为。  从09/08/2024-14:20:31开始到09/20/2024-09:01:57结束，共7条，其关键特征为HTTP GET请求，URI包含'.php?sdz='参数，暗示特定服务端C2接口。|User-Agent头部为'Windows NT 5.0|'，这是旧版操作系统指示符，可能被用以伪造低可信主机特征。|HTTP头部不包含'Referer'、'Connection'、'Accept-'前缀相关字段，通常为恶意通信精简HTTP报文的体现。",
      "第6步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏Covenant等远控工具与攻击者C2服务器之间的通信，避免被检测。  从09/25/2024-02:36:28开始到01/15/2025-20:42:17结束，共5条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为Meterpreter生成HTTPS回连的典型伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险"
    ],
    "此攻击链关联的原因": "该链路以初始访问（钓鱼带宏）、环境检测、计划任务持久化、PowerShell混淆、Web及加密C2顺序连接，TTP进展及时间序一致，关键环节描述逻辑连贯，行为与复杂APT链特征吻合。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过带AutoOpen宏的钓鱼邮件（T1566.001）实现初始入侵，紧接着PowerShell环境检测（T1497.001）分辨沙箱环境，随后通过高权限计划任务（T1053.005）建立持久性，再以PowerShell混淆（T1027）规避检测。接下来利用Web（T1071.001）及TLS加密（T1573.001）方式与C2服务器通信，实现远程控制与数据回传，整个攻击链自初始入侵到完备控制环环相扣。"
  },
  "chain_8657": {
    "alerts_info": [
      "第1步攻击：T1105: 攻击者通过HTTP协议从恶意站点下载可执行文件（.exe），用于在受害主机上植入后门或执行进一步攻击活动。  从09/02/2024-12:35:11开始到12/15/2024-05:59:21结束，共8条，其关键特征为HTTP GET请求包含对cleaner-software.com域名的访问|请求的URI符合正则 /[a-z]{1,8}[0-9]{0,2}\\.exe，指向一个短字符命名的.exe文件|HTTP User-Agent头包含\"AutoHotkey\"，提示下载与AutoHotkey相关的可执行文件",
      "第2步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从08/22/2024-19:28:02开始到08/23/2024-10:57:19结束，共5条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容"
    ],
    "此攻击链关联的原因": "基于TTP时序（先出现T1105远程文件下载，后有T1555凭证信息收集）及整体攻击主线连贯，虽然存在较长时间间隔（POTENTIAL_GAP），但行为模式与攻防常规吻合，存在数据外泄辅助TTP（T1041）增强相关性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP远程下载并投递AutoHotkey相关恶意可执行文件，随后在主机上利用工具收集用户重要凭证，特征内容通过特定格式可能外传。整体展现出典型的入侵、持久化到信息窃取的数据泄露攻击链，涉及远程投递和敏感数据盗取。"
  },
  "chain_12205": {
    "alerts_info": [
      "第1步攻击：T1105: 检测到恶意软件（如x0Proto）通过命令与控制通道下载和植入后续恶意载荷，可能用于在受害主机上进行代码执行、持久化等后续操作。该行为通常依赖于攻击者与已受感染主机之间的数据传输。  从08/22/2024-19:33:21开始到08/22/2024-19:47:55结束，共5条，其关键特征为流量方向为已建立连接的from_server流，从外部网络到内部主机。|流量中存在特征字节序列x74|0c|1|0c|1x，可能为x0Proto恶意协议下载命令或手法特征。|需要预先标记的et.x0proto flowbits，表明该流为x0Proto相关流量。",
      "第2步攻击：T1059.004: 该告警检测到采用3Proxy远控隧道工具实现远程命令执行。特定的Banner信息（CONTAINS: '* 3Proxy Remote Shell * SSL'）表明攻击者正通过加密信道（443端口）控制受害主机以执行命令。  从08/22/2024-20:11:45开始到08/22/2024-20:11:45结束，共1条，其关键特征为流量方向为服务器（to_server），并建立在TLS/SSL端口（443）；|负载内容包含 '* 3Proxy Remote Shell * SSL'|数据包大小大于100字节，意味着不仅握手，还包含远程控制有效载荷。",
      "第3步攻击：T1059.002: 检测到针对MSSQL服务器的shellcode注入企图，攻击者试图通过注入并执行shellcode来实现对目标主机的远程控制和持续性访问。  从08/23/2024-02:09:11开始到08/23/2024-02:09:11结束，共2条，其关键特征为流向服务器的TCP流（to_server,established）|目标端口为SQL默认端口1433|payload中包含典型shellcode字节序列：9 |D0 00 92 01 C2 00|R|00|U|00|9 |EC 00|（特征性的buffer溢出利用模式，非正常通信数据）",
      "第4步攻击：T1564.001: 告警检测到HTTP POST请求体内包含特征码'PK'，表明数据为ZIP压缩格式，说明攻击者可能通过加密（压缩）文件隐藏、绕过安全检测，将敏感信息（如Cards_Google.txt）上传到外部网络，实现防御规避。  从09/01/2024-10:17:09开始到09/01/2024-10:17:09结束，共1条，其关键特征为HTTP POST方法（http.method; content:\"POST\"）|请求体中出现ZIP文件头特征值'PK'（http.request_body; content:\"PK\"）|请求体中传输名为'Cards_Google.txt'的文件（content:\"Cards_Google.txt\"）"
    ],
    "此攻击链关联的原因": "告警链以T1105（恶意载荷下载）为入口，接续T1059.004与T1059.002（远程命令执行及数据库持久化控制），尾随T1564.001（防御规避/数据外泄）。各步骤行为语义连贯，时间顺序合理，虽有部分阶段缺失，整体符合攻击TTP演进逻辑。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过C2通道下载与植入恶意组件（T1105），随后利用后门工具远程控制终端执行命令（T1059.004），并对数据库主机注入shellcode实现持久化控制（T1059.002）。最后，敏感数据通过HTTP POST携带压缩包方式外传且采用规避侦测（T1564.001），展示完整的定向渗透及破坏流程。"
  },
  "chain_8407": {
    "alerts_info": [
      "第1步攻击：T1083: 该告警检测到Loda Logger恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从08/22/2024-21:33:07开始到08/22/2024-23:25:15结束，共3条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与Loda Logger家族相关，且适用于Windows平台的多版本",
      "第2步攻击：T1057: 攻击者利用恶意软件从受害主机枚举或收集活动进程列表，例如列举svchost.exe等系统进程。该信息可用于对主机态势感知、后续权限提升、规避检测等操作。  从08/23/2024-06:12:42开始到08/23/2024-17:10:23结束，共5条，其关键特征为HTTP协议向外发起GET请求，目的为EXTERNAL_NET|URL参数中包含\"&pl=[System Process]\"，指代进程信息|HTTP URI中出现\"svchost.exe\"关键字，指向关键系统进程相关信息",
      "第3步攻击：T1105: 本Snort规则监测到以HTTP协议形式，从外部网络向内网主机下发的可疑VBS脚本（可能为木马下载器的Payload），属于攻击者通过命令与控制通道传输工具或恶意负载到受害系统典型行为。  从08/24/2024-03:07:59开始到08/25/2024-14:16:44结束，共6条，其关键特征为HTTP响应体中包含特定标签 <component>|VBS脚本语句出现GetDrive(\"C:\")等本地驱动器操作|Windows Installer相关关键词出现（如windowsinstaller.installer, InstallProduct, SerialNumber）",
      "第4步攻击：T1055.001: 攻击者通过HTTP响应体恶意插入Javascript web inject代码，引导用户下载并运行恶意文件，从而回避安全检测和直接绕过浏览器安全策略，促进恶意Payload执行。  从08/27/2024-12:58:11开始到08/27/2024-12:58:11结束，共1条，其关键特征为HTTP响应体包含多段与下载、运行文件相关的提示文案（如“file to browse our website.”、“file has already been downloaded, you will find it in Downloads...”）|响应体中嵌入多段与JS自动文件下载相关的代码（如downloadFile(url, fileName)、setAttribute('download', fileName)、URL.createObjectURL等Web API调用）|采用社会工程诱骗（如弹窗/提示）诱导用户下载并执行疑似恶意程序，利用双击及F5刷新指示迷惑用户操作。",
      "第5步攻击：T1573.001: 告警检测到基于C2专用加密隧道工具Beehive，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/09/2024-21:22:45开始到09/11/2024-07:29:19结束，共3条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第6步攻击：T1112: 攻击者PowerShell后门或自研工具进行注册表项创建或修改，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从09/24/2024-19:17:28开始到09/24/2024-19:17:28结束，共1条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容与恶意工具所用注册表操作方式特征吻合|触发条件为后门与被控端交互，指向主动注册表操作",
      "第7步攻击：T1071.001: 此Snort规则检测通过HTTP POST方法向外部C2服务器发送特殊格式的数据流量。攻击者通常利用HTTP(S)协议进行回连，实现与被控终端的隐秘通信。规则特征表明利用常见通信路径如/notification，结合固定的HTTP头及Body，是典型的C2流量特征。  从10/11/2024-02:59:44开始到10/21/2024-16:15:41结束，共6条，其关键特征为HTTP POST请求，URI为/notification，起始特征明显|请求体中包含\"{ \"locale\":\"en\",\"channel\":\"prod\",\"addon\":\"\" 字符串，特征较固定，存在字段 nid, msg-|HTTP头包含Accept: */*，Accept-Encoding: gzip, deflate, br，Accept-Language: en-US"
    ],
    "此攻击链关联的原因": "攻击链按TTP时序递进，先发现与枚举主机信息（T1083/T1057），随后恶意载荷传输（T1105）、利用Web注入与提权（T1055.001），接着高危C2通信隧道（T1573.001）、注册表持久化（T1112）、数据回传与C2（T1071.001）；时间线和行为语义均连续。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过Loda Logger进行主机驱动枚举与进程查看，随后向内网主机植入可疑VBS脚本和Web注入，诱导用户下载运行恶意Payload，利用自签TLS证书进行加密C2通信，后续通过Meterpreter注册表操作持久化，最后以HTTP POST方式回传数据实现完全控制与数据渗出，形成典型APT多阶段攻击链。"
  },
  "chain_22202": {
    "alerts_info": [
      "第1步攻击：T1583.001: 攻击者注册了与有效载荷相关的恶意域名（如 deftsecurity.com），并通过其进行后门C2活动，为Cobalt Strike Beacon建立了SSL通信通道。  从08/22/2024-23:21:43开始到08/22/2024-23:23:30结束，共3条，其关键特征为SSL/TLS通信，证书主题字段包含CN=deftsecurity.com|流量方向为外部到内部，建立的TLS连接",
      "第2步攻击：T1027: 检测到利用JavaScript对Bitsadmin命令进行字符级混淆，通过String.fromCharCode动态拼接，从而逃避静态检测和安全分析。这是恶意代码常见的防御规避手段。  从09/10/2024-17:44:38开始到09/11/2024-09:57:01结束，共3条，其关键特征为HTTP响应码200，来自服务器，流已建立|file.data中存在大量String.fromCharCode动态构造的bitsadmin命令字符串|URL路径含/transfer，指向可能的数据/载荷下载接口",
      "第3步攻击：T1204.002: 检测到从 Discord CDN 下载 .exe 可执行文件，攻击者通常通过社交工程诱导用户下载并执行该恶意文件，实现初始入侵或后续攻击。  从08/28/2024-18:32:06开始到08/28/2024-18:32:06结束，共1条，其关键特征为HTTP协议下由服务器返回状态码200，表示成功下载文件。|HTTP响应体中包含以 https://cdn.discordapp.com/attachments/ 开头的URL，表明文件托管于Discord CDN。|下载文件以 .exe 结尾，文件体积小于150字节，且已知MD5哈希值与恶意软件相关。",
      "第4步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。  从09/02/2024-08:13:14开始到09/02/2024-08:13:14结束，共1条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第5步攻击：T1027.003: 攻击者通过将配置信息隐藏（嵌入）到图片文件中来混淆恶意内容，实现数据隐藏并规避检测。这种利用图片文件传递配置数据的方式，是一种经典的隐写术（Steganography）手段。  从09/24/2024-10:23:20开始到09/24/2024-10:23:20结束，共1条，其关键特征为当前流量为 HTTP，方向为服务器到内部主机，且已建立连接（flow:from_server,established）|图片文件内存在特定的二进制与文本签名（内容 '0103F|00|'，后随'|ff fe|'，正则匹配完整特征）|利用文件内容长度、无零字节等细粒度检测表明为带有嵌入数据的图片结构",
      "第6步攻击：T1574.002: 攻击者通过在SMB共享等网络路径中植入恶意DLL，诱导受害主机加载攻击者控制的库文件，实现代码执行或绕过安全控制，进而维持长期访问或进一步入侵。  从10/09/2024-23:53:55开始到10/09/2024-23:53:55结束，共1条，其关键特征为SMB协议（端口139）流量，指向外部网络|捕获含有‘|FF|SMB|a2|’字节序列及‘\\*.dll’请求，触发指示尝试加载远程DLL|与CVE-2011-0029和CVE-2010-3190漏洞相关，目标为微软客户端应用的不安全库加载行为",
      "第7步攻击：T1055.001: 利用MySQL服务器将自定义可执行文件（.exe）写入Windows系统目录（C:\\windows\\system32），以便后续执行，以达到绕过安全控制、潜在获取SYSTEM权限等目的。此方法为通过数据库滥用获得持久化。  从11/12/2024-04:50:41开始到11/13/2024-12:07:16结束，共3条，其关键特征为对MySQL服务（TCP 3306）的写入型SQL命令检测（INTO DUMPFILE 指向 C:\\windows\\system32\\*.exe）|SQL查询中带有SELECT data FROM ..., INTO DUMPFILE，目标为可执行文件（.exe）|利用MYSQL DUMPFILE功能直接在系统关键目录写入新文件，实现恶意持久化或远程利用",
      "第8步攻击：T1055.003: 攻击者通过向目标进程的堆内存注入大量NOP或特定字节（如0x41，实现Heap Spray），以人为创造可控的代码执行区，常辅以后续漏洞利用。这种方式常用于网页浏览器等客户端，达到攻击代码的顺利注入。  从11/21/2024-16:41:27开始到11/21/2024-16:41:27结束，共1条，其关键特征为HTTP协议流量，方向为established,to_client（从外部到内部主机）|特征payload包含URL编码的%41%41%41%41（即AAAA）字节序列，属于常见NOP-sled填充，表明Heap Spray攻击特征|使用heap spray技术特征明显，通常出现在利用网页漏洞或未授权脚本加载场景",
      "第9步攻击：T1071.001: 此告警检测到恶意软件通过HTTP协议与外部服务器进行通信，通常用于建立持久的命令与控制信道，允许远程攻击者向受感染主机发送命令或提取数据。  从12/03/2024-07:23:18开始到12/03/2024-07:23:18结束，共3条，其关键特征为HTTP协议流量，方向为本地主机到外部网络（to_server, established）|HTTP请求URI包含特定路径和参数：/index.php?data=66a96e28"
    ],
    "此攻击链关联的原因": "以TTP为线索，呈现由基础设施准备（T1583.001）、各类隐写与混淆（T1027/T1027.003）、初始访问与植入（T1204.002/T1620），再到本地持久化与内存注入（T1574.002/T1055.001/T1055.003），最终建立C2（T1071.001）整体链路。部分链路基于时间推进及辅助TTP语义补足，允许阶段缺失。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该攻击链描述了攻击者由注册恶意域名并搭建C2 (T1583.001)，通过混淆与隐写手段隐藏真实载荷（T1027/T1027.003），再引导初始访问（T1204.002）及在移动端植入（T1620），继而利用DLL劫持与内存注入（T1574.002/T1055.001/T1055.003）等获得持久控制与提权，最终建立HTTP C2通道（T1071.001），具备典型的多阶段渗透及隐蔽通信特征。"
  },
  "chain_6809": {
    "alerts_info": [
      "第1步攻击：T1105: 告警检测到受感染主机使用恶意宏文档（MalDoc）下载恶意负载，请求参数和User-Agent显示由脚本自动化方式下载。这属于通过网络从攻击者控制的服务器拉取二进制或脚本工具的典型行为。  从08/22/2024-23:46:19开始到08/23/2024-01:10:11结束，共3条，其关键特征为HTTP GET请求，URI包含'.php?op=1'作为参数。|User-Agent为'Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)'，模拟Windows自动化HTTP请求。|Referer字段以'.hta'结尾，指示可能由恶意HTML应用程序启动。",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从08/23/2024-18:59:08开始到08/24/2024-08:24:22结束，共8条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从08/26/2024-20:18:36开始到08/26/2024-20:18:36结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1204.002: 告警检测到通过HTTP下发携带恶意LNK快捷方式文件(可能诱使用户点击触发后续攻击链)，属于钓鱼或恶意附件投递常用的用户执行路径。  从08/29/2024-09:32:55开始到09/18/2024-15:12:57结束，共3条，其关键特征为HTTP协议会话，方向为外部到内部|载荷中出现字符串\"ExpandEnvironmentStrings(\\\"%Temp%\\MaGiaiNenNe.txt\\\")\"，提示LNK利用环境变量定向恶意文件|已知恶意LNK相关MD5: 57f02fe8fa9d096e5ac9b6c9be66f05b"
    ],
    "此攻击链关联的原因": "以TTP演进主线串联：T1105（C2载荷下发/远控）→T1574.002（DLL劫持横向移动）→T1547.001（启动项持久化）→T1204.002（LNK诱导用户执行）。时间顺序基本合理，阶段之间部分存在MISSING_STEP，基于TTP语义补全存在上下文。2032891从诱导投递在时序上偏后，存在一定不确定性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过恶意宏文档下载后门载荷并远控主机，继而利用DLL劫持实现横向移动及权限提升，再通过启动项持久化增强驻留能力。最后，攻击者疑似投递LNK恶意快捷方式诱使用户执行，形成一条自投递、远控、横向移动到持久化与诱导执行的完整链路。"
  },
  "chain_21325": {
    "alerts_info": [
      "第1步攻击：T1556.002: 攻击者通过模拟浏览器内弹出的伪造认证窗口，诱骗受害者输入敏感信息（如凭证），实现窃取。该方法通常用于鱼叉式钓鱼，令用户误以为自己正在与合法服务进行交互。  从08/29/2024-23:09:27开始到08/29/2024-23:09:27结束，共1条，其关键特征为HTTP响应状态码为200（成功响应）|内容包含可映射BITB攻击的JS变量名（如ileft、itop、draggable、addClass、window、exit、titleBar）|流量方向为外部到内部，HTTP响应，内容特征符合完全模拟浏览器伪登录窗口的JavaScript实现",
      "第2步攻击：T1112: 攻击者通过PoshC2攻击框架的相关PowerShell命令创建或修改Windows注册表项，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从08/23/2024-01:33:14开始到08/23/2024-01:34:11结束，共4条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含PowerShell改动注册表的命令特征，且存在PoshC2通信关联|触发条件为PowerShell命令与被控端交互，指向主动注册表操作",
      "第3步攻击：T1048.003: 该告警检测到恶意软件利用SMTP协议（端口587，常用于邮件传输）将收集到的敏感信息（如凭证）通过电子邮件发出，实现数据渗出。  从09/15/2024-11:41:53开始到11/02/2024-03:18:22结束，共8条，其关键特征为目的端口为587（SMTP Submission），与邮件相关的应用层协议|邮件内容中存在特定字符串如“PassReg”和“BlatBoundary”，与已知恶意软件行为特征相符|内容字段“name=\"pass.””出现，结合Blat工具特征，说明可能是通过脚本或工具批量提交凭证"
    ],
    "此攻击链关联的原因": "该链条建立在TTP顺序进展（凭证钓鱼->持久化->数据渗出）、时间顺序、凭证盗取与后续利用及exfil语义连贯之上。alert 2851335辅助TTP T1566.002作为初始访问导入分析，整体行为逻辑自洽，尽管中间存在一定时间间隔与步骤缺损，整体故事完整。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击首先通过模拟认证窗口（如BITB技术）进行钓鱼欺骗，窃取用户凭证，后利用Meterpreter修改注册表以持久化，提高长期控制能力，最终利用SMTP通道将收集到的敏感数据进行外发，实现数据渗出。全链条覆盖初始访问、持久化、并最终完成信息渗透，攻击路径高度一致。"
  },
  "chain_12875": {
    "alerts_info": [
      "第1步攻击：T1036: 攻击者通过构造具有伪造内容的.csv文件，使其看似为合法的Bacnet OPC Client数据文件，从而规避检测。该攻击利用了CVE-2010-4740漏洞，向SCADA系统传递包含恶意内容的文件。  从10/17/2024-03:09:19开始到10/17/2024-03:09:19结束，共1条，其关键特征为检测到含有特定结构的CSV头部（OPC_TAG_NAME,OBJECT_TYPE,INSTANCE,OBJECT_NAME\\n\\）|OPC Client通信过程中，文件内容匹配关键字符串和特定分隔符|通信流量属于从服务器流向受害主机 (flow:from_server,established)",
      "第2步攻击：T1574.001: 攻击者利用应用程序的不安全库加载方式，通过在目标系统上放置特制的 sensor.dll 文件，实现加载恶意 DLL 以执行攻击操作。本攻击基于 Mozilla Firefox/Thunderbird 存在的 sensor.dll 不安全库加载漏洞（CVE-2011-2980）。  从11/06/2024-17:10:51开始到11/06/2024-17:10:51结束，共2条，其关键特征为检测到 SMB 协议（TCP 139端口）通信|SMB 协议流量中特有指纹：|ff|SMB|a2|，byte_test 校验SMB包类型|请求体出现“\\sensor.dll”关键字符串，表明进行不安全 DLL 加载操作",
      "第3步攻击：T1059.005: 检测到入站WEB流量中出现了倒写的Wscript.Shell（llehS.tpircSW），这通常用于绕过内容检测，暗示目标端点在后续可能会执行恶意的VB脚本代码利用Wscript.Shell发起命令或加载额外恶意内容。  从01/09/2025-13:46:17开始到02/18/2025-02:29:00结束，共5条，其关键特征为HTTP响应状态码为200（请求成功，通常伴随内容分发）|文件体内容包含倒写的llehS.tpircSW（Wscript.Shell）字符串|流量方向为外部网络到内部，HTTP established，to_client"
    ],
    "此攻击链关联的原因": "通过TTP阶段合理顺序（伪装文件→持久化DLL劫持→脚本命令执行），时间连续且行为语义逻辑衔接。部分环节（如初始入侵）缺失，存在MISSING_STEP，链路场景符合一般Windows环境攻击流程。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于攻击者投递伪装的恶意.csv文件（T1036）以绕过检测，随后利用DLL劫持漏洞（T1574.001）在目标系统实现持久化，并最终通过网络分发倒写Wscript.Shell编码的脚本（T1059.005）触发命令执行，实现对主机的进一步控制。"
  },
  "chain_17906": {
    "alerts_info": [
      "第1步攻击：T1210: 攻击者利用MS17-010（ETERNALBLUE）漏洞对目标主机的SMB服务进行远程漏洞利用，从而实现对目标系统的初始入侵。该行为属于通过利用易受攻击的服务在目标网络实现未授权访问。  从08/23/2024-02:35:27开始到08/23/2024-02:37:09结束，共3条，其关键特征为匹配SMB协议流量中包含永恒之蓝漏洞利用特征字节流（如 |00 00 00 31 ff|SMB|2b 00 00 00 00 98 07 c0| ）|请求中包含特定标识的payload内容（如 |4a 6c 4a 6d 49 68 43 6c 42 73 72 00| ），高概率是攻击工具生成的shellcode标识|流量方向为from_server且会话已建立（即服务器侧响应中包含Exploit特征），表明已进入利用或已成功阶段",
      "第2步攻击：T1555.003: 该告警检测到Bookcode恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从08/26/2024-16:22:59开始到08/27/2024-07:01:12结束，共3条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。"
    ],
    "此攻击链关联的原因": "第一个告警通过T1210（SMB外部服务利用）完成初始入侵，随后在同主机检测到T1555.003（浏览器凭证窃取），两者具备时间连续性与攻击链上下游关系。虽然中间缺少行为，但TTP语义和攻击流程高度适配，推测为同一攻击链，存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先利用ETERNALBLUE（T1210）对目标主机进行远程漏洞利用，实现初始入侵或权限提升，之后通过恶意程序收集主机浏览器中保存的账户凭证（T1555.003），为后续横向移动及权限扩展做准备。攻击流程自外部渗透转向内网数据获取，体现了典型的入侵和内部信息窃取链路。"
  },
  "chain_19609": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到攻击者通过伪造的网页实施网络钓鱼，诱导用户提交用户名和密码，实现对用户凭证的窃取。恶意网页通常仿冒合法网站，诱使用户填写敏感信息。  从08/23/2024-08:12:23开始到08/23/2024-08:12:23结束，共1条，其关键特征为HTTP POST方法，目标为.php后缀的Web脚本，且主机名以.atwebpages.com结尾，明显非常规企业域名。|HTTP请求体中包含特定参数（&j_username= 和 &j_password= 和 &_eventId_proceed=），表明是模拟登录提交动作。|告警特意排除了.edu结尾的域名，针对非教育领域的凭证钓鱼攻击，指向目标用户群体为普通企业/机构。",
      "第2步攻击：T1204.002: 检测到网络中通过HTTP协议，Content-Disposition头部以附件方式分发名为server.exe的可执行文件，此行为通常与恶意活动相关，旨在让目标系统获得可执行后端程序，从而实现进一步的恶意代码执行。  从08/23/2024-08:47:58开始到08/23/2024-08:48:10结束，共4条，其关键特征为HTTP协议中Content-Disposition头部带有attachment; filename=\"server.exe\"|HTTP响应流指向本地网络（$HOME_NET）的客户端|可执行文件名为server.exe，常见于恶意载荷",
      "第3步攻击：T1140: 检测到具有APT相关的HUI Loader Dropper恶意活动，通过下载伪装成.NET DLL XML的恶意文件，利用特定格式绕过传统检测，进行有效负载投递及规避安全产品检测。  从08/23/2024-09:22:05开始到08/23/2024-09:22:05结束，共1条，其关键特征为HTTP GET请求方式|请求URI结尾为.dlI.xml，符合特定APT Dropper下载特征|User-Agent格式为UUID (^[0-9a-f]{8}-(?:([0-9a-f]{4})\\-){3}[0-9a-f]{12}$)，具备唯一标识和溯源性",
      "第4步攻击：T1059: 此告警检测到Win32恶意载荷的入站传输，恶意载荷可能通过HTTP响应被下发到客户端终端，供后续的代码执行。该行为通常表现为远程执行下载或传递恶意有效载荷，属于典型的执行阶段前的资源传递与加载。  从08/24/2024-00:16:24开始到08/24/2024-00:16:24结束，共1条，其关键特征为HTTP响应头存在Content-Disposition: filename=<IP>.txt，疑似以IP命名、模拟文本文档下发恶意载荷。|HTTP响应体包含特征内容（如codemark|00 00 00 00|等特殊字节序列），匹配精确payload结构。|多处PCRE正则校验、特定原始字节内容，如|00 7c 00|、|00 3a 00|、|00 7c 00 00 00|等特征，表明payload深度定制且具备反取证混淆。",
      "第5步攻击：T1547.001: 攻击者通过滥用 ChilkatHttp ActiveX 控件存在的漏洞，能够任意覆盖指定文件（如exe、dll、bat等可执行文件及配置文件），从而实现在受害主机上植入恶意代码，获得持久化或规避检测。  从09/01/2024-18:56:55开始到09/01/2024-19:12:46结束，共4条，其关键特征为HTTP流量（to_client, established），表明通过Web途径下发恶意代码|包含 ChilkatHttp ActiveX 控件 CLSID（B973393F-27C7-4781-877D-8626AAEDF119），且请求目标包含.ini、.exe、.dll、.bat、.com、.cab、.txt等敏感扩展名|出现 SaveLastError 字段，关联控件常用调用接口，可能伴随目标文件被覆盖/写入行为",
      "第6步攻击：T1573: 本次告警捕获到Win32/XWorm V2恶意软件尝试通过加密信道与远程C2服务器进行通信，这种方式绕过了传统的明文检测，提升攻击者操控受害主机的隐蔽性。  从09/19/2024-07:26:14开始到09/22/2024-13:22:55结束，共9条，其关键特征为识别到19字节长度的特征二进制流，十六进制内容为31 36 00 ba fe fd a8 0d 0b db dc 77 df 46 3f eb 91 42 6b|流量方向为本地可信网段向外部网络，且已建立TCP会话，为推测C2通信流量|告警标记恶意家族为Xworm，相关MD5为6f4ecd94baf6784511b973c2c7ad3d1c",
      "第7步攻击：T1047: 检测到流量中包含WMIC命令提示符，表明攻击者很可能利用WMIC进行远程命令执行或管理目标主机，主要用于横向移动以获取对更多系统的访问权限。  从09/30/2024-15:28:31开始到10/01/2024-11:41:19结束，共4条，其关键特征为TCP协议，已建立会话|通信内容包含字符串 'wmic:root\\cli>'|通信方向为从内部网络到外部网络，提示为攻击响应流量，管理命令可能已被远程执行"
    ],
    "此攻击链关联的原因": "依据TTP纵深推进链条，从网络钓鱼（T1566.001）引发恶意载荷投递、Dropper混淆、持久化与命令控制，实现横向移动阶段。各环节描述及流量上下文均强化了阶段过渡与行为连贯性。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过网络钓鱼窃取凭证后，分发可执行文件与Dropper实现payload落地与混淆，Win32载荷入站后结合ActiveX持久化，植入XWorm开启加密C2通信，最终利用WMIC命令远程横向移动，形成从初始访问到持久控制及横向渗透的APT攻击链。"
  },
  "chain_530": {
    "alerts_info": [
      "第1步攻击：T1543.003: 攻击者通过创建新的Windows服务实现持久化。Snort规则检测到了SMB协议中创建名称为 'not_sliver' 的服务请求，表明sliver远控工具试图利用SMB协议，在目标主机上创建恶意服务实现长期驻留。  从08/23/2024-08:23:11开始到08/23/2024-08:34:52结束，共3条，其关键特征为SMB协议（445端口）|服务名特征字符串 'not_sliver'，以Unicode编码出现在SMB流量中|SMB CreateService 请求数据包，常见为sliver远控类工具的典型操作",
      "第2步攻击：T1057: 该告警检测到DarkFinger恶意软件尝试远程检索受害主机上的进程列表（如tasklist），常见用法为攻击者收集目标主机的活动进程信息，为后续操作做准备。  从08/23/2024-12:59:07开始到08/23/2024-12:59:07结束，共1条，其关键特征为TCP协议通信, 方向为内网主机->外部网络（to_server）|通信数据包体积极小（dsize:<9），疑似命令信号或指令下发包|数据包内容出现‘.Image’字样，结合DarkFinger参考资料疑似与恶意命令通信格式相关",
      "第3步攻击：T1005: 攻击者通过恶意软件收集受害主机上的系统信息（如主机名、操作系统、OS配置等）。此类信息通常会被攻击者用于后续攻击阶段的识别、横向移动和持久化操作。  从08/27/2024-10:12:20开始到09/03/2024-12:48:41结束，共4条，其关键特征为通过HTTP POST方法向外部服务器发送数据（http.method;content:\"POST\"）|请求的URI中包含.php扩展（http.uri;content: \".php\"）|请求体包含操作系统和主机详细信息字段（如\"Host Name:\", \"OS Name:\", \"OS Configuration:\", 编码为%0D%0A分割）",
      "第4步攻击：T1119: Loda Logger通过远程命令自动枚举受害主机上的桌面文件，属于恶意软件自动化收集文件内容与信息的行为，以便后续窃取敏感数据。  从09/10/2024-16:31:59开始到09/10/2024-16:31:59结束，共4条，其关键特征为特定内容匹配：流量中包含'|44 65 73 6b 44 69 72|'（ASCII为'DeskDir'），表明列举桌面目录请求。|流量方向：检测到从外部网络(EXTERNAL_NET)发送到内部主机(HOME_NET)，且为已建立的会话流量。|针对已感染终端，表明主机或被控端正在与远程C2进行恶意数据交换。",
      "第5步攻击：T1070.004: 恶意软件远控响应中包含 'Uninstall backdoor' 指令，指示恶意软件在客户端卸载自身。这一行为旨在通过删除后门程序及相关痕迹，降低被检测和取证概率，属于防御规避手段。  从09/11/2024-22:14:38开始到09/11/2024-22:14:38结束，共1条，其关键特征为HTTP协议服务器到客户端（to_client）方向的数据流|响应体内容包含 'Uninstall backdoor' JSON格式字段：|3a 20 22|Uninstall|20|backdoor|22|"
    ],
    "此攻击链关联的原因": "基于TTP时间顺序与ATT&CK战术阶段递进，指向典型持久化、发现、信息收集、文件收集及终端清痕的攻击链，TTP逻辑连续，行为特征与高权限驻留型APT攻击一致，时间间隔未超APT范畴，部分阶段间缺失详细步骤（MISSING_STEP标记）。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过SMB服务创建实现持久化（T1543.003），随后利用恶意软件获取进程与系统信息（T1057, T1005），并进一步收集桌面文件（T1119）配合HTTP外传及与C2通信（T1041, T1071.001），最后通过“卸载后门”操作清除攻入痕迹（T1070.004），整体符合渗透、横向发现、内网收集到终端撤离全过程APT攻击逻辑。"
  },
  "chain_7632": {
    "alerts_info": [
      "第1步攻击：T1518.001: 该告警检测到PowerShell脚本通过WMI查询（SELECT * FROM AntiVirusProduct）来识别受害主机上已安装的防病毒产品信息，这通常用于攻击者了解受害环境中所部署的安全防护措施。  从08/23/2024-08:23:50开始到08/23/2024-08:26:48结束，共3条，其关键特征为HTTP协议响应中带有200状态码，表示成功的下载操作|HTTP内容包含SELECT * FROM AntiVirusProduct，表明WMI查询本地防病毒产品信息|出现.Net.WebClient与.Download，指示通过PowerShell远程下载行为",
      "第2步攻击：T1546.015: 利用CVE-2023-23397，攻击者通过特制的消息触发Outlook客户自动解析恶意任务文件，利用Exchange的新特性，造成凭据窃取和权限提升。  从08/30/2024-03:15:51开始到08/30/2024-03:15:51结束，共1条，其关键特征为SMTP协议流量，针对$HOME_NET或SMTP服务器|邮件内容含有Base64编码且包含特殊标识（例如AElQTS5UYXNr和IPM.Task）|任务文件中带有注入的UNC路径（如\\\\attacker.com\\），并存在二进制序列|78 9f 3e 22|，典型CVE-2023-23397利用特征",
      "第3步攻击：T1547.001: 攻击者通过HTTP GET访问特定路径（/install.bak/），可能用于恶意软件安装或留存，利用启动项或脚本机制实现持久化。  从09/05/2024-13:09:25开始到09/05/2024-13:09:25结束，共1条，其关键特征为HTTP GET方法，访问特定路径 /install.bak/|User-Agent 为 'Mozilla/4.0'，缺失 Referer 头部|URI中包含/[0-9]{2}\\.html结尾的结构",
      "第4步攻击：T1068: 该攻击利用了Netlogon远程协议（MS-NRPC）中的特定漏洞（CVE-2020-1472，也称「Zerologon」），允许攻击者通过向目标域控制器发送特制网络包，在无需已知任意账户凭证的情况下，重置本地Active Directory域控制器的机器账户密码，进而获得对域的完全控制权限。  从09/18/2024-18:46:10开始到09/18/2024-18:46:10结束，共1条，其关键特征为利用DCERPC Netlogon协议（MS-NRPC），流量特征包含dcerpc.rpcnetlogon服务|NetrServerAuthenticate3请求包体特征：0x00 Client Challenge，Sign and Seal标志被禁用（nosignnoseal）|在短时间内（如30秒内）多次尝试（如5次以上）异常认证请求及0x00填充数据包",
      "第5步攻击：T1555.003: 该告警检测到Win32/BrowserPassview恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从11/02/2024-22:14:27开始到11/19/2024-05:22:08结束，共3条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。",
      "第6步攻击：T1071.001: 此告警检测到恶意软件通过HTTP GET请求向外部C2服务器进行通信，该通信采用Web协议（HTTP）作为命令与控制信道，常见于C2通信初期的上线或心跳阶段。  从01/08/2025-11:54:12开始到02/02/2025-13:01:29结束，共4条，其关键特征为HTTP GET请求包含特定路径/lib.asp?id=|Accept头为*/*且Accept-Encoding为gzip, deflate，模仿常见浏览器行为|请求头部不包含Referer和Cache字段，表现出非正常浏览习惯，指向自动化流量"
    ],
    "此攻击链关联的原因": "以TTP时序为主，覆盖侦察、初始访问、持久化、权限提升、凭证获取、C2控制环节，尤其通过sec_ttps和行为描述补全TTP链条；阶段连续性较强，但存在部分步骤缺失（MISSING_STEP）。总体攻击故事及关键操作链条贯通。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击起始于对防护软件环境侦察（T1518.001），随后通过利用CVE-2023-23397邮件特性实施凭证窃取与权限提升（T1546.015），紧接着使用HTTP通信实现持久化（T1547.001）。之后，攻击者利用Zerologon漏洞（T1068）实现高权限控制，提取浏览器凭据（T1555.003），并通过HTTP C2隧道（T1071.001）实现远程操控与数据外传，完整覆盖了渗透、持久、扩展至信息窃取和远控的多阶段攻链。"
  },
  "chain_16329": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击者通过发送包含恶意_zip_附件（在本规则中为发票相关内容）的电子邮件，诱骗目标用户打开带有恶意代码的压缩包文件，实现初始的系统访问。  从08/23/2024-08:35:42开始到08/23/2024-08:35:42结束，共1条，其关键特征为SMTP协议出站流量，目标方向为外部网络|邮件主题包含 'Invoice' 且匹配正则（/^Subject\\x3a\\x20.+invoice.+$/mi）|邮件正文/头部出现附件名包含 '.zip' 的发票型文件",
      "第2步攻击：T1593: 本规则检测到HTTP流量中携带有疑似恶意Powershell代码，使用System.Net.FtpWebRequest组件，可能通过恶意内容投递到受害终端并诱使用户执行，属于攻击者初步渗透的环节。  从08/25/2024-09:48:36开始到08/25/2024-10:57:13结束，共3条，其关键特征为检测到HTTP报文Body中包含System.Net.FtpWebRequest字符串|匹配到Powershell恶意模块特征，且流量方向为to_client（流入内部终端）|告警针对Windows平台客户端，说明攻击面主要为终端用户",
      "第3步攻击：T1059.007: 检测到通过HTTP传输含大量String.fromCharCode拼接的JScript代码，属于利用JavaScript代码进行Payload解码和远程执行，是攻击者在受害主机浏览器或脚本引擎环境中实现代码执行的常见方式。  从09/02/2024-22:14:58开始到09/03/2024-03:11:25结束，共6条，其关键特征为HTTP文件传输场景，响应代码200，证明内容成功下发。|JScript代码中存在大量String.fromCharCode拼接（正则及内容匹配），用于字符混淆和动态解码。|内容中出现\\\\WMIC.exe\\\"，指示目标为调用Windows管理工具实现后续操作。",
      "第4步攻击：T1543: 检测到通过User-Agent字段中的特征字符串启用持久控制程序，已知与X-Agent（Sednit）等后门家族活动有关，具有指向恶意远控的威胁情报哈希参考（MD5: 3d18363a20882bd74ae7e0f68d3ed8ef）。  从09/03/2024-17:46:19开始到10/18/2024-11:06:44结束，共10条，其关键特征为HTTP协议流量，User-Agent字段中前5字节包含'build'且紧跟一位数字（如build1、build2等）|正则表达式/^build\\d/匹配，紧贴User-Agent头开始处|已知与X-Agent（Sednit）后门家族活动有关，具有指向恶意远控的威胁情报哈希参考（MD5: 3d18363a20882bd74ae7e0f68d3ed8ef）",
      "第5步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从10/09/2024-01:37:49开始到10/09/2024-01:37:49结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。"
    ],
    "此攻击链关联的原因": "基于钓鱼邮件初始访问（T1566.001）—恶意脚本投递（T1593）—JavaScript代码执行并通过WMIC工具实现系统操作（T1059.007），再到后门持久运行（T1543）及设定自启动实现持久化（T1547.001）。各TTP阶段衔接和时间顺序强相关，链路语义连贯。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "本攻击链以钓鱼邮件诱骗用户打开恶意压缩包为初始入口，随后通过Web渠道投递可疑Powershell脚本，进一步执行混淆后的JavaScript Payload（利用WMIC工具达成本地命令执行），最终感染植入Delf/Troxen/Zema后门实现持久远控，并借助自启动机制加强主机持久驻留，展现了从初始渗透到长期控制的完整攻击过程。"
  },
  "chain_18503": {
    "alerts_info": [
      "第1步攻击：T1588.002: 告警识别到基于fakeTLS下伪造的自签证书HTTPS 会话中使用了具有固定特征的自签数字证书，属于攻击者为隐匿通信流量、绕过安全设备检测而获取或伪造数字证书的行为。  从08/23/2024-08:52:07开始到08/23/2024-17:14:59结束，共3条，其关键特征为通过TLS协议建立的会话，方向为外部到内部，回连场景|TLS证书Subject字段中存在固定的Metasploit生成特征: C=US, ST=、O=、OU=bus, CN=、/emailAddress=bus@|该证书结构高度匹配逆向HTTPS连接默认行为",
      "第2步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/01/2024-09:23:17开始到09/03/2024-13:56:14结束，共4条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第3步攻击：T1547: 检测到Manuscrypt后门通过设置持久化命令，以确保恶意代码在系统重启或者用户登录后能够自动执行，实现长期驻留。  从09/20/2024-00:47:11开始到09/20/2024-00:47:11结束，共2条，其关键特征为Snort规则检测TCP从外部服务器回送到内部主机，端口大于1024|特定payload内容：\"persistent\\x0a\"，表示持久化操作命令|流量方向为已建立连接（流量为from_server），主要影响Windows客户端",
      "第4步攻击：T1083: 该告警检测到通过wmic/自定义powershell脚本枚举磁盘恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从09/28/2024-23:12:00开始到09/28/2024-23:12:00结束，共1条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与wmic/自定义powershell脚本相关，且适用于Windows平台的多版本",
      "第5步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从10/21/2024-16:02:19开始到10/21/2024-16:02:19结束，共2条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第6步攻击：T1570: 攻击者利用SMB协议将远程管理工具（如WMIC）或恶意代码在受害内网主机间进行移动与投放，从而实现横向渗透。此规则检测到通过SMB协议请求中包含WMIC关键字，表明存在利用WMI进行横向移动的行为。  从11/18/2024-12:45:46开始到12/04/2024-10:13:10结束，共4条，其关键特征为SMB协议流量（flow:established,to_server）|SMB报文中出现\"wmic\"字符串（content:\"|00|w|00|m|00|i|00|c|00|\")|涉及目标主机为$HOME_NET，表明有可能是内网横向渗透",
      "第7步攻击：T1027: 该规则检测到了可疑的压缩文件（.zip）通过HTTP POST方法在出站方向上传输，这通常用于绕过检测和规避安全机制，如数据外泄时对敏感文件进行压缩归档，降低被发现的风险。  从01/15/2025-19:31:25开始到02/02/2025-06:44:12结束，共3条，其关键特征为HTTP POST方法用于上传数据|请求体内包含Zip文件特征码（PK）|压缩包内含“InfoHERE.html”文件名，易被攻击者用于指定泄露文件名"
    ],
    "此攻击链关联的原因": "依循TTP序列，涵盖武器获取、混淆载荷、持久化、发现、凭据窃取、横向移动与数据规避等全链路阶段，情节与APT长期渗透特征吻合，部分环节时间间隔较大，存在POTENTIAL_GAP与MISSING_STEP，链条语义连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于攻击者伪造自签证书获取基础远控能力，并通过混淆Powershell脚本绕过检测后成功植入持久化后门。随后开展主机发现、驱动枚举，进一步窃取凭据，并利用SMB+WMIC进行横向移动，最终通过HTTP压缩包外传信息，实现典型APT全流程渗透与数据泄露。"
  },
  "chain_16597": {
    "alerts_info": [
      "第1步攻击：T1105: 该告警检测到疑似APT下载器CeeInject向远程服务器请求恶意Payload（载荷），属于通过C2通道传输工具或恶意文件的行为。这是攻击者维持控制并进一步投递恶意组件的常见手段。  从08/23/2024-09:11:23开始到08/23/2024-09:11:23结束，共1条，其关键特征为TCP协议，主机对外已建立连接（flow:established,to_server）|有效载荷长度为3字节，内容为'OK <NULL_BYTE> <NULL_BYTE>'|指纹与CeeInject家族关联",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从08/24/2024-14:45:48开始到08/25/2024-19:13:10结束，共3条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1059.005: 该告警检测的是传送到客户端的JavaScript脚本片段，特征显示其由SharpShooter框架生成。SharpShooter可用于动态生成恶意payload，通过浏览器脚本执行，攻击者可借此在目标主机上远程执行代码。  从09/12/2024-02:53:11开始到12/09/2024-23:15:57结束，共5条，其关键特征为HTTP协议数据流中的JavaScript代码包含特定关键字，如rc4=function、key.charCodeAt、decodeBase64=function等，匹配SharpShooter框架生成脚本逻辑。|脚本中实现了Base64解码与RC4加密的处理方式，提示数据经过加密与混淆。|告警面向的流量方向为外部网络到内部用户主机，关注点为攻击者下发的恶意payload，而非用户主动发起的数据，无需特定路径即可触发。"
    ],
    "此攻击链关联的原因": "基于TTP阶段性递进（T1105下载恶意载荷→T1574.002服务DLL劫持→T1059.005远程脚本执行），时间顺序合理，辅助TTP（持久化和混淆）语义支撑攻击链，存在阶段跨越但整体攻击轨迹连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过C2渠道（T1105）下载了与知名恶意家族相关的有效载荷，随后利用服务组件DLL劫持（T1574.002）获得并维持目标系统访问权限，最终下发并远程执行经过混淆与加密的PowerShell/JavaScript恶意脚本（T1059.005），形成典型的窃密、控制和横向渗透的APT攻击流程。"
  },
  "chain_5869": {
    "alerts_info": [
      "第1步攻击：T1189: ScanBox是知名的水坑攻击框架，该告警检测到通过在HTML head标签中动态插入form元素（通常伴随恶意JavaScript），诱导受害者浏览恶意网站，触发恶意内容自动加载，实现无感知感染，属于经典的驱动下载（Drive-by）攻击行为。  从08/23/2024-09:12:08开始到08/23/2024-09:12:08结束，共1条，其关键特征为HTTP协议流量，方向为服务器到客户端（from_server）|载荷中出现document.getElementsByTagName('head').item(0).appendChild(form_tag);疑似恶意JavaScript插入表单|Snort敏感路径检测，使用file_data关键字聚焦于HTTP内容层",
      "第2步攻击：T1059.007: 该告警检测到通过JavaScript Loader下发恶意脚本，目的是在受害主机上执行特定指令，实现代码执行，通常为初步植入后的第二阶段有效载荷投递。恶意JavaScript通常包含混淆、解码、内存流操作等行为。  从08/23/2024-10:47:43开始到08/23/2024-12:51:11结束，共3条，其关键特征为HTTP协议响应码200，服务端返回正常内容，表明利用正常Web通信隐蔽传输恶意载荷|脚本内包含window.resizeTo、GetByteCount、GetBytes、Cryptography.FromBase64Transform等，显示脚本涉及解码、解密、内存流写入等操作|检测到内容流量包含混淆、内存操作与动态解密行为，目标操作系统为Windows家族",
      "第3步攻击：T1505.003: 攻击者利用已上传的WebShell，通过HTTP请求与其进行交互，躲避传统的安全检测，通过正常服务端口伪装恶意操作，实现远程控制。  从08/23/2024-16:09:32开始到08/23/2024-16:09:32结束，共1条，其关键特征为HTTP协议GET方法被大量使用，针对WebShell的访问|URI参数中包含search_word=，紧跟可能为Base64编码内容|使用正则表达式检测URL参数中的Base64格式，表明可能在进行命令、数据的编码传递，与WebShell交互相关",
      "第4步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏C2工具与攻击者C2服务器之间的通信，避免被检测。  从08/23/2024-17:44:23开始到08/24/2024-00:00:53结束，共5条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为HTTPS回连的典型伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险",
      "第5步攻击：T1518.001: 该告警检测到PowerShell脚本通过WMI查询（SELECT * FROM AntiVirusProduct）来识别受害主机上已安装的防病毒产品信息，这通常用于攻击者了解受害环境中所部署的安全防护措施。  从08/24/2024-05:31:12开始到08/24/2024-05:31:12结束，共1条，其关键特征为HTTP协议响应中带有200状态码，表示成功的下载操作|HTTP内容包含SELECT * FROM AntiVirusProduct，表明WMI查询本地防病毒产品信息|出现.Net.WebClient与.Download，指示通过PowerShell远程下载行为",
      "第6步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从08/24/2024-14:52:49开始到08/24/2024-14:52:49结束，共1条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。",
      "第7步攻击：T1016: 此告警检测到主机执行了Windows网络配置信息查询（如ipconfig命令），该行为常用于攻击者收集目标主机的网络信息（如IP、子网掩码、网关等），为后续 lateral movement 或数据渗透做准备。  从08/25/2024-18:07:10开始到08/25/2024-18:07:10结束，共1条，其关键特征为Payload中包含字符串 'Windows IP Configuration\\x0d'|Payload中包含 'Ethernet adapter Local Area Connection:'|同时出现 'Physical Address'、'IP Address'、'Subnet Mask'、'Default Gateway' 等网卡配置信息关键词",
      "第8步攻击：T1102.002: 攻击者通过公共Web服务（如Discord）建立命令与控制通道，实现与被控主机的通信和数据回传，绕过网络边界防护，提升隐蔽性。  从09/16/2024-13:13:41开始到09/17/2024-09:10:17结束，共3条，其关键特征为HTTP方法为POST，URI以/api/webhooks/开头，主机为discordapp.com|请求体中出现特定JSON字段，如\"UAC Bypassed\"、\"Lan IP\"、\"PC Type\"|涉及多版本Windows（XP/Vista/7/8/10/Server），指向数据通过Discord平台回传"
    ],
    "此攻击链关联的原因": "以TTP序列为主线，从水坑攻击驱动下载到恶意脚本加载、WebShell后门控制、C2加密通信，至信息收集、环境检测和通过Discord外联数据，间隔和TTP递进逻辑连贯，行为链完整。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链起始于ScanBox水坑攻击驱动下载恶意脚本，进而实现恶意脚本投递和远程命令执行，通过WebShell建立持久后门及HTTP C2通道，并采用TLS加密通信。攻击者继而利用PowerShell脚本收集主机防护与虚拟化信息，为横向移动和隐蔽持续渗透做准备，最终通过Discord Webhook实现数据外泄，覆盖初始访问、持久化、命令控制与信息收集等多阶段。"
  },
  "chain_4292": {
    "alerts_info": [
      "第1步攻击：T1566.002: 通过疑似钓鱼域名（如 corporateghetto.com.au）诱导用户点击链接，获取用户凭证或植入恶意软件，该技战术常见于电子邮件或其它消息渠道中的钓鱼操作。  从08/23/2024-09:12:10开始到08/23/2024-09:13:08结束，共3条，其关键特征为检测到TLS握手期间的Server Name Indication (SNI)字段中包含可疑钓鱼域名. corporateghetto.com.au|告警适用方向为从$HOME_NET到$EXTERNAL_NET，说明是客户端对外建立加密连接|规则类别为credential-theft，可能与凭证窃取相关联",
      "第2步攻击：T1542.001: 检测到疑似LoJax Bootkit启动活动，此Bootkit通过UEFI/ESP分区实现持久化，确保恶意代码在主机重启后继续运行。  从08/26/2024-14:25:33开始到08/26/2024-14:25:33结束，共1条，其关键特征为HTTP GET方法，URI为/Heart.aspx?ti=，并带有&tn=、&tg=、&tv=等参数|缺少Referer字段，表明为恶意自动化请求而非正常浏览器行为|流量方向为从受害主机l ($HOME_NET) 至外部网络 ($EXTERNAL_NET) 的服务器",
      "第3步攻击：T1564.001: 告警检测到HTTP POST请求体内包含特征码'PK'，表明数据为ZIP压缩格式，说明攻击者可能通过加密（压缩）文件隐藏、绕过安全检测，将敏感信息（如Cards_Google.txt）上传到外部网络，实现防御规避。  从08/29/2024-19:31:45开始到08/29/2024-19:31:45结束，共1条，其关键特征为HTTP POST方法（http.method; content:\"POST\"）|请求体中出现ZIP文件头特征值'PK'（http.request_body; content:\"PK\"）|请求体中传输名为'Cards_Google.txt'的文件（content:\"Cards_Google.txt\"）",
      "第4步攻击：T1055.002: 该告警检测到Win32/Meterpreter shellcode或payload通过会话传输到主机，典型用于Metasploit等工具远程植入并执行驻留型恶意代码，属于进程注入或远程payload投递。  从09/09/2024-08:44:21开始到09/09/2024-08:44:23结束，共4条，其关键特征为流量为已建立TCP会话，方向为from_server，符合远程控制工具下发payload的常见流量特征。|内容特征匹配PE可执行文件头（‘MZ’和‘PE\\x00\\x00’），及特定的Windows DOS模式字符串，表明有效载荷为Windows可执行格式。|fast_pattern与flowbits设置配合累计上下文，减少误报并关联后续检测（如Meterpreter session activity）。",
      "第5步攻击：T1112: 攻击者通过 Meterpreter 攻击框架的 stdapi_registry_create_key 创建或修改 Windows 注册表项，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从10/15/2024-00:56:57开始到10/15/2024-00:56:57结束，共2条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含关键词 'stdapi_registry_create_key'，与Meterpreter的注册表操作模块特征吻合|触发条件为Metasploit Meterpreter shell与被控端交互，指向主动注册表操作"
    ],
    "此攻击链关联的原因": "该链条基于TTP逐步推进，表现出从钓鱼攻击、引导持久化、数据隐藏与规避、远程代码注入，到注册表持久化的攻击顺序。时间连续、TTP行为间逻辑关联，推测为同一攻击流程。中间阶段如利用bootkit与C2联系等行为语义一致，但部分过渡步骤存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者通过钓鱼域名诱导受害者，疑似引导植入Bootkit实现持久化，随后利用压缩文件隐藏敏感数据并上传外发。进一步通过远程投递Meterpreter shellcode植入后门，最终借助注册表操作实现长期控制，攻击链持续时间长、阶段完整，核心行为涵盖渗透、驻留、隐蔽与持久化。"
  },
  "chain_4232": {
    "alerts_info": [
      "第1步攻击：T1204.002: 告警表明Microsoft Office进程（如Word）通过HTTP请求远程PHP资源，极可能是Office文档中的嵌入式远程模板或宏企图访问外部恶意内容。利用恶意文档进行远程模板注入，是攻击者常用来诱导受害者执行恶意代码的一种方式。  从08/23/2024-09:12:23开始到08/23/2024-09:13:14结束，共3条，其关键特征为HTTP GET请求的URL路径特征——多级短随机字符和.php?参数，参数长为10位，指向潜在的远程模板恶意PHP脚本。|User-Agent包含“Microsoft Office”，且对Word 20xx或特定存在性探测特征匹配，指示请求由Office进程发起。|HTTP头部包含 X-IDCRL_ACCEPTED 字段（非标准字段），无Accept和Referer头，表明请求行为异常且定向于恶意用途。",
      "第2步攻击：T1071.001: 检测到恶意软件（Ismdoor变体）通过HTTP协议的应用层与C2服务器进行通信，包含命令下达（比如'systeminfo'命令），属于典型的应用层协议C2（如HTTP）活动。  从02/07/2025-15:26:59开始到02/07/2025-15:41:22结束，共6条，其关键特征为HTTP流量，流向为from_server,established|请求体或内容中包含'|23|command|23 23|systeminfo'|含有特定分隔符'&&'，可能用于多条命令参数分割"
    ],
    "此攻击链关联的原因": "依据TTP行为链，从远程模板注入（T1204.002/TA0001）到HTTP协议C2通信（T1071.001/TA0011），逻辑上呈现典型鱼叉文档诱导后续远控的攻击链。虽然时间跨度较大（POTENTIAL_GAP），但辅助TTP和语义一致性加强了链路的合理性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "本攻击链以Microsoft Office远程模板注入为起点，诱导用户加载恶意内容并执行代码，进而引发Ismdoor类HTTP C2流量，实现主机系统信息收集和攻击者指令执行，展现从初始渗透到远程控制的完整A PT攻击过程。"
  },
  "chain_5667": {
    "alerts_info": [
      "第1步攻击：T1566.002: 该Snort规则检测到攻击者试图通过传递包含恶意Microsoft Equation Editor OLE组件（CVE-2017-11882）的RTF文档发动攻击，用以获得初始访问权。APT组织常用该漏洞在目标环境植入恶意payload。  从08/23/2024-09:12:41开始到08/23/2024-09:12:41结束，共1条，其关键特征为HTTP流量涉及RTF文档下载，流量中含特征流bit: ET.http.rtf.download|数据内包含OLE对象标识内容：objclass Equation.3|特定的ole内容特征和十六进制序列，如02CE020000000000C000000000000046，以及|31 63 30 30 30 30 30 30 30 32 30 30|等字节流",
      "第2步攻击：T1190: 该告警检测的是WinRAR处理特制ACE压缩文件时的CVE-2018-20250漏洞利用。攻击者通过向目标用户系统传送特制的ACE压缩包并诱使用户打开，实现目录穿越，进而远程执行任意代码。此举属于通过利用面向公众的应用程序漏洞获取初始访问权限。  从08/25/2024-13:19:58开始到08/25/2024-13:21:11结束，共4条，其关键特征为HTTP响应码为200，表示成功返回受害文件|文件数据中存在\"**ACE**\"签名，且特定偏移（第7字节）|正则匹配目录遍历或绝对路径结构，利用ACE压缩格式绕过WinRAR目录校验",
      "第3步攻击：T1059.005: 检测到入站WEB流量中出现了倒写的Wscript.Shell（llehS.tpircSW），这通常用于绕过内容检测，暗示目标端点在后续可能会执行恶意的VB脚本代码利用Wscript.Shell发起命令或加载额外恶意内容。  从08/29/2024-16:03:33开始到08/30/2024-19:15:57结束，共6条，其关键特征为HTTP响应状态码为200（请求成功，通常伴随内容分发）|文件体内容包含倒写的llehS.tpircSW（Wscript.Shell）字符串|流量方向为外部网络到内部，HTTP established，to_client",
      "第4步攻击：T1036: 告警内容显示恶意可执行文件被作为JavaScript文件（Content-Type: application/x-javascript）下载，属于伪装和模仿技术，攻击者试图绕过安全检测，将可执行内容包装成脚本类型以规避检测与拦截。  从09/05/2024-11:24:57开始到09/05/2024-11:24:57结束，共1条，其关键特征为HTTP响应状态码为200，表示文件成功下载。|HTTP Content-Type为application/x-javascript，但实际内容以MZ/PE头部开头，指示为Windows可执行文件（EXE/DLL）。|攻击流量方向为from_server，且出现典型PE文件特征（MZ和PE头），表明是二阶段感染可执行文件下发。",
      "第5步攻击：T1036: 检测到SMB协议中mimikatz.exe的传输，攻击者可能使用恶意工具进行凭证导出，并尝试以正常文件名进行伪装，以逃避检测。  从09/07/2024-20:50:22开始到09/07/2024-20:50:22结束，共1条，其关键特征为基于TCP的SMB流量（端口139或445）|流量中包含Unicode编码的文件名“mimikatz.exe”|SMB协议标识（|FF|SMB|a2|），特点为攻击后响应流量",
      "第6步攻击：T1543.003: 检测到通过批处理脚本使用sc create命令创建内核模式驱动服务(.sys驱动)，意在获得或维持系统持久控制权。攻击者经常利用服务安装来自动重启恶意代码或实现高权限运行。  从09/27/2024-04:18:41开始到09/27/2024-04:18:41结束，共1条，其关键特征为HTTP响应状态码为200，表明目标成功返回了数据流|批处理脚本包含'sc create'和'type=kernel'，说明在创建内核驱动服务|.sys 文件后缀出现，进一步明确为驱动文件；后续还有'sc start'，显示驱动被尝试启动",
      "第7步攻击：T1573: 检测到Win32/XWorm恶意软件与其C2服务器之间的通信，利用加密或混淆信道隐藏与命令控制服务器的流量，规避安全检测。  从11/09/2024-22:48:19开始到11/10/2024-01:36:47结束，共6条，其关键特征为检测流量方向为 from $EXTERNAL_NET 到 $HOME_NET，双方端口均为1024以上，表明非标准服务端口通信。|TCP流量内容特征为以16进制31 36 00（十进制'16'字符串+NULL）作为消息前缀，且数据包大小为19字节。|正则表达式匹配通信前部分为0~13字节内ASCII可见字符，然后跟随1个不可打印字符，实现混淆数据开头检测。"
    ],
    "此攻击链关联的原因": "按时间线，T1566.002（钓鱼邮件）和T1190（初始攻击）均为初始访问，随后T1059.005（VBS脚本执行）实现命令执行，T1036反复出现为混淆与伪装，T1543.003为持久化、T1573为C2通信，TTP和语义均顺畅衔接。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链始于恶意文档及WinRAR ACE渗透实现初始访问，随后利用脚本执行、伪装下载及Mimikatz内网横向窃取凭证，以创建内核驱动服务实现持久化，最终通过Win32/XWorm完成与C2的加密通联，构成典型APT完整攻击流程。"
  },
  "chain_19741": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到通过SMTP协议向内部邮件服务器投递被植入AutoOpen宏（自动运行宏）的Office文档，属于通过恶意邮件附件进行初始访问的典型手法。攻击者通常利用邮件携带恶意Office文档，诱使收件人打开，触发恶意宏代码的自动执行，进而实现后续渗透动作。  从08/23/2024-09:12:45开始到08/23/2024-11:28:59结束，共3条，其关键特征为SMTP邮件流量检测，方向为外部至内部邮件服务器|检测Email附件内容中存在Base64编码的'AutoOpen'标志（\"QQB1AHQAbwBPAHAAZQBu\"）|告警针对含有潜在恶意宏的Office文档附件，利用自动运行宏提升社会工程攻击成功率",
      "第2步攻击：T1547.001: 攻击者通过下发或修改含Winlogon相关注册表项的.reg文件，尝试改变系统登录行为或实现持久化，在用户登录时自动启动恶意程序。  从08/29/2024-03:47:12开始到08/29/2024-03:47:12结束，共3条，其关键特征为.reg文件以HTTP传输，文件内容以Unicode格式包含Winlogon注册表路径（含HKEY_LOCAL_MACHINE\\...\\Winlogon）|HTTP响应码为200（从外部下发/服务器响应成功）|注册表内容中明确指定explorer.exe作为启动程序，指纹特征聚焦Winlogon自动登录、Shell启动相关",
      "第3步攻击：T1573: 检测到Dtrack的RAT家族与其C2服务器之间的通信，利用加密或混淆信道隐藏与命令控制服务器的流量，规避安全检测。  从09/13/2024-00:25:10开始到09/13/2024-02:42:03结束，共3条，其关键特征为检测流量方向为 from $EXTERNAL_NET 到 $HOME_NET，双方端口均为1024以上，表明非标准服务端口通信。|TCP流量内容特征为以16进制31 36 00（十进制'16'字符串+NULL）作为消息前缀，且数据包大小为19字节。|正则表达式匹配通信前部分为0~13字节内ASCII可见字符，然后跟随1个不可打印字符，实现混淆数据开头检测。",
      "第4步攻击：T1082: 攻击者或恶意代码通过执行如 systeminfo 等命令收集受害主机的详细系统信息，包括主机名、操作系统版本、厂商、系统配置、处理器及安装信息等，以帮助评估目标环境和后续攻击活动。  从12/05/2024-08:12:17开始到12/05/2024-08:12:17结束，共1条，其关键特征为TCP协议，已建立的向外连接（HOME_NET 到 EXTERNAL_NET，to_server）|数据包内容包含典型的 Windows systeminfo 命令输出字段（Host Name、OS Name、OS Version、OS Manufacturer、Microsoft Corporation、Processor(s)等）|行为表现为客户端主机主动向外发送系统环境及配置信息，可能指向恶意代码或远控木马的活动"
    ],
    "此攻击链关联的原因": "链条按TTP时间演进顺序构建：钓鱼邮件初始访问（T1566.001）到持久化注册表修改（T1547.001），后续检测到C2加密通信（T1573），最终外发主机信息（T1082）；后两步间存在时序跳跃（POTENTIAL_GAP, MISSING_STEP），但整体恶意活动合乎逻辑。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击起始于携带AutoOpen恶意宏的钓鱼邮件（初始访问），随后通过Winlogon注册表项持久化。之后检测到Dtrack加密的C2通信，表征远控进入内网持续控制。末尾发现大量系统信息外泄，疑似远控木马完成环境侦察并准备数据渗出，完整经历了初渗透—持久化—命令控制—信息收集阶段。"
  },
  "chain_5004": {
    "alerts_info": [
      "第1步攻击：T1016: 攻击者通过恶意软件自动收集受害主机的路由表和网络配置信息，这些信息有助于后续渗透、移动和通信。监测到的流量表明目标主机正将自身的路由表信息通过网络发送到外部，属于对系统网络配置的枚举。  从08/23/2024-09:14:35开始到08/23/2024-09:16:18结束，共8条，其关键特征为检测到路由表相关内容如Route Table、Active Routes:、Network Destination等字符串在TCP会话中传输|流量方向为内部主机->外部任意主机，目标为可能的C2或攻击者控制的主机|与Microsoft Windows DOS命令相关的路由表格式清晰，表明为主机网络配置自动收集或回传行为",
      "第2步攻击：T1055.001: 利用MySQL服务器将自定义可执行文件（.exe）写入Windows系统目录（C:\\windows\\system32），以便后续执行，以达到绕过安全控制、潜在获取SYSTEM权限等目的。  从09/05/2024-20:29:45开始到09/07/2024-13:14:05结束，共6条，其关键特征为对MySQL服务（TCP 3306）的写入型SQL命令检测（INTO DUMPFILE 指向 C:\\windows\\system32\\*.exe）|SQL查询中带有SELECT data FROM ..., INTO DUMPFILE，目标为可执行文件（.exe）|利用MYSQL DUMPFILE功能直接在系统关键目录写入新文件，实现恶意持久化或远程利用",
      "第3步攻击：T1543.003: 攻击者可能通过远程访问 Windows Service Control Manager (SVCCTL) 来创建或修改系统服务，以在受害主机上实现长期控制和持久性。此方式通常用于远程代码执行或植入后门。  从12/03/2024-18:47:53开始到12/03/2024-18:47:53结束，共3条，其关键特征为流量为TCP协议，目标端口为135（Microsoft RPC/DCERPC服务端口）|内容匹配DCERPC SVCCTL（服务控制管理）特定UUID及操作内容：13 00 0d 81 bb 7a 36 44 98 f1 35 ad 32 98 f0 38 00 10 03|流向为已建立连接的to_server（外部对内），涉及Windows多版本系统"
    ],
    "此攻击链关联的原因": "三起告警在时间序列上逻辑递进，T1016（发现）到T1055.001（进程注入）再到T1543.003（持久化服务创建），均体现攻击者由侦察到获取更高权限、并实现长期控制主机的TTP链路。部分环节存在步骤缺失，但整体符合重点APT链条；各告警alert_feature显示对同一系统具有攻击连续性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过恶意软件搜集网络配置和路由表信息（发现），随后针对MySQL服务写入恶意可执行文件以实现进程注入（防御规避及初步植入），最终通过远程服务控制管理（SVCCTL）创建或修改系统服务，获得长期驻留权限（持久化控制），整个过程展现了一次典型的由内到外渗透、提权与持久控制攻击流程。"
  },
  "chain_16681": {
    "alerts_info": [
      "第1步攻击：T1566.001: 检测到与已知钓鱼相关域名的TLS SNI，通常用于钓鱼活动以诱骗目标访问恶意或伪造登录页面，是攻陷目标环境并进行凭证收集的常用手段。  从08/23/2024-09:15:10开始到08/23/2024-09:15:10结束，共1条，其关键特征为TLS协议握手阶段出现恶意SNI字段：.overall-continuing.site|通信方向为 $HOME_NET 到 $EXTERNAL_NET，指内向外发起连接|规则基于tls.sni字段识别，SNI以 .overall-continuing.site 结尾且存在点前缀",
      "第2步攻击：T1566.002: 攻击者利用钓鱼页面，通过诱导用户在钓鱼站点输入社交媒体凭证，以获取用户帐户信息。该行为属于通过仿冒合法服务进行的凭证窃取，常见于社交工程攻击。  从08/24/2024-14:25:47开始到08/24/2024-19:12:58结束，共3条，其关键特征为HTTP方法为POST，表示向服务端提交数据，常用于凭证提交。|URL包含.php?nick=，这类参数化请求常见于收集用户信息的钓鱼页面。|流量方向为from $HOME_NET to $EXTERNAL_NET，代表向外传输数据，符合凭证外泄特征。",
      "第3步攻击：T1203: 该告警检测到针对Adobe Flash Player的已知漏洞（CVE-2018-5000）的利用企图，攻击者通过构造特制的恶意Flash内容（通常嵌入到网页或文件中），诱使受害者访问，从而在客户端执行溢出攻击。  从09/02/2024-11:07:30开始到09/02/2024-11:07:30结束，共1条，其关键特征为基于HTTP协议的文件传输，携带特定Flash内容到客户端（flow:established,to_client; file_data）。|检测到Flash运行时常用关键字符串及Flash协议特征，如NetConnection、SharedObject、getRemote、connect、onStatus、rtmp协议头。|使用CVE-2018-5000相关的二进制模式匹配（多个十六进制内容），精确识别漏洞利用Payload结构。",
      "第4步攻击：T1204.002: 此告警检测到通过ActiveX控件利用（ICQPhone.SipxPhoneManager.1-DownloadAgent 方法）下载和执行任意文件，属于诱导用户执行恶意内容的范畴，攻击者利用社会工程或浏览器漏洞自动发起下载和执行操作。  从09/03/2024-08:49:55开始到09/03/2024-08:49:55结束，共3条，其关键特征为HTTP协议，流向客户端，连接已建立|HTTP内容中包含ActiveXObject与ICQPhone.SipxPhoneManager.1组件关键字|涉及DownloadAgent方法（支持下载任意文件执行）",
      "第5步攻击：T1027.002: 攻击者通过将敏感数据（如ccdata.txt）压缩为zip格式（通过魔数'PK'标识）来绕过安全检测实现数据隐藏，提高数据渗出成功率。  从09/12/2024-17:25:20开始到09/12/2024-17:25:20结束，共1条，其关键特征为HTTP协议中的POST方法向外部网络发起请求|请求体包含'PK'魔数标识zip压缩包|压缩包中具体文件名为'ccdata.txt'（疑似信用卡敏感数据）",
      "第6步攻击：T1221: 攻击者通过HTTP流量向客户端下发包含恶意iframe代码（如<iframe ... src=\"index.php\">）的响应，其中iframe指向可用于后续有效载荷投递或执行的页面，此方式绕过检测与内容过滤机制，实现恶意代码在目标环境的插入和执行。  从09/22/2024-00:15:56开始到09/22/2024-00:15:56结束，共1条，其关键特征为HTTP响应状态码为200，指向相关恶意内容|HTTP头部包含自定义host-header特征以及正则匹配的特定主机名样式|响应数据中包含嵌套<iframe src=\"index.php\">，尺寸为1x1，用于隐藏及静默加载后续内容",
      "第7步攻击：T1543.003: Ratsnif通过创建、修改系统服务等持久化机制在受害主机上长期驻留，初始的C2连接为建立持久化访问和后续远控行为的关键环节。  从10/04/2024-07:08:59开始到10/05/2024-23:40:16结束，共3条，其关键特征为服务器到客户端的TCP流量（from_server,established）|TCP数据包固定长度为12字节|特征内容为16进制30 43 38 43 46 37 35 36 42 34 45 37（即ASCII字符串“0C8CF756B4E7”）",
      "第8步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从10/29/2024-13:11:05开始到10/29/2024-13:11:05结束，共1条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第9步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏Cobalt Strike等远控工具与攻击者C2服务器之间的通信，避免被检测。  从11/21/2024-18:55:54开始到12/06/2024-04:05:43结束，共3条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为Cobalt Strike生成HTTPS回连的典型伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险"
    ],
    "此攻击链关联的原因": "以邮件/网页钓鱼（T1566.001/002）为起点，接着利用漏洞执行（T1203）、诱导文件执行与代码投递（T1204.002、T1221），随后数据隐藏与外泄（T1027.002），并建立持久化（T1543.003、T1053.005）。最末通过加密隧道进行命令与控制（T1573.001），各阶段TTP进展连续，时序合理。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "该攻击链从钓鱼诱饵活动开始，引诱用户访问仿冒页面并提交凭证，随后进行漏洞利用和恶意代码执行，通过浏览器技术与iframe进一步加载恶意内容。受害主机被植入RAT并执行计划任务以实现持久化，攻击者通过压缩敏感数据规避检测并外传，最终利用加密C2通道进行远程控制，实现从初始渗透到持久控制和数据窃取的完整攻击流程。"
  },
  "chain_25120": {
    "alerts_info": [
      "第1步攻击：T1566.001: 此规则检测到CVE-2017-0199漏洞攻击，典型用于通过恶意Office文档（嵌入HTA文件）进行钓鱼欺骗，诱导目标打开并激活恶意代码，从而为攻击者获取初始访问权限。  从08/23/2024-09:15:11开始到08/23/2024-09:19:34结束，共4条，其关键特征为HTTP流量流向内网终端（$EXTERNAL_NET -> $HOME_NET）|Content-Type为application/hta（检测HTA文件传递）|内容中包含.expandedEnvironmntStrings与特定Microsoft Office宏相关字节特征，以及'|Menu\\Programs\\Startup\\'等可利用HTA绕过执行的痕迹",
      "第2步攻击：T1190: 检测到攻击者利用面向公众的浏览器漏洞（Firefox/Tor Zero-day）对客户端进行攻击，属于典型的通过客户端漏洞进行初始访问的方式。  从08/27/2024-10:44:19开始到08/27/2024-11:07:55结束，共3条，其关键特征为HTTP流量由服务器发送到客户端，结合具体上下文指向浏览器攻击。|HTTP响应内包含特定二进制内容，如findPopRet、findStackPivot、VirtualAlloc、ropChain、kernel32.dll等与内存漏洞利用和ROP攻击相关的字符串。|流量关联历史已知Firefox/Tor浏览器0day（参考链接）以及攻击目标主要为Windows端 Firefox 浏览器（含 Tor Browser）。",
      "第3步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/01/2024-17:37:01开始到09/01/2024-17:37:01结束，共2条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第4步攻击：T1055: 检测到MSIL/PlugX RAT远控木马通过processManager模块下发KILL命令，可能用于终止安全产品或其他系统进程，实现防御绕过或维持持久控制。  从09/13/2024-02:11:49开始到09/13/2024-02:11:49结束，共1条，其关键特征为TCP流量（established,from_server方向）数据包长度小于300字节|内容包含关键字顺序：|00|, Packet, processManager, List, Kill|关联PlugX RAT家族，出现在未知来源到内网主机的会话中，具系统进程管理能力"
    ],
    "此攻击链关联的原因": "基于TTP顺序和行为语义：首先通过钓鱼（T1566.001）或网页漏洞（T1190）获取初始访问，后续执行Powershell脚本（T1027/T1059.001）完成载荷混淆，最终植入远控木马（T1055），存在时间性和战术演进上的关联，但部分步骤存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击活动从钓鱼邮件和浏览器0day漏洞实现初始渗透，随后利用PowerShell脚本对载荷进行解压和混淆，加强隐蔽性，最终远程投放RAT实现对终端的控制与进程管理，体现出完整的多阶段攻防链，涉及钓鱼、漏洞利用、代码执行与持久化部署。"
  },
  "chain_12851": {
    "alerts_info": [
      "第1步攻击：T1592.002: 该告警检测到攻击者尝试通过利用CVE-2018-20377漏洞，访问Orange LiveBox路由器的 /get_getnetworkconf.cgi 接口，从而未授权获取设备的网络配置信息，属于对网络设备敏感信息的被动收集。  从08/23/2024-09:15:12开始到08/24/2024-13:09:45结束，共5条，其关键特征为HTTP协议GET方法对 /get_getnetworkconf.cgi 路径发起请求|报文无 Referer 头部，常见于自动化、脚本化访问|内容特征定位为针对Orange LiveBox路由器的未授权网络配置获取行为",
      "第2步攻击：T1190: 攻击者利用公开应用的漏洞（此处为Pure-FTPd服务的Shellshock漏洞CVE-2014-6271），以突破防护边界，获取系统权限或植入后门。此行为往往是渗透的第一步。  从09/01/2024-17:42:35开始到09/01/2024-17:42:35结束，共1条，其关键特征为检测FTP协议21端口的入站流量（tcp any any -> $HOME_NET 21）|请求内容包含特定Shellshock探测payload：“( ) { ”（hex：28 29 20 7b 20）|面向Pure-FTPd等受Shellshock漏洞影响服务的攻击尝试",
      "第3步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件（如Duqu 2.0）的持久化机制相关联。  从09/15/2024-02:31:11开始到09/15/2024-02:31:11结束，共2条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，与Duqu 2.0相关|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第4步攻击：T1573.001: 告警检测到DoubleFantasy利用定制SSL通信，通过自签名或伪造证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/27/2024-20:12:24开始到10/06/2024-06:57:02结束，共3条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "该链条以TTP进展为主线，先出现设备信息收集（T1592.002），继而FTP服务漏洞利用（T1190），随后SMB命名管道持久化（T1053.005），最终通过TLS加密C2流量（T1573.001）。端到端TTP语义衔接较强，中间有部分TTP阶段缺失（MISSING_STEP），但整体流程合理。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击活动首先针对互联网路由器进行敏感信息收集，紧接着通过FTP服务的Shellshock漏洞渗透建立初步控制，而后利用SMB命名管道实现恶意持久化，最终部署定制C2隧道组件建立加密C2通信通道，实现远程控制和数据窃取，表现出典型APT攻击链条与阶段过渡。"
  },
  "chain_4140": {
    "alerts_info": [
      "第1步攻击：T1566.002: 该告警检测到钓鱼页面（USPS伪造登录页面），攻击者通过伪造的Web页面诱导受害者输入凭证信息以实现凭证收集。  从08/23/2024-09:15:34开始到08/23/2024-09:15:34结束，共1条，其关键特征为HTTP返回状态200，说明钓鱼页面成功加载并对访问者开放。|页面内容特征包含多次document.writeln调用、动态插入config.js、jquery.js及index.js等外部脚本，常用于动态生成和伪装钓鱼页面。|页面结构采用<!DOCTYPE html>开头，并闭合于</html>，脚本部分带charset=utf-8声明，主体是仿造USPS页面外观以欺骗用户。",
      "第2步攻击：T1555.003: 该告警检测到MSIL/ChromePasswordDump.A恶意软件尝试通过与C2（命令与控制）通信的HTTP POST请求发送窃取的浏览器存储的凭证和敏感数据，属于直接的浏览器凭证窃取行为。  从08/25/2024-13:42:50开始到08/29/2024-08:22:07结束，共3条，其关键特征为HTTP POST请求方式（http.method: POST）|请求体中包含字段：fname=、&encabezado=、&data=、&process=，表明固定格式的数据上报结构|告警分类为凭证窃取（classtype: credential-theft），指向Chrome等浏览器账户信息的盗取",
      "第3步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/07/2024-22:19:05开始到09/09/2024-18:48:11结束，共4条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第4步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从10/12/2024-11:58:16开始到11/22/2024-21:33:40结束，共18条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第5步攻击：T1071.001: 攻击者使用标准应用层Web协议（如HTTP）与C2服务器通信，用于发送命令或收集信息，迷惑防御系统以规避检测。该行为通过特定的HTTP GET请求实现，伪装成正常Web流量。  从01/06/2025-04:21:55开始到01/19/2025-17:56:23结束，共8条，其关键特征为HTTP GET方法，目标URI为/api/ping/|请求体长度为0（Content-Length: 0）|HTTP头部包含Host和Content-Length字段，且特定顺序与格式；该行为典型地用于恶意软件心跳通信"
    ],
    "此攻击链关联的原因": "以TTP序列为主线，时间顺序合理，依次覆盖初始访问、凭证收集、持久化、输入捕获、C2通信阶段。部分链路如T1053.005到T1056.001中存MISSING_STEP但恶意软件植入之后执行键盘记录行为在APT中常见。2843815的T1071.001与上游T1056.001（sec_ttps字段）形成逻辑闭环。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链起于伪造USPS钓鱼页面诱骗用户（初始访问T1566.002），继而通过恶意软件窃取浏览器凭证（T1555.003），攻击者设置系统计划任务（T1053.005）实现持久化，随后用键盘记录器大规模采集用户输入（T1056.001），并通过HTTP C2通道回传数据及实施心跳（T1071.001），展现从外部渗透、持久驻留到持续窃密的完整横向APT流程。"
  },
  "chain_1032": {
    "alerts_info": [
      "第1步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从08/23/2024-09:17:15开始到08/23/2024-09:35:27结束，共3条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第2步攻击：T1059.001: 该告警侦测到通过HTTP传输的PowerShell相关内容，尤其是利用CSharpCodeProvider和CompileAssemblyFromSource动态编译C#代码并通过内存加载（如VirtualAlloc、CreateThread等API调用）直接执行恶意代码，属于利用PowerShell执行动态脚本的行为。  从08/23/2024-13:44:59开始到08/24/2024-15:08:08结束，共5条，其关键特征为HTTP协议，状态码为200的响应（意味着内容被成功传输）|传输内容包含典型的Windows API字符串（如kernel32.dll、IntPtr、VirtualAlloc、CreateThread）|内容含有CSharpCodeProvider和CompileAssemblyFromSource，指示动态C#编译行为",
      "第3步攻击：T1071.004: 攻击者利用DNS协议的TXT记录进行命令与控制，将恶意PowerShell代码通过DNS数据通道下发至受害主机，绕过传统网络安全防御。  从08/25/2024-20:23:10开始到10/05/2024-00:04:11结束，共9条，其关键特征为DNS流量中TXT查询类型（content: \"|00 10|\"）|数据包内容包含PowerShell命令关键字（如powershell、New-Object Net.WebClient).DownloadString()）|协议特征位于DNS的application payload中，通常用于利用DNS隧道绕过内容安全检测"
    ],
    "此攻击链关联的原因": "三条告警在时间顺序上配置合理，TTP由混淆执行（T1027）演进至脚本执行（T1059.001）再到DNS通道C2通信（T1071.004），且多条告警均涉及PowerShell动态执行，具备行为语义连续性。部分告警通过sec_ttps互补增强上下文逻辑。整体反映常见攻击链路。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者先通过Powershell脚本混淆技术（T1027）加载恶意代码，随后利用PowerShell脚本动态编译和内存执行（T1059.001），最终通过DNS TXT通道下发及远程控制（T1071.004）。关键行为包括载荷混淆、内存执行与C2通讯，展现出典型持久化与隐蔽通信手法。"
  },
  "chain_10026": {
    "alerts_info": [
      "第1步攻击：T1055: 检测到包含键盘记录（KEYLOGGER）和注入（injection）脚本的恶意JavaScript代码，伪装为后端脚本返回给客户端，目的是规避安全检测并获取执行权限。  从08/23/2024-09:23:02开始到08/23/2024-09:24:56结束，共4条，其关键特征为HTTP响应体包含特征内容：{\"code\":\"console.log(\\\"it'll be backend script\\\")\"}|JavaScript变量定义序列出现：var botID =，var injection =，var KEYLOGGER =|流量方向为外部到内部（EXTERNAL_NET->HOME_NET），且数据流已建立，定向客户端（to_client）",
      "第2步攻击：T1112: 检测到通过批处理脚本操作注册表，试图更改文件类型关联（如DefaultFileTypes/LowRiskFileTypes），这通常被用于绕过基于文件类型的执行策略、诱导用户执行恶意代码或规避系统安全策略。  从08/23/2024-10:30:12开始到08/23/2024-10:30:12结束，共1条，其关键特征为HTTP流量，返回码为200，表明带有批处理脚本的文件成功下载到目标主机。|文件内容中存在'Reg Add'和'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Associations'，指向修改注册表文件关联策略。|检测到批处理脚本目标键值为DefaultFileTypes/LowRiskFileTypes，对这些键的更改可能改变文件打开时所触发的程序。",
      "第3步攻击：T1573.001: 告警检测到通过使用‘RATVermin’恶意软件利用自签名SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从08/24/2024-15:16:38开始到08/24/2024-15:16:38结束，共1条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第4步攻击：T1071.001: 此告警检测到基于HTTPS的反向C2流量，表明攻击者通过加密Web协议建立与受害者主机的命令与控制通道。检测到恶意HTTPS证书生成模式（如C=US, OU=primary, emailAddress=primary@等）|告警针对从外部网络指向内部的TLS连接（$EXTERNAL_NET -> $HOME_NET）|侦测到与恶意C2行为相关的证书内容或结构"
    ],
    "此攻击链关联的原因": "通过初始恶意脚本下载（T1055, 含按键记录/注入）、批处理注册表修改（T1112, 潜在持久化）、异常证书加密流量（T1573.001, APT远控C2）、Metasploit HTTPS控制（T1071.001）串联TTP进展，均为从渗透到持久化再到C2通路，各阶段间行为语义连续。第二步利用sec_ttps分析支撑链路加强。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "本攻击链表现为攻击者首先通过恶意脚本注入后门（按键记录和注入），随后通过批处理修改注册表设计持久化机制，接着使用定制SSL证书实现加密C2通信，最终利用Metasploit Meterpreter建立反向HTTPS会话，体现出完整的入侵、持久化与C2远控步骤，攻击链条从Web初渗透到深度控制全面具备APT特征。"
  },
  "chain_23356": {
    "alerts_info": [
      "第1步攻击：T1566.002: 告警识别到客户端在TLS建立过程中通过SNI字段访问与已知钓鱼活动（TA4903）相关的恶意域名（.doawc.com）。这通常表示攻击者试图通过钓鱼邮件等手段诱使受害者点击恶意链接，实现初始植入。  从08/24/2024-13:15:51开始到08/24/2024-13:15:51结束，共1条，其关键特征为TLS会话中SNI字段包含“.doawc.com”恶意域名|流量方向从内网客户端发往外部Internet|classtype标记为credential-theft，关联凭证窃取意图",
      "第2步攻击：T1566.001: 检测到针对SFR Mail的钓鱼活动，攻击者通过伪造的电子邮件诱导用户提交凭证数据至/data.php路径，窃取用户名和密码，实现未经授权的凭证访问。  从08/23/2024-09:31:12开始到08/23/2024-10:36:45结束，共5条，其关键特征为HTTP协议POST方法，路径为/data.php，通常用于收集和上传表单数据。|请求体中带有敏感表单字段，如lt=、&execution=、&_eventId=submit&username=、&password=，具备典型的登录凭证钓鱼表单特征。|请求中包含特定Cookie值Authentification%2FSFRMail;，暗示攻击目标为SFR Mail用户。",
      "第3步攻击：T1204.002: 该告警检测到通过HTTP响应体（通常由Exploit Kit注入）加载和执行恶意JavaScript代码，诱导受害者浏览器连接恶意站点并进一步下载/执行恶意脚本。行为依赖于用户访问恶意或受感染网站。  从08/25/2024-08:22:46开始到08/25/2024-08:22:46结束，共1条，其关键特征为HTTP响应体包含恶意JavaScript：如‘var client = new HttpClient();’、‘client.get('https://www.cloudflare.com/cdn-cgi/trace', function(data){...’等代码。|多次使用XMLHttpRequest/HttpClient等对象，结合onreadystatechange、readyState==XMLHttpRequest.DONE等典型AJAX通信流程描述，说明存在动态外链加载。|攻击流量特征为：外部（$EXTERNAL_NET）到内部（$HOME_NET）、HTTP协议、已建立、向客户端方向（to_client），命中恶意网页载荷注入场景。",
      "第4步攻击：T1059.001: 攻击者通过将恶意脚本(如SCT脚本)下载到受害主机，并利用Windows内置的PowerShell实现代码的执行。这通常属于远程代码执行链的一环，是时下常见的'Living off the Land'攻击手段。  从08/26/2024-12:44:33开始到08/26/2024-12:44:33结束，共4条，其关键特征为HTTP响应的Content-Type为'text/scriptlet'，符合恶意脚本格式|流量方向为from_server（外部到内部）并已建立连接，表明是服务端下发内容|利用MSXMLHTTP方式结合PowerShell进行下载，关联恶意行动",
      "第5步攻击：T1027: 检测到Cobalt Strike Beacon恶意软件通过UDP协议发送包含系统进程（如wininit、winlogon）的信息，内容经过特定编码规避常规检测手段，实现命令与控制及恶意通信的防御规避。  从08/27/2024-17:32:09开始到08/27/2024-17:32:09结束，共2条，其关键特征为UDP协议用于主机与外部网络的通信|数据包内容包含特定目录及进程名（Sy\\、wininit\\、winlogon\\）|已知恶意软件（Cobalt Strike Beacon）MD5参考值：bd69714997e839618a7db82484819552",
      "第6步攻击：T1021.002: 告警检测到使用Impacket工具集中的smbexec模块下载，该工具用途为绕过Windows安全策略，实现无凭据远程代码执行和横向移动，可利用SMB或管理员共享进行无代理远程命令执行。  从09/01/2024-02:50:11开始到09/01/2024-02:50:11结束，共1条，其关键特征为HTTP协议下进行的文件下载，内容类型为PE（Portable Executable）格式，文件流以'MZ'和'PE'标识为特征。|文件名或内容中出现'smbexec'字符串，定位特定恶意工具。|编码特征含有宽字节Unicode编码，表现为大量交错的'|00|'字节，表现该EXE文件为Unicode标识。",
      "第7步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的持久化机制相关联。  从10/10/2024-05:10:51开始到10/10/2024-05:10:51结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第8步攻击：T1218.005: 检测到与MSHTA相关的恶意行为，通常用于通过mshta.exe执行远程恶意脚本。MITRE ATT&CK中的T1218.005描述了威胁利用Mshta执行远程托管恶意代码的技术，常见于诱使受害者启动执行含恶意payload的网址或脚本。  从11/04/2024-14:19:37开始到11/04/2024-14:19:37结束，共1条，其关键特征为HTTP GET方法（http.method; content:\"GET\"）|特定请求路径：/ID-508260156241|HTTP头部中无Referer（http.header_names; content:!\"Referer\"）"
    ],
    "此攻击链关联的原因": "链路高度契合ATT&CK TTP阶段，从钓鱼（T1566.002/T1566.001）到用户执行（T1204.002），再到脚本远程执行（T1059.001），后续发现编码混淆流量（T1027）、横向移动及持久化（T1021.002/T1053.005），多阶段攻击完整覆盖；时序连续、行为递进，存在已知威胁工具（如Cobalt Strike Beacon、Impacket工具集）与混淆恶意代码等逻辑支撑。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链以钓鱼邮件诱导用户访问恶意链接开始，窃取并外泄凭证，随后通过网页诱导执行恶意脚本实现初始接入。攻击者利用PowerShell下载并执行脚本，部署带有混淆反侦查机制的恶意软件（如Cobalt Strike Beacon），建立通信后通过横向移动与计划任务实现持久。期间下载特定工具Impacket smbexec并通过Mshta等方式提升隐藏性，展现完整多阶段APT渗透流程。"
  },
  "chain_25467": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到利用Microsoft Equation Editor (CVE-2017-11882) 漏洞的恶意RTF文档下载行为。攻击者常将此漏洞嵌入带有恶意OLE对象的Office文档，通过邮件等方式投递给受害者，实现初步访问。  从08/23/2024-09:32:16开始到08/23/2024-09:45:48结束，共3条，其关键特征为HTTP协议，检测到RTF文档下载流量|文件内容包含特征字符串 'objclass Equations}' 及特定十六进制标识 ('02CE020000000000C000000000000046')，表明嵌入OLE对象|流量方向为外部(攻击者)到内部(受害者)，常见于钓鱼攻击传输阶段",
      "第2步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从08/29/2024-10:27:50开始到08/30/2024-13:37:55结束，共4条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。",
      "第3步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/02/2024-23:21:11开始到09/02/2024-23:21:11结束，共2条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第4步攻击：T1071: 检测到恶意攻击者利用应用层协议（本例为TLS/SSL）建立C2通信，通常用于绕过传统检测并加密通信内容。通过伪造或恶意证书（如告警中出现的alpinetrekkers.pk）与受害主机进行隐蔽连接，实现与恶意基础设施的控制和信息交换。  从09/11/2024-19:45:23开始到11/14/2024-21:17:38结束，共6条，其关键特征为TLS握手过程中发现特定证书主题（Subject：CN=alpinetrekkers.pk）|通信方向：源为$EXTERNAL_NET，目标为$HOME_NET，且通信已建立且为to_client|关联已知恶意软件家族（Maldoc），此家族常见于投递攻击与后续C2",
      "第5步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏Cobalt Strike Beacon等远控工具与攻击者C2服务器之间的通信，避免被检测。  从01/07/2025-02:13:05开始到01/18/2025-13:08:20结束，共2条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为Cobalt Strike生成HTTPS回连的典型伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险"
    ],
    "此攻击链关联的原因": "各告警TTP顺序呈现初始访问-防御规避-持久化-命令与控制；TTP链路符合进攻流程，无明显时间跳跃，部分阶段通过辅助TTP（如T1059.001与T1041）与行为语义增强关联连续性，行为与攻击链逻辑高度一致。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过钓鱼邮件携带恶意RTF文档（CVE-2017-11882）进行初始访问，随后利用PowerShell枚举主机虚拟化状态进行防御规避，通过计划任务实现权限持久，最后多阶段地建立TLS加密C2隧道（含Meterpreter指纹）保证隐蔽通信，实现对受害主机远程控制与持久渗透。"
  },
  "chain_23659": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到通过SMTP协议向内部邮件服务器投递被植入AutoOpen宏（自动运行宏）的Office文档，属于通过恶意邮件附件进行初始访问的典型手法。攻击者通常利用邮件携带恶意Office文档，诱使收件人打开，触发恶意宏代码的自动执行，进而实现后续渗透动作。  从08/23/2024-09:36:14开始到08/23/2024-09:36:14结束，共1条，其关键特征为SMTP邮件流量检测，方向为外部至内部邮件服务器|检测Email附件内容中存在Base64编码的'AutoOpen'标志（\"QQB1AHQAbwBPAHAAZQBu\"）|告警针对含有潜在恶意宏的Office文档附件，利用自动运行宏提升社会工程攻击成功率",
      "第2步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/26/2024-17:52:41开始到08/29/2024-03:07:37结束，共3条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第3步攻击：T1071.004: 攻击者利用DNS协议作为命令与控制信道，将恶意数据封装在DNS请求中进行通信，从而绕过常规网络监控与出站流量检测。  从10/01/2024-11:03:00开始到10/16/2024-19:14:43结束，共3条，其关键特征为DNS查询内容包含20-80位的字母、数字、符号（-、_、.），格式疑似编码后内容|查询的域名以.com结尾，且中间含有[a-z]{2}\\d{2}特征字符串|数据包包含十六进制00 00 13 00 01，代表特定类型DNS查询",
      "第4步攻击：T1048.003: 攻击者利用DNS协议，将被窃取的数据编码后通过DNS请求悄悄传出到他们控制的域名。该技术为多种APT组织采用的数据外渗方式。  从01/17/2025-07:29:50开始到01/17/2025-07:29:50结束，共1条，其关键特征为DNS查询目的域名为g-analytics.com，通常为恶意域名|规则指定dns.query，关注为DNS协议请求|请求疑似为数据编码后通过DNS外传，疑似支付信息等敏感数据渗透"
    ],
    "此攻击链关联的原因": "该链路呈现典型攻击链T1566.001(钓鱼初始访问)→T1053.005(计划任务持久化)→T1071.004(DNS C2)→T1048.003(DNS数据外渗)。各环节TTP顺序合理，且时间序列依次递进。部分行为以sec_ttps及语义作为补充强化链路连续性，整体语义高度一致。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过带有恶意AutoOpen宏的钓鱼邮件实现初始入侵，随后在受害主机高权限创建计划任务以维持持久化，随即启用DNS协议建立隐秘C2通信，阶段性通过DNS请求将敏感数据渗透至外部恶意域名，攻击涵盖入侵、持久性、远控及数据窃取全流程。"
  },
  "chain_24710": {
    "alerts_info": [
      "第1步攻击：T1566.001: 检测到访问与已知钓鱼活动相关的域名（.validate-usda.com）进行TLS通信，攻击者通过伪造高度可信的域名诱导用户访问，进行凭据窃取等初始访问尝试。  从08/23/2024-09:38:44开始到08/23/2024-09:38:46结束，共5条，其关键特征为TLS SNI包含.sni.validate-usda.com，表明指向可疑/恶意钓鱼域名|流量为已建立会话且流向服务器，协议为TLS|告警归类为credential-theft，侧重于凭据窃取风险",
      "第2步攻击：T1140: 检测到通过HTTP POST请求上传可疑MSHTA脚本，常用于绕过检测防护上传并在目标主机执行解码或解封装代码以隐蔽其恶意行为。  从08/23/2024-10:02:30开始到08/23/2024-10:02:30结束，共1条，其关键特征为HTTP POST方法，上传方向：内部客户端到外部服务器|multipart form-data中存在字段名435F2F，与攻击相关特征名称/标识|请求体中出现filename=435F2，标识疑似特定命名的恶意MSHTA文件",
      "第3步攻击：T1027: 该流量告警标识恶意文档（Maldoc）主动向外请求可能被混淆的恶意有效载荷。攻击者通常会对数据或请求进行混淆以规避检测机制，防止被防护系统拦截和分析。  从08/24/2024-18:23:11开始到08/24/2024-18:23:11结束，共1条，其关键特征为HTTP GET方法，向外部服务器发起流量|URL路径中包含 .php?lokko=，显示为特定的恶意通信参数，常见于恶意文档下载阶段|HTTP头部缺失Referer字段，属于异常的HTTP行为特征，表明是自动化或被操控的恶意请求",
      "第4步攻击：T1547.001: 攻击者通过滥用 ChilkatHttp ActiveX 控件存在的漏洞，能够任意覆盖指定文件（如exe、dll、bat等可执行文件及配置文件），从而实现在受害主机上植入恶意代码，获得持久化或规避检测。  从08/27/2024-08:14:58开始到08/27/2024-08:14:58结束，共2条，其关键特征为HTTP流量（to_client, established），表明通过Web途径下发恶意代码|包含 ChilkatHttp ActiveX 控件 CLSID（B973393F-27C7-4781-877D-8626AAEDF119），且请求目标包含.ini、.exe、.dll、.bat、.com、.cab、.txt等敏感扩展名|出现 SaveLastError 字段，关联控件常用调用接口，可能伴随目标文件被覆盖/写入行为",
      "第5步攻击：T1047: 检测到流量中包含WMIC命令提示符，表明攻击者很可能利用WMIC进行远程命令执行或管理目标主机，主要用于横向移动以获取对更多系统的访问权限。  从09/05/2024-05:44:17开始到09/05/2024-08:02:55结束，共3条，其关键特征为TCP协议，已建立会话|通信内容包含字符串 'wmic:root\\cli>'|通信方向为从内部网络到外部网络，提示为攻击响应流量，管理命令可能已被远程执行",
      "第6步攻击：T1555: 检测到基于LaZagne工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从10/03/2024-17:07:31开始到10/03/2024-17:07:31结束，共1条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第7步攻击：T1003.001: 告警检测到SMB流量中传输了由Mimikatz工具相关的mimidrv.sys模块，该模块常用于从LSASS等内存中提取凭证。攻击者通常在获取目标主机的访问权限后，使用Mimikatz提取操作系统存储的明文账户密码、哈希或其他认证信息，从而进行后续横向移动或提权。  从12/20/2024-22:18:54开始到12/20/2024-22:18:54结束，共1条，其关键特征为TCP 139 或 445 端口（SMB协议）|SMB数据包包含特定字节序列：|FF|SMB|a2||SMB流量中出现文件名字符串：mimidrv.sys"
    ],
    "此攻击链关联的原因": "该链条严格按照TTP时序推进，涵盖鱼叉钓鱼初始访问、恶意文件上传与混淆、持久化植入、命令执行横向移动、凭证窃取等完整攻击流程，各阶段间TTP与描述高度衔接，行为语义连贯。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过鱼叉式钓鱼邮件引导访问钓鱼域名，上传恶意MSHTA脚本并混淆通讯，利用ActiveX漏洞实现持久化，继而远程执行WMIC横向移动，随后进行凭证搜集与LaZagne和Mimikatz提权，展现出一条由初始入侵、驻留、横向、收集、提权的完整攻击链。"
  },
  "chain_23293": {
    "alerts_info": [
      "第1步攻击：T1059.001: 该告警检测到通过HTTP响应下发包含“Invoke-Expression”的PowerShell脚本，攻击者通常利用PowerShell在受害主机上远程执行恶意命令或脚本，实现对系统的控制。  从08/23/2024-10:19:27开始到08/23/2024-10:23:17结束，共3条，其关键特征为HTTP协议流量下发PowerShell相关内容|file_data阶段匹配包含字符串“Invoke-Expression ”|面向客户端（to_client）方向，目标为Windows操作系统终端",
      "第2步攻击：T1547.001: 通过FTP尝试访问Windows system32目录，往往是恶意软件试图将自身复制到关键系统目录（如system32），以实现持久化或准备进一步的权限提升。CWD指令说明攻击者试图在该目录下操作，为持久化创造条件。  从08/24/2024-16:41:03开始到08/27/2024-09:58:19结束，共3条，其关键特征为目的端口为21，典型FTP服务端口|FTP命令为CWD，目标目录为C:\\WINDOWS\\system32|通信方向为内部到外部，表明内网主机对外网FTP服务器发起操作",
      "第3步攻击：T1083: 攻击者通过访问受害主机上/listdir.php?dir=接口，尝试列出目录内容以收集存储的文件和目录信息。这属于对文件系统结构的初步侦查行为。  从09/02/2024-20:14:29开始到09/14/2024-02:02:51结束，共4条，其关键特征为GET方法，URI携带/listdir.php?dir=参数——表明意图列举服务器目录列表|HTTP头部特定顺序（Host、Pragma、Accept）及其组合，通常是恶意通信的指纹|流量方向为本地主机到外部网络，表现为到伪装C2服务器的通信企图",
      "第4步攻击：T1573: 攻击者通过加密通信信道（如自定义协议或TLS/SSL等）进行命令与控制（C2）通信，避开安全设备的检测。本条告警捕获了zgRAT木马通过特定自定义加密数据包进行C2心跳或数据回传。  从09/21/2024-16:45:19开始到09/21/2024-16:45:19结束，共1条，其关键特征为TCP流量，源IP为内部主机（$HOME_NET）指向外部（$EXTERNAL_NET），已建立连接且流向服务器方向|数据包定长（48字节），并以特定16字节序列作为特征头部（|a9 00 cc c1 85 68 be b5|）和尾部（|fd 40 70 ec 51 5e 7b 60|）做边界标记，疑似zgRAT自定义通信协议|用途为C2信道心跳/命令检查，疑似加密或编码过（内容参考MD5:d3e984dc6103df9e21861e75a6c10abb），分类为高危、极具针对性且罕见的恶意流量",
      "第5步攻击：T1115: 分析关联到Loozer Stealer类信息窃取木马，其主要行为包括窃取主机端敏感数据如凭证、剪贴板等信息。本条告警流量特征常见于信息窃取活动期间，属于‘收集’阶段。  从10/07/2024-11:27:42开始到10/07/2024-11:27:42结束，共2条，其关键特征为HTTP响应Header中含X-Powered-By: PHP（表明服务端环境）|HTTP正文中存在‘Notice: Undefined variable’ PHP报错提示，暗示恶意或未成熟后端代码|URL或内容中出现‘dados’（葡萄牙语意为‘数据’）和‘.php’关键字，表明服务端为php，且数据相关",
      "第6步攻击：T1041: 该Snort规则检测到恶意移动应用通过HTTP协议与外部C2服务器通信并进行数据上报（Checkin），表明已建立C2通道并存在数据渗出行为。恶意流量通过伪装成正常应用请求的GET方法和特定URI进行数据传输，符合Exfiltration Over Command and Control Channel场景。  从11/04/2024-06:55:19开始到01/14/2025-07:17:58结束，共2条，其关键特征为HTTP GET 方法，URI携带/a/android.asp?version=字符串，疑似用于设备信息上报或会话建立。|HTTP头部存在特定标识，包括Connection: Keep-Alive、Charset: UTF-8、Content-type: application/x-www-form-urlencoded，易于与普通流量混淆。|User-Agent字段包含 ' Android ' 字样，与移动端恶意应用通信特征吻合。",
      "第7步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从02/07/2025-17:29:18开始到02/07/2025-17:29:18结束，共3条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端"
    ],
    "此攻击链关联的原因": "各告警TTP顺序基本符合攻击链条：远程执行PowerShell（T1059.001）→持久化（T1547.001）→文件侦查（T1083）→加密C2信道（T1573）→信息窃取与收集（T1115/T1056.001）→数据渗出（T1041）。部分环节间缺乏直接过渡，链路中存在MISSING_STEP和POTENTIAL_GAP（如部分告警间时间跨度较大，侦查和C2之间无明显过渡行为），但整体技术路径与常见APT攻击链吻合，部分联系通过辅助TTP与行为关联增强逻辑连贯性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击流程从PowerShell远程执行脚本发起，随后通过FTP操作system32目录获得持久化，进行文件系统目录侦查并建立加密C2信道，进一步通过信息窃取型木马收集主机敏感数据，并伴随键盘输入捕获，最终将敏感信息通过C2或伪装普通应用流量等渠道外渗，展现了高级威胁从初始入侵、持久化、侦查、C2、数据收集到渗出的完整链路。"
  },
  "chain_22550": {
    "alerts_info": [
      "第1步攻击：T1218: 告警检测到本地设备通过 HTTP 发起对 installiq.com 官方域名特定接口的访问。这类流量通常与合法或灰色软件更新机制相关，但也可能被威胁行为者用来绕过安全策略、下载可疑或恶意有效载荷，以隐匿自身行为规避部分安全检测。  从08/23/2024-10:23:57开始到08/23/2024-10:28:11结束，共5条，其关键特征为HTTP请求路径包含 /api/detectionrequest.aspx?keyid=1&shortname=|http.host 包含 .installiq.com 域|请求携带 &langid= 参数，表现出软件更新或检测功能相关行为",
      "第2步攻击：T1071.001: 检测到Manuscrypt或RAT的定制版本使用自定义的应用层协议（特定payload特征）向C2服务器进行check-in，实现命令与控制通道，攻击者可通过此通道持续操控已感染主机。  从09/03/2024-02:11:49开始到10/20/2024-09:31:45结束，共13条，其关键特征为TCP会话，流量方向为本地内网主机->外部网络（$HOME_NET to $EXTERNAL_NET）|以特定16字节payload开头：“c5 b5 0d cc 2f 2d 2d d5 2f 2d 2d 2e 2d 2d 2d 65”|payload以7字节模式“2d 2d 2d 2d 2d 2d 2d”结尾，总大小严格为615字节"
    ],
    "此攻击链关联的原因": "告警2018222（系统二进制代理执行）表现为HTTP特殊请求，sec_ttps带有T1071.001（C2），为与2852901主TTP（C2, Manuscrypt）构建链路提供合理辅助，存在整体TTP脉络及通信语义，但中间环节（如初始感染/持久化）缺失，标记为MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "链路展现为本地系统先通过伪装成正常更新功能绕过检测，其后疑似实现恶意C2通信阶段（Manuscrypt通信）。说明主机可能已先被潜伏植入，随后通过定制协议与外部C2持续交互，但缺乏初始入侵/持久化等环节告警，推测为常见防御绕过配合C2操控的分段攻击过程。"
  },
  "chain_20216": {
    "alerts_info": [
      "第1步攻击：T1040: 攻击者试图通过修改ADSL路由器的DNS设置，将网络流量重定向到恶意DNS服务器，从而实现对凭据或敏感数据的窃取。此举允许攻击者在用户不知情的情况下进行中间人攻击。  从08/23/2024-10:34:12开始到08/23/2024-10:51:45结束，共5条，其关键特征为HTTP请求中包含参数dnsPrimary=与dnsSecondary=，指示试图修改主/备DNS服务器。|包含Enable_DNSFollowing=1参数，这是设备配置中典型的DNS跟随功能启用标志。|请求针对D-Link DSL-2640R等ADSL路由器管理接口，主要定位于IoT设备。",
      "第2步攻击：T1027: 该告警指示检测到经过混淆的钓鱼登录页面内容，下发给受害者，意在绕过安全检测及内容分析，从而增强钓鱼攻击的隐蔽性。  从08/24/2024-16:27:05开始到08/24/2024-16:27:05结束，共2条，其关键特征为HTTP协议，响应码200，攻击流量为to_client方向|钓鱼页面内容部分被检测到含有混淆特征，如大量空格、换行和编码字符，标题含'Sign in to your account'|MD5哈希校验（e73af0d91c496b615ace6c3aa04a4c88）帮助识别特定已知钓鱼页面模板",
      "第3步攻击：T1027.002: 该告警匹配到UPX打包工具生成的特征码，属于恶意软件通过打包程序混淆恶意二进制，从而逃避防病毒软件或安全检测的常见方式。  从08/25/2024-02:19:54开始到08/25/2024-02:19:54结束，共1条，其关键特征为检测到UPX打包特征字节流：55 50 58 21 0a 30|流方向为已建立连接且数据流来自服务器（from_server）|针对通过TCP协议任意端口，通常与恶意软件下发或回传阶段有关",
      "第4步攻击：T1055: 此规则检测到针对SQL服务器会话（端口139）利用特定shellcode意图，在目标服务进程内植入恶意代码，从而实现恶意代码的隐藏执行和持久控制。该类操作通常利用缓冲区溢出或类似漏洞，实现对服务器应用的进程注入。  从08/29/2024-18:39:42开始到08/29/2024-18:39:42结束，共1条，其关键特征为目标端口139（通常为NetBIOS会话服务端口，表明特殊的攻击向量或配置）|检测特定的Unicode间隔shellcode特征序列（例如 H|00|%|00|x|00|w|00...）|流量方向为外部网络->SQL服务器，并要求已建立TCP连接（flow:to_server,established）",
      "第5步攻击：T1573: 检测到恶意软件Win32/XWorm V3通过加密信道与C2服务器通信，使用专有加密Payload（指定内容特征），以隐藏C2命令流量，建立并维持指挥和控制，逃避侦测。  从08/31/2024-09:28:10开始到09/07/2024-13:14:28结束，共3条，其关键特征为检测方向为外部主机到内部主机的TCP已建立连接，数据流向终端（to_client）。|数据负载精确匹配19字节特征串（|31 36 00 66 80 ce b2 31 1d 2e e6 0b 21 1d a4 46 85 5a 92|），内容高度特定并与XWorm V3‘GetInformations’指令相关。|用于流量门限控制，每300秒内每源仅告警一次。相关协议为TCP，重点关注与内部终端建立的入站连接。",
      "第6步攻击：T1105: 攻防双方通过HTTP协议将Cobalt Strike Beacon恶意载荷下发给受害主机，实现命令与控制阶段的远程文件（工具、payload）传递。  从09/12/2024-19:44:59开始到09/12/2024-19:44:59结束，共4条，其关键特征为HTTP协议，响应码为200（OK），内容类型为application/octet-stream|内容特征为可执行文件（content:\"MZ\"），并有高位字节混杂（pcre:\"/[\\x80-\\xff]{16}/\"）|流量方向为已建立的http连接，外部到内部（to_client），且与Cobalt Strike Beacon家族相关（flowbits:isset,ET.CobaltStrike.Beacon）",
      "第7步攻击：T1140: 攻击者尝试将敏感数据如密码明文（如 passphrase=）在HTTP请求体中直接发送，可能试图绕过加密协议、弱化安全检测或规避流量监控。  从08/27/2024-23:05:28开始到08/27/2024-23:05:28结束，共2条，其关键特征为HTTP协议，内容体（Body）包含明文属性传递|传递字段包含关键字 passphrase=|行为通常为HTTP POST请求，header和body易于被流量分析",
      "第8步攻击：T1555: 检测到基于Windows Credential Dumping工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从10/23/2024-17:02:23开始到10/23/2024-17:02:23结束，共1条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容"
    ],
    "此攻击链关联的原因": "告警链以TTP演进为主线，涵盖初始渗透（T1040）、诱骗（T1027）、恶意载荷混淆与植入（T1027.002、T1055）、加密C2通信（T1573）、远程payload下发及数据外泄（T1105、T1140、T1555）。通过时序合理衔接，部分步骤存在MISSING_STEP，链中行为和攻击目的高度连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该攻击链展现了攻击者自入侵IoT路由器并劫持DNS流量起步，利用混淆钓鱼与恶意载荷投递，进而对SQL服务器进程注入，使用加密信道与C2维持控制，并远程下发更多恶意组件。后续行为涉及明文敏感数据的窃取和凭证收集外传，反映完整APT活动的各环节与主要特征。"
  },
  "chain_13965": {
    "alerts_info": [
      "第1步攻击：T1566.002: 该告警侦测到了服务器向客户端传输PDF文件，而该PDF文件已知与APT活动相关，可能利用PDF文件进行社会工程学初始访问。攻击者常将恶意PDF文件附件用于针对目标进行鱼叉式钓鱼攻击。  从08/23/2024-10:34:45开始到08/23/2024-10:35:28结束，共6条，其关键特征为HTTP协议传输PDF文件，从外部到内部网络|文件数据内容包含'%PDF-'魔数，位置在前5字节内，表明为PDF格式|含有已知恶意内容特征串（混淆/编码片段），与APT_NGO_wuaclt相关已披露攻击相符",
      "第2步攻击：T1204.002: 检测到通过MalDoc（恶意文档）类型载荷，利用了微软诊断工具（ms-msdt）协议漏洞。一旦用户在客户端打开含有payload的文档（如Office文档），将触发远程代码执行，属于典型的用户驱动恶意内容。  从08/25/2024-15:07:12开始到08/25/2024-15:07:12结束，共2条，其关键特征为检测到内容特征：<title>Exploit</title>，属于恶意文档载荷标志|JavaScript脚本标签 <script> // ... window.location.href = \"ms-msdt:\"...|HTTP协议流量特征，数据流为established、to_client，偏移和深度匹配80字节内存在特定利用内容",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从08/29/2024-04:25:50开始到08/29/2024-04:25:50结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1547.001: 检测到Win32.TrojanProxy类木马下载其配置文件，这通常用于实现或维持该恶意软件的持久化。在目标主机上持续运行代理型木马程序，通常会通过配置文件下发命令和C2信息，保证木马自动启动与反复控制。  从09/05/2024-02:19:37开始到09/05/2024-02:19:37结束，共1条，其关键特征为HTTP协议传输，流量方向为服务器到客户端（from_server）|配置文件内容含有标志性字符串“@$@”，并紧接base64编码结构（详见正则规则）|敏感文件传递常出现在POST响应体或文件型URL路径",
      "第5步攻击：T1518.001: 该告警检测到PowerShell脚本通过WMI查询（SELECT * FROM AntiVirusProduct）来识别受害主机上已安装的防病毒产品信息，这通常用于攻击者了解受害环境中所部署的安全防护措施。  从11/18/2024-14:54:12开始到11/18/2024-14:54:12结束，共2条，其关键特征为HTTP协议响应中带有200状态码，表示成功的下载操作|HTTP内容包含SELECT * FROM AntiVirusProduct，表明WMI查询本地防病毒产品信息|出现.Net.WebClient与.Download，指示通过PowerShell远程下载行为",
      "第6步攻击：T1573.001: 告警检测到Allakore恶意C2通信工具通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从01/23/2025-22:31:59开始到01/23/2025-22:31:59结束，共8条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "链路以T1566.002（鱼叉式钓鱼-APT PDF）初始访问为起点，T1204.002（恶意文档RCE）补充后续初始入侵，依次出现持久化（T1547.001），横跨环境侦察（T1518.001），最终建立加密C2（T1573.001），TTP时序和攻击语义吻合，虽跨期较长，部分步骤存在POTENTIAL_GAP和MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链以恶意PDF鱼叉式钓鱼为入口，配合用户诱导打开恶意文档触发RCE，伴随PowerShell与rundll32实现持久化和木马配置更新，攻击者通过WMI侦察防御措施，最终Allakore达成持久加密C2通信，展现出典型APT渐进渗透、内网隐身与控制全流程。"
  },
  "chain_16126": {
    "alerts_info": [
      "第1步攻击：T1189: 攻击者利用网页中嵌入的恶意ActiveX控件，通过用户访问恶意网站时，自动调用不安全的方法（DeletePage）来执行攻击，从而获得对主机初步访问权限。该攻击方式无需用户交互，仅用户浏览即可触发。  从08/23/2024-11:23:15开始到08/23/2024-11:23:15结束，共1条，其关键特征为HTTP协议流量，流向为 to_client 且已建立连接|classid=083B40D3-CCBA-11D2-AFE0-00C04F7993D6 的ActiveX控件对象存在于<OBJECT>标签中|调用.DeletePage方法，暗示危险操作",
      "第2步攻击：T1176: 此告警检测到对易受攻击的 Microsoft Video ActiveX 控件 (CLSID: CAAFDD83-CEFC-4E3D-BA03-175F17A24F91) 的访问，攻击者可能通过植入恶意网页内容诱导用户加载和利用该控件，借机绕过终端安全控制并执行恶意代码。  从09/02/2024-12:29:12开始到09/02/2024-12:29:12结束，共1条，其关键特征为HTTP 流量指向客户端，URL 或内容包含 ActiveX 控件相关关键词与 CLSID|检测到 OBJET 标签中 classid 字段等于 CAAFDD83-CEFC-4E3D-BA03-175F17A24F91|基于 HTTP 协议，携带特定漏洞组件标识，被动触发端为 Windows 客户端环境",
      "第3步攻击：T1056.003: 告警检测到Pipka JavaScript Skimmer恶意脚本，该脚本通过在目标网页中植入代码，劫持用户在支付（如authorizenet_cc_number字段）等Web表单中的输入信息，实现支付卡数据窃取。该行为属于通过Web表单输入窃取用户敏感信息。  从09/10/2024-17:02:33开始到09/10/2024-17:02:33结束，共8条，其关键特征为HTTP响应状态码为200（正常响应），数据植入在正常页面交互中|响应体包含关键字：'scriptId', ':', '#script', 'gate', 'authorizenet_cc_number'，用于识别Skimmer脚本特征|恶意内容通常定位于由外部主机发往内部主机的HTTP响应（来自服务器的嵌入型JS恶意代码）",
      "第4步攻击：T1027.002: 该告警匹配到Yoda's Protector 打包工具生成的特征码，属于恶意软件通过打包程序混淆恶意二进制，从而逃避防病毒软件或安全检测的常见方式。  从10/17/2024-08:22:50开始到10/17/2024-08:22:50结束，共3条，其关键特征为检测到Yoda's Protector打包特征字节流：E8 03 00 00 00 EB 01 和 BB 55 00 00 00 E8 03 00 00 00 EB 01|流方向为已建立连接且数据流来自服务器（from_server）|针对通过TCP协议任意端口，通常与恶意软件下发或回传阶段有关",
      "第5步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件的持久化机制相关联。  从09/25/2024-01:15:44开始到09/25/2024-01:15:44结束，共5条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第6步攻击：T1573.001: 告警检测到Carbanak远控木马通信，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从12/25/2024-10:49:22开始到12/25/2024-10:49:22结束，共4条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第7步攻击：T1486: 攻击者通过部署Win32/Gpcode.NAI变种勒索软件，对受害主机上的数据进行加密，从而影响数据的可用性，以实现勒索目的。  从02/13/2025-15:16:56开始到02/13/2025-15:16:56结束，共1条，其关键特征为使用HTTP POST方法，向外部发送包含特定参数（dskspc, usdspc, uid）的请求体。|HTTP User-Agent头部值为'Hadrosaurus!'，为该家族变种专用特征。|流方向为内网用户到外部服务器（HOME_NET -> EXTERNAL_NET），为典型的C2流量特征。"
    ],
    "此攻击链关联的原因": "依据TTP时序与语义递进，ActiveX漏洞初始入侵、植入Skimmer、恶意代码混淆进而实现持久化和隐蔽C2通道，最终数据加密勒索。链路时间持续递进，阶段转换合理，部分利用辅助TTP增强联系。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链以多个ActiveX漏洞和钓鱼建立初始访问，通过网页挂马与Skimmer脚本窃取敏感信息，利用高级混淆逃避检测，随后通过计划任务与SMB命名管道持久化，C2通道加密通信实现远程控制，最终部署Win32/Gpcode.NAI实施文件加密勒索，完整经历初始入侵、信息窃取、持久化、C2、破坏等阶段。"
  },
  "chain_5": {
    "alerts_info": [
      "第1步攻击：T1190: 攻击者通过向受害者主机发送携带特定payload的HTTP流量，试图利用CVE-2018-8174（VBScript远程代码执行漏洞）实现初始入侵。此漏洞常被APT组织和恶意软件用于远程代码执行。  从08/23/2024-14:23:12开始到08/23/2024-14:30:54结束，共5条，其关键特征为HTTP协议，流量方向为from_externet_to_internal，已建立流，响应方向。|流量内容包含Base64编码特征字符串（如oU2hlbGxjb2RlQWRkclBhcmFt、NsYXNzX1Rlcm1pbmF0Z）。|file_data检测，表明关注HTTP响应体内容，通常针对感染型payload携带。",
      "第2步攻击：T1203: 攻击者通过向客户端浏览器传递特制内容以触发CVE-2018-8174漏洞，实现代码执行和初始访问。此漏洞被APT活动广泛利用，可实现远程代码执行。  从08/24/2024-21:18:38开始到08/25/2024-06:11:12结束，共4条，其关键特征为HTTP协议传递，目标为内部客户端|Payload中包含Base64字符串（如KFNoZWxsY29kZUFkZHJQYXJhb）|Payload中出现关键字Q2xhc3NfVGVybWluYXRl，常见于利用CVE-2018-8174的代码片段",
      "第3步攻击：T1055: 本告警检测到了对存在漏洞的 Microsoft Windows cmd.exe 的远程访问横幅信息，说明攻击者可能通过利用远程命令执行漏洞获取了高级权限。此类行为常用于权限提升，通过漏洞或者后门以管理员权限执行命令。  从09/06/2024-19:37:00开始到09/06/2024-19:37:00结束，共5条，其关键特征为检测到TCP会话中包含'String: Microsoft Windows '与版权信息，表明响应内容为Windows命令行界面横幅|起始端口号非21-23（排除了FTP和Telnet常见端口），暗示访问为非标准服务暴露|流量方向属于内网主机出站至外部（$HOME_NET -> $EXTERNAL_NET），可能表明内网主机被攻击后进行外部交互"
    ],
    "此攻击链关联的原因": "以TTP为主线，T1190与T1203均围绕CVE-2018-8174初始入侵与利用，T1055为后续主机权限提升，三者时间递进，存在初始入侵-利用漏洞-权限提升的连贯攻击链。第二步与第三步间可能存在中间步骤缺失，标记MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者先通过HTTP流量携带特征payload，利用CVE-2018-8174（T1190/T1203）对内网主机发起初始入侵并实施代码执行，随后内网主机出现cmd.exe横幅，推测已被远程命令控制（T1055），完成了从外部利用漏洞初始访问到主机权限提升的攻击链，具备APT活动特征。"
  },
  "chain_13556": {
    "alerts_info": [
      "第1步攻击：T1588.002: 攻击者注册、购买或劫持域名作为 Command and Control (C2) 或恶意活动的通信节点，本例中为PowerShell_CustomRAT通过域名（kleinm.de）建立TLS连接。  从08/24/2024-10:28:41开始到08/24/2024-10:28:41结束，共1条，其关键特征为TLS协议中，SNI字段包含恶意域名 kleinm.de|PowerShell_CustomRAT 家族已知C2活动|流量方向为内网主机向外部任意主机",
      "第2步攻击：T1573.001: 告警检测到Carbanak恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从11/22/2024-20:17:03开始到11/22/2024-20:17:03结束，共8条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "通过恶意C2域名注册（T1588.002）到基于SSL的C2加密通信（T1573.001），时间上存在间隔但TTP推进和攻击目的（建立恶意通信基础设施）具备连续性。辅助TTP强化行为语义，存在POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者注册并利用恶意域名开展C2指挥，通过定制SSL证书建立加密通信隧道实现与高级恶意软件的远控，展现典型的持久性C2运维与加密规避能力，疑似APT操作。"
  },
  "chain_4032": {
    "alerts_info": [
      "第1步攻击：T1190: 该告警检测到对ManageEngine 公网应用的未认证远程代码执行漏洞（CVE-2022-47966）的利用，属于攻击者通过漏洞获取对目标系统初始访问权限。  从08/23/2024-18:45:12开始到08/23/2024-19:31:54结束，共3条，其关键特征为HTTP POST请求，目标为受保护的Web服务器。|请求体包含SAMLResponse字段且编码为base64，内容中有getRuntime、exec操作。|base64解码后短距离连续出现冒号“:”，以及getRuntime()和exec()的组合，表明尝试远程代码执行。",
      "第2步攻击：T1027: 攻击者将恶意脚本（如JavaScript）采用Base64编码，并利用SMTP协议中的附件文件名字段进行传递，以绕过安全设备及邮件网关的内容检测，这属于利用编码或混淆规避防御措施的典型方式。  从08/24/2024-07:16:43开始到08/27/2024-21:57:10结束，共5条，其关键特征为SMTP邮件流，针对服务器且流向为established|邮件附件的filename字段使用Base64编码，并出现疑似eval/escape恶意JS代码（AGV2YWwodW5lc2NhcGUo的Base64为eval(unescape())）|正则/SNORT PCRE对filename字段内存在'=?utf-8?B?...AGV2YWwodW5lc2NhcGUo...=?='形态的邮件头信息做匹配",
      "第3步攻击：T1547.001: 攻击者通过下发或修改含Winlogon相关注册表项的.reg文件，尝试改变系统登录行为或实现持久化，在用户登录时自动启动恶意程序。  从09/01/2024-02:05:55开始到09/01/2024-02:05:55结束，共1条，其关键特征为.reg文件以HTTP传输，文件内容以Unicode格式包含Winlogon注册表路径（含HKEY_LOCAL_MACHINE\\...\\Winlogon）|HTTP响应码为200（从外部下发/服务器响应成功）|注册表内容中明确指定explorer.exe作为启动程序，指纹特征聚焦Winlogon自动登录、Shell启动相关",
      "第4步攻击：T1082: 攻击者可能通过批处理脚本（如batch脚本使用 'ver | findstr' 命令）发现操作系统版本信息。此类技术典型地用于攻击者获取目标主机及其操作系统情况，后续规划针对性的攻击或横向移动。  从10/11/2024-17:34:12开始到10/19/2024-15:23:33结束，共10条，其关键特征为HTTP协议传输，发生在已建立流中（flow:established,from_server）|返回HTTP 200状态码（http.stat_code，content:\"200\"）|批处理命令 'ver | findstr /I \"' 特征字节序列在返回数据中，结合正则匹配（pcre：/^\\d\\.\\d\\x22/R），指向系统版本被查询|数据流来源为服务器到客户端，表明入站批处理脚本内容可能暴露主机信息",
      "第5步攻击：T1071.001: 检测到了疑似恶意软件（Win32/NukeSped家族）使用HTTP协议（GET方法）与C2（Command and Control，命令与控制）服务器进行通信，属于利用Web协议进行C2流量的行为。  从12/03/2024-14:48:41开始到01/19/2025-11:34:00结束，共35条，其关键特征为HTTP GET请求，URI包含'.php?sdz='参数，暗示特定服务端C2接口。|User-Agent头部为'Windows NT 5.0|'，这是旧版操作系统指示符，可能被用以伪造低可信主机特征。|HTTP头部不包含'Referer'、'Connection'、'Accept-'前缀相关字段，通常为恶意通信精简HTTP报文的体现。"
    ],
    "此攻击链关联的原因": "基于TTP顺序（外部初始访问T1190→防御绕过T1027→持久化T1547.001→发现T1082→C2通信T1071.001），时间连续，无明显长时间断点，中间缺少部分阶段但符合APT攻击链模式；部分关联依赖TTP语义和行为一致性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过公开漏洞（T1190）获得初始访问，随后通过混淆邮件投递绕过检测（T1027），再下发Winlogon持久化脚本（T1547.001），期间查询系统信息（T1082），最终建立HTTP C2通信（T1071.001），体现了一次典型的多阶段渗透与持久控制流程。"
  },
  "chain_5502": {
    "alerts_info": [
      "第1步攻击：T1055: 本告警检测到了对存在漏洞的 Microsoft Windows cmd.exe 的远程访问横幅信息，说明攻击者可能通过利用远程命令执行漏洞获取了高级权限。此类行为常用于权限提升，通过漏洞或者后门以管理员权限执行命令。 从08/24/2024-03:12:10开始到08/29/2024-10:56:22结束，共8条，其关键特征为检测到TCP会话中包含'String: Microsoft Windows '与版权信息，表明响应内容为Windows命令行界面横幅|起始端口号非21-23（排除了FTP和Telnet常见端口），暗示访问为非标准服务暴露|流量方向属于内网主机出站至外部（$HOME_NET -> $EXTERNAL_NET），可能表明内网主机被攻击后进行外部交互",
      "第2步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。 从09/12/2024-15:23:37开始到09/12/2024-15:23:37结束，共1条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第3步攻击：T1573.001: 告警检测到Carbanak远控恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。 从01/30/2025-12:11:19开始到02/03/2025-02:57:04结束，共10条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "凭借TTP链条中典型的权限提升（T1055）、凭证收集（T1555）到加密C2通信（T1573.001）顺序，以及流量方向和时序逐步推进成立。第二步与第三步间存在MISSING_STEP（无明确持久化/防御规避），但整体攻击行为具备APT链特征。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者通过利用远程命令执行对cmd.exe实现权限提升，随后用提取工具自动收集用户凭证信息。之后，通过自签恶意证书加密的C2通道向外部服务器安全传输数据，实现指令下发与控制，攻击过程具备数据窃取和远控特征，展现出明显的APT组织攻击链条。"
  },
  "chain_15234": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到利用Microsoft Equation Editor (CVE-2017-11882) 漏洞的恶意RTF文档下载行为。攻击者常将此漏洞嵌入带有恶意OLE对象的Office文档，通过邮件等方式投递给受害者，实现初步访问。  从08/24/2024-08:14:10开始到08/24/2024-08:14:11结束，共4条，其关键特征为HTTP协议，检测到RTF文档下载流量|文件内容包含特征字符串 'objclass Equations}' 及特定十六进制标识 ('02CE020000000000C000000000000046')，表明嵌入OLE对象|流量方向为外部(攻击者)到内部(受害者)，常见于钓鱼攻击传输阶段",
      "第2步攻击：T1027.003: 攻击者通过将配置信息隐藏（嵌入）到图片文件中来混淆恶意内容，实现数据隐藏并规避检测。这种利用图片文件传递配置数据的方式，是一种经典的隐写术（Steganography）手段。  从09/07/2024-10:05:09开始到09/07/2024-10:05:09结束，共3条，其关键特征为当前流量为 HTTP，方向为服务器到内部主机，且已建立连接（flow:from_server,established）|图片文件内存在特定的二进制与文本签名（内容 '0103F|00|'，后随'|ff fe|'，正则匹配完整特征）|利用文件内容长度、无零字节等细粒度检测表明为带有嵌入数据的图片结构",
      "第3步攻击：T1071.001: 该告警检测到受感染主机通过HTTP POST方式向外部上传可执行文件（.exe），表明恶意软件可能正在与外部C2基础设施进行通信，或将数据回传到攻击者服务器。此行为通常用于远程指令执行、数据渗出或下载其他恶意负载。  从09/23/2024-22:20:47开始到09/23/2024-22:20:47结束，共4条，其关键特征为HTTP POST请求，且表单内容包含.exe文件（filename=\"rifaien2-xxx.exe\"）|上传内容以'MZ'标志头开头，表明传输内容为PE可执行文件|HTTP头部中不存在Referer和User-Agent，规避常规流量识别"
    ],
    "此攻击链关联的原因": "告警通过TTP链路自初始访问（钓鱼/漏洞利用）到隐写配置下发再到HTTP C2和数据传出，时间顺序逻辑合理，存在APT活动常用攻击阶段跳跃，第二步数据隐写与恶意软件远控配置语义吻合，链路合理但中间有MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击首先通过伪装的恶意RTF文档进行钓鱼和漏洞利用获取初步访问，随后利用图片隐写技术传递恶意配置以规避检测，继而感染主机通过HTTP协议进行C2通信和可执行文件上传，表明控制与外联的数据渗透行为。该链条反映出隐蔽渗透、远程控制及数据外泄的完整APT攻击流程。"
  },
  "chain_10257": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击者利用已感染主机向外部批量发送带有恶意附件（如ZIP文件伪装的DOC文档）的钓鱼邮件，意图扩散恶意软件，增加感染范围。  从08/24/2024-08:15:43开始到08/24/2024-08:15:43结束，共3条，其关键特征为包含常见伪造业务场景的邮件Subject字段，如'Invoice#/Order#/Payment#'等。|邮件头部包含Content-Transfer-Encoding: base64，附件编码可规避部分检测。|邮件包含名为10位数字-三字母.zip格式的附件，内部文件名伪装成DOC文档，增强诱骗性。",
      "第2步攻击：T1204.002: 该规则检测到来自内部网络的HTTP请求，请求名为.hex.zip的文件，并带有Java User-Agent字符串，表明可能正在利用恶意JAR文件触发用户驱动的恶意代码执行。攻击者可能通过诱骗用户下载并运行Java文件实现初始感染。  从08/24/2024-11:35:02开始到08/24/2024-11:35:02结束，共1条，其关键特征为HTTP请求URI结尾为十六进制数字命名的.zip文件（如/abcdef1234.zip）|HTTP User-Agent包含Java/1.，说明下载客户端为Java应用|规则归类为exploit-kit（漏洞利用工具包），存在已知攻击工具包字符",
      "第3步攻击：T1140: 恶意软件通常将屏幕截图转换或编码为JPG格式进行传输，同时通过‘application/octet-stream’作为内容类型进行发送，以规避检测与分类。该告警检测到已编码的JPG格式内容（如|ff d8 ff e0|代表JPG文件头），并采用较为隐蔽的User-Agent格式，提高隐蔽性。  从08/26/2024-23:46:12开始到08/26/2024-23:46:12结束，共2条，其关键特征为HTTP POST请求至.php路径，且带有特定查询参数|请求头User-Agent 格式为'User-Agent: \\r\\n'，内容结构异常|请求体为multipart/form-data，数据主体以JPG文件签名（|ff d8 ff e0|）开头，Content-Type为application/octet-stream",
      "第4步攻击：T1098: Skeleton Key 恶意软件通过向目标系统植入认证绕过模块，实现对域控制器的持久权限控制，能够绕过身份认证机制，持久化操控目标环境。  从09/03/2024-18:20:34开始到09/03/2024-18:20:34结束，共1条，其关键特征为检测到TCP流量目的端口为139或445（SMB典型端口）|SMB流量中包含'\\ole.dll'（Unicode编码）特征，表明恶意DLL的传输|报文中包含'|FF|SMB|a2|'标志及特定SMB包格式和属性",
      "第5步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/11/2024-04:01:15开始到09/11/2024-04:01:15结束，共4条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第6步攻击：T1055.001: 通过Cobalt Strike Beacon进行进程注入（如rundll32.exe），提升权限并实现恶意代码的持久化驻留。  从10/06/2024-12:18:56开始到10/06/2024-12:18:56结束，共2条，其关键特征为检测到目标主机上启动rundll32.exe进程，其命令行为恶意DLL加载|利用常用于进程注入的Cobalt Strike Beacon shellcode|可疑进程树展现为父进程为被攻陷高权限进程，被注入的子进程异常行为活跃",
      "第7步攻击：T1564.004: 该告警检测到攻击者利用CVE-2024-38217（MoTW - Mark of the Web 绕过漏洞），通过发送特制的Windows可执行文件（通常为.exe），绕过Windows的安全机制，使得文件在被执行时不再受到操作系统的附加安全检查，从而提升恶意代码的执行概率，实现对防御机制的规避。  从11/20/2024-22:33:10开始到11/20/2024-22:33:10结束，共1条，其关键特征为HTTP协议，方向为服务器到客户端（to_client），响应体含特定字节序列 |4c 00 00 00 01 14 02 00 00 00 00 00|（与结构化Windows可执行体格式相关）|检测内容为文件扩展名.exe，支持大小写变体和Unicode混淆（正则：\\.exe(\\.|\\x20)|\\.\\x00e\\x00x\\x00e\\x00(\\.|\\x20)）|利用高危漏洞CVE-2024-38217（Mark-of-the-Web Bypass），目的是绕过Windows文件安全检测"
    ],
    "此攻击链关联的原因": "依时间顺序及TTP逻辑推进，涵盖钓鱼投递、用户执行、恶意载荷解码、持久化权限建立、计划任务创建、进程注入与新型防御规避，全程行为语义连贯，阶段衔接符合典型APT链路。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链以恶意钓鱼邮件投递诱骗用户下载含Java恶意Jar的ZIP文件为起点，用户执行后触发恶意代码解码与数据渗出。随后，攻击者部署Skeleton Key，实现对域控的认证绕过并建立计划任务持久存活，再通过Cobalt Strike Beacon进行进程注入（如rundll32注入），提升权限并实现持久化驻留，最后利用MOTW绕过技术在系统关键目录持久植入并逃避检测，整个过程展示高隐蔽性、高阶段性并持续推进威胁达成。"
  },
  "chain_17057": {
    "alerts_info": [
      "第1步攻击：T1204.002: 告警检测到通过HTTP下发携带恶意LNK快捷方式文件(可能诱使用户点击触发后续攻击链)，属于钓鱼或恶意附件投递常用的用户执行路径。  从08/24/2024-08:34:12开始到08/24/2024-08:36:19结束，共3条，其关键特征为HTTP协议会话，方向为外部到内部|载荷中出现字符串\"ExpandEnvironmentStrings(\\\"%Temp%\\MaGiaiNenNe.txt\\\")\"，提示LNK利用环境变量定向恶意文件|已知恶意LNK相关MD5: 57f02fe8fa9d096e5ac9b6c9be66f05b",
      "第2步攻击：T1140: 检测到HTTP请求URL中存在Base64编码且疑似恶意（字符串“aGFja2Vk”解码后为“hacked”），攻击者常使用Base64编码隐藏命令、有效载荷、或将恶意内容隐藏于通信之中，从而规避检测。  从08/25/2024-16:17:48开始到08/25/2024-16:17:48结束，共1条，其关键特征为HTTP请求的URL中出现Base64编码的字符串（例如“aGFja2Vk”）|HTTP请求未包含Referer头，常见于自动化工具、恶意流量或无Referer的攻击代码|通信方向为$HOME_NET发起至$EXTERNAL_NET，表示内部主机主动访问外部，可能为回连或数据外泄行为",
      "第3步攻击：T1219: 检测到Quasar RAT服务器的'Join Acknowledgement'数据包，表明受害主机已成功与C2服务器建立连接，能够远程接收命令和控制。  从08/27/2024-11:06:32开始到08/27/2024-11:06:32结束，共1条，其关键特征为告警内容匹配Quasar RAT通信协议特征字符串|TCP流量从内网发往外部高端口（端口号>=1024），符合RAT流量习惯|流量方向为to_server，表明控制信道正向建立，说明内网主机已作为RAT客户端对外通讯"
    ],
    "此攻击链关联的原因": "本链路基于时间顺序与TTP行为演进推断：HTTP下发恶意LNK诱导用户执行（T1204.002，TA0002）—>内网主机出现恶意base64编码HTTP流量行为，疑似数据隐写传递（T1140，TA0005）—>检测到Quasar RAT C2连接（T1219，TA0011）。交付、隐秘通信到远控逐步推进，特征及行为均吻合攻击链发展逻辑。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过HTTP投递LNK恶意附件诱导用户执行，随后内网主机对外主动发起含base64编码特征的恶意HTTP通信，实现命令/数据隐写或初步通信控制，最终形成通过其RAT工具（如Quasar RAT）的完整远控C2通道，攻击链覆盖投递—隐蔽通信—远控阶段。"
  },
  "chain_12923": {
    "alerts_info": [
      "第1步攻击：T1082: 攻击者尝试收集受害主机的系统级信息，如操作系统版本、主机名、硬件资源信息等，以了解被攻击环境的详细情况。这通常用于后续攻击阶段做环境适配并提升有效性。  从08/24/2024-09:12:45开始到08/24/2024-09:15:17结束，共5条，其关键特征为HTTP GET请求，伪造User-Agent字段，包含特征字符串如User: 、AV: 、STM: 、RSM: 、RZ:，用于传递主机系统等相关参数。|面向外部网络（$EXTERNAL_NET），适用所有Windows系统版本，流量方向明确指向服务器端。|Snort规则聚焦于流量建立后的数据，使用fast_pattern对特定User-Agent格式进行高速匹配识别RedEnergy恶意通信。",
      "第2步攻击：T1036.005: 该告警检测到攻击者通过HTTP GET请求获取伪装为PNG图片文件的恶意有效载荷，并使用常见浏览器 User-Agent 字符串以规避检测。这种将恶意载荷隐藏在看似正常的文件格式中的行为属于防御规避技战术。  从08/27/2024-17:43:28开始到08/27/2024-17:43:28结束，共1条，其关键特征为HTTP GET 请求针对以 .png 结尾的 URI（但用于传输恶意载荷）|User-Agent 字段伪装为常见浏览器字符串 ('Mozilla/5.0 (Windows NT 6.1; WOW64) ...')|HTTP 请求头特征异常，如缺少 Accept 和 Referer 字段（增强对抗流量分析）",
      "第3步攻击：T1095: Cobalt Strike使用定制或混淆的C2（命令与控制）通信路径，利用HTTP流量和定制Profile来保持与攻击者基础设施的数据通道。规则中对特定URI、Cookie及定制Header的检测表明，恶意通信通过HTTP协议的特定流量格式与外部C2服务器进行交互。  从09/03/2024-01:04:47开始到09/19/2024-14:39:32结束，共6条，其关键特征为HTTP URI中包含特定路径和参数模式，如/live?track=，且紧随&src=、&dst=及&stream=_uX等参数|HTTP请求包含以SID=开头的Cookie字段，常作为会话或追踪标识|HTTP头部未包含Referer，并严格包含Accept、Cookie、Host的顺序，表现明显Cobalt Strike或APT自定义C2 Profile流量格式",
      "第4步攻击：T1070.004: Owlproxy后门服务器响应中包含 'Uninstall backdoor' 指令，指示恶意软件在客户端卸载自身。这一行为旨在通过删除后门程序及相关痕迹，降低被检测和取证概率，属于防御规避手段。  从10/21/2024-05:28:09开始到10/21/2024-05:28:09结束，共2条，其关键特征为HTTP协议服务器到客户端（to_client）方向的数据流|响应体内容包含 'Uninstall backdoor' JSON格式字段：|3a 20 22|Uninstall|20|backdoor|22|"
    ],
    "此攻击链关联的原因": "链条涵盖了信息收集、防御规避、C2及日志清理，均为典型攻击链顺序。TTP序列合乎逻辑，存在较长时间跨度，部分步骤间缺失明确连接，结合语义及ttps主辅理由承接。部分阶段以辅助TTP巩固链路。存在POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过特定User-Agent标记收集主机信息，随后伪装恶意载荷混淆检测，建立以Cobalt Strike为特征的C2通道。最终，利用'Uninstall backdoor'指令卸载后门，清除入侵痕迹以规避取证。攻击过程涉及侦察、防御规避、持久化及C2行为，阶段转变合理且符合APT攻击特征。"
  },
  "chain_23077": {
    "alerts_info": [
      "第1步攻击：T1059.005: 检测到疑似通过HTTP传输到终端的恶意Visual Basic脚本（.vbs），其内容包含Run函数的调用，表明攻击者意图在主机上远程执行脚本代码。  从08/24/2024-09:13:07开始到08/24/2024-09:14:02结束，共3条，其关键特征为HTTP协议中通过http.stat_code 200响应码传输有效内容|file.data中检测到包含字符串“+ 18 Step 8”与“Run(uaujrujcsmq),0,true”|MD5校验值（b64764e81e8c00647f8f1261dd468e3c）明确指向相关已知恶意文件",
      "第2步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/28/2024-14:36:23开始到08/28/2024-15:27:48结束，共9条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第3步攻击：T1555.003: 该告警检测到POWRUNER恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从09/10/2024-22:03:05开始到11/14/2024-02:49:38结束，共4条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。"
    ],
    "此攻击链关联的原因": "该链条基于TTP顺序（脚本远程执行→建立计划任务实现持久化→窃取敏感凭证）和时间连续性，结合告警中特征吻合的恶意脚本行为、C2通信、敏感凭证窃取等语义分析组成完整攻击路径。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP将带有Run函数的恶意VBS脚本植入终端远程执行，随后利用schtasks以SYSTEM权限创建计划任务以维持持久控制，最终通过POWRUNER工具批量窃取浏览器存储的账号密码等敏感凭证，表现出完整的初始渗透、持久化、凭证窃取攻击链路。"
  },
  "chain_23824": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到利用Microsoft Equation Editor (CVE-2017-11882) 漏洞的恶意RTF文档下载行为。攻击者常将此漏洞嵌入带有恶意OLE对象的Office文档，通过邮件等方式投递给受害者，实现初步访问。  从08/24/2024-09:14:32开始到08/24/2024-09:14:32结束，共1条，其关键特征为HTTP协议，检测到RTF文档下载流量|文件内容包含特征字符串 'objclass Equations}' 及特定十六进制标识 ('02CE020000000000C000000000000046')，表明嵌入OLE对象|流量方向为外部(攻击者)到内部(受害者)，常见于钓鱼攻击传输阶段",
      "第2步攻击：T1059.005: 攻击者通过利用WScript.Shell对象和Run方法，在目标主机上执行Visual Basic脚本代码。这通常用于通过脚本远程执行恶意命令或加载其他威胁载荷。  从09/17/2024-22:06:45开始到09/23/2024-00:44:15结束，共6条，其关键特征为包含WScript.Shell关键字，表明攻击目标为Windows脚本宿主对象|出现.Run方法调用，是恶意脚本常用于执行系统命令的特征|利用CreateObject函数实例化WScript.Shell对象，通常与远程命令注入、渗透脚本执行相关",
      "第3步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从10/02/2024-17:19:33开始到10/02/2024-17:19:33结束，共1条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第4步攻击：T1027: 告警检测到恶意VBA宏通过Web请求（webReqUpload）将收集到的信息或文件通过HTTP上传到远程服务器，常见于恶意软件利用宏脚本在感染宿主后尝试数据收集并通过网络偷偷传输该数据。  从08/28/2024-14:50:07开始到09/03/2024-15:32:21结束，共3条，其关键特征为HTTP响应体包含恶意VBA代码片段（例如Function GetInfo、webReqUpload、InitWebR等）|字符串匹配脚本变量定义与Web请求上传相关内容（如$Script:webReqUpload, $Script:upURL等）|规则针对已建立并指向客户端的HTTP流量（flow:established,to_client; http.response_body;）"
    ],
    "此攻击链关联的原因": "各告警TTP顺序合理，涵盖钓鱼入口（T1566.001），通过脚本实现代码执行（T1059.005），进而用计划任务维持持久化（T1053.005），最终实施C2通信/数据外传（T1027），时间上顺序推进，但计划任务与数据外传存在阶段性跳跃（MISSING_STEP）。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链以投递恶意RTF文档钓鱼（T1566.001）为起点，受害主机触发恶意脚本（T1059.005）实现远程命令执行，随后攻击方通过schtasks创建高权限计划任务实现持久化（T1053.005），最终恶意宏脚本利用HTTP外传数据与攻击者通信（T1027），表现出典型渗透、落地、持久化与外联全流程。"
  },
  "chain_19977": {
    "alerts_info": [
      "第1步攻击：T1036.003: 攻击者投递名为explorer.exe的恶意文件，意图伪装成合法系统程序以绕过检测和提升持久性。  从08/24/2024-09:14:45开始到08/24/2024-09:16:10结束，共4条，其关键特征为HTTP协议传输，响应中包含Content-Disposition: attachment; filename=\"explorer.exe\"头部|下载行为发生在流量由外部网络流向内网且为已建立连接时|filename=explorer.exe出现于HTTP头部，敏感可执行文件指示恶意软件投递",
      "第2步攻击：T1218.005: 检测到与MSHTA相关的恶意行为，通常用于通过mshta.exe执行远程恶意脚本。MITRE ATT&CK中的T1218.005描述了威胁利用Mshta执行远程托管恶意代码的技术，常见于诱使受害者启动执行含恶意payload的网址或脚本。  从08/25/2024-13:27:20开始到08/25/2024-13:27:20结束，共1条，其关键特征为HTTP GET方法（http.method; content:\"GET\"）|特定请求路径：/ID-508260156241|HTTP头部中无Referer（http.header_names; content:!\"Referer\"）",
      "第3步攻击：T1055: 检测到远控木马如Dtrack的进程注入行为，通过processManager模块下发KILL命令，可能用于终止安全产品或其他系统进程，实现防御绕过或维持持久控制。  从08/29/2024-07:55:41开始到08/29/2024-07:55:41结束，共1条，其关键特征为TCP流量（established,from_server方向）数据包长度小于300字节|内容包含关键字顺序：|00|, Packet, processManager, List, Kill|关联到Dtrack，出现在未知来源到内网主机的会话中，具系统进程管理能力",
      "第4步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/07/2024-15:02:19开始到09/27/2024-22:13:11结束，共16条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递"
    ],
    "此攻击链关联的原因": "各警报的TTP序列（文件伪装投递→远程代码执行→进程操作→计划任务创建）与时间顺序符合攻击链，部分阶段间跳跃但均为合理攻击步骤，结合辅助TTP如自定义恶意软件制备、C2通信、系统信息收集，整体链路行为语义连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过伪装为系统程序（explorer.exe）向内网投递恶意文件，并利用MSHTA远程执行恶意脚本，随后通过植入的RAT执行进程管理命令（如Kill以规避防御），最终通过schtasks创建高权限计划任务以实现持久化。该链条覆盖投递、执行、持久化、权限维持等关键阶段，攻击过程隐蔽且具备持续控制能力。"
  },
  "chain_9001": {
    "alerts_info": [
      "第1步攻击：T1082: 该规则检测到通过PowerShell脚本对PROCESSOR_ARCHITECTURE环境变量的访问，该行为通常用于远程攻击者识别受害主机的处理器架构信息，从而确定后续载荷投放或利用路径。此类系统信息发现行为属于攻击者在受害主机上进行环境摸底的典型动作。  从08/24/2024-09:15:11开始到08/24/2024-09:16:23结束，共3条，其关键特征为HTTP响应体中包含“\\Environment\\PROCESSOR_ARCHITECTURE”关键字，指示访问了系统环境变量。|正则提取环境变量赋值，格式示例：[a-z0-9]{1,20} = 'x86' 或 'x64'，检出主机CPU架构信息。|为入站HTTP通信，响应状态码为200，排除了请求内容包含“\\Software\\InstallShield\\”的情况，降低了误报概率，并指向定制化PowerShell脚本行为。",
      "第2步攻击：T1018: 攻击者尝试识别网络上的远程系统和主机，使用如nbtstat等命令工具探查目标的信息，以获取有关目标环境的信息。此类行为有助于后续横向移动和资源定位。  从08/24/2024-09:21:55开始到08/29/2024-11:00:30结束，共4条，其关键特征为TCP协议，连接方向为本地网络到外部网络 (OUTBOUND)|NetBIOS相关内容，含有字符串“NetBIOS Remote Machine Name Table”和字段“Name”“Type”“Status”|流特征为已建立会话到服务器 (established, to_server)",
      "第3步攻击：T1083: 该告警检测到PlugX RAT恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从08/29/2024-12:13:02开始到08/29/2024-12:13:02结束，共2条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与PlugX RAT家族相关，且适用于Windows平台的多版本",
      "第4步攻击：T1547.001: 通过FTP尝试访问Windows system32目录，往往是恶意软件试图将自身复制到关键系统目录（如system32），以实现持久化或准备进一步的权限提升。CWD指令说明攻击者试图在该目录下操作，为持久化创造条件。  从09/11/2024-19:17:44开始到09/11/2024-19:17:44结束，共1条，其关键特征为目的端口为21，典型FTP服务端口|FTP命令为CWD，目标目录为C:\\WINDOWS\\system32|通信方向为内部到外部，表明内网主机对外网FTP服务器发起操作",
      "第5步攻击：T1056.001: 该Snort规则检测的是Win32/SnakeKeyLogger恶意软件的有效载荷请求，表明攻击者意图在受害主机上实施键盘记录，从而收集凭证和敏感数据。  从10/17/2024-06:38:25开始到10/17/2024-06:38:25结束，共4条，其关键特征为HTTP GET请求的URI以'/uc?id='开头，且以'&export=download'结尾|HTTP Host字段为'docs.google.com'，模拟合法云服务通信|User-Agent字段为'Synaptics.exe'，显示出特定恶意程序特征且有意规避常规检测",
      "第6步攻击：T1041: 攻击者通过与C2服务器（命令与控制服务器）之间的通信，使用正常的数据通道来回传敏感信息或执行命令，实现数据外泄且难以被察觉。此规则检测的是安卓恶意软件Quarian通过POST方式与指定路径/account/options/ping/进行checkin和数据回传的行为。  从11/27/2024-21:00:09开始到12/15/2024-03:19:44结束，共11条，其关键特征为HTTP POST方法，目标URI为/account/options/ping/，特定urilen（22字符）|User-Agent为'Apache-HttpClient/'（模拟常见Java网络客户端）|HTTP请求无Referer头部，HTTP Content-Length为0"
    ],
    "此攻击链关联的原因": "告警间TTP序列基本符合攻击链演进，时间上依序推进，主要通过TTP行为递进（环境与网络发现→本地驱动器枚举→持久化→键盘记录→数据外泄）形成链路，部分阶段存在间隔与缺失。辅助TTP和行为特征互为印证。存在行为阶段跳跃，标记POTENTIAL_GAP与MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于PowerShell脚本环境变量查询和网络主机发现，随后Loda Logger枚举本地磁盘，疑似实现对主机持久性控制后，通过FTP操作system32目录进行持久化准备，后续出现SnakeKeyLogger键盘记录及敏感信息收集，最终安卓恶意软件通过HTTP通道向C2服务器回传数据，实现完整信息窃取与外泄流程。"
  },
  "chain_6574": {
    "alerts_info": [
      "第1步攻击：T1189: ScanBox是知名的水坑攻击框架，该告警检测到通过在HTML head标签中动态插入form元素（通常伴随恶意JavaScript），诱导受害者浏览恶意网站，触发恶意内容自动加载，实现无感知感染，属于经典的驱动下载（Drive-by）攻击行为。 从08/24/2024-09:15:22开始到08/24/2024-09:15:22结束，共1条，其关键特征为HTTP协议流量，方向为服务器到客户端（from_server）|载荷中出现document.getElementsByTagName('head').item(0).appendChild(form_tag);疑似恶意JavaScript插入表单|Snort敏感路径检测，使用file_data关键字聚焦于HTTP内容层",
      "第2步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。 从08/26/2024-13:27:10开始到08/26/2024-13:27:10结束，共1条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第3步攻击：T1071.001: 此Snort规则检测通过HTTP POST方法向外部C2服务器发送特殊格式的数据流量。攻击者通常利用HTTP(S)协议进行回连，实现与被控终端的隐秘通信。规则特征表明利用常见通信路径如/notification，结合固定的HTTP头及Body，是典型的C2流量特征。 从11/19/2024-03:15:33开始到12/01/2024-00:03:44结束，共7条，其关键特征为HTTP POST请求，URI为/notification，起始特征明显|请求体中包含\"{ \"locale\":\"en\",\"channel\":\"prod\",\"addon\":\"\" 字符串，特征较固定，存在字段 nid, msg-|HTTP头包含Accept: */*，Accept-Encoding: gzip, deflate, br，Accept-Language: en-US",
      "第4步攻击：T1071.001: 此告警检测到终端主机访问Facebook聊天好友列表接口，利用HTTP协议中的POST方法，实现数据的隐蔽通信。攻击者可能通过将命令与控制信道或数据渗出流量伪装为正常的web流量来规避检测。 从01/15/2025-09:42:22开始到01/15/2025-09:42:22结束，共3条，其关键特征为HTTP协议POST方法，用于数据上传或会话操作|请求URI中包含/ajax/chat/buddy_list.php，疑似Facebook聊天接口|HTTP头部包含facebook.com，表明是针对社交平台的活动"
    ],
    "此攻击链关联的原因": "以TTP递进及时间顺序串联：浏览器水坑攻击（T1189）→implant落地并远程操控（T1620）→持续多样化HTTP C2通信（T1071.001），且各环节行为语义一致形成完整攻击路径。T1620关联T1071.001为C2场景合理演进，部分链路未覆盖完整阶段，容许MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链从ScanBox水坑攻击入侵浏览器实现初始访问并信息收集，随后针对iPhone投递implant实现持久化与指挥控制，经植入工具建立多种HTTP隐蔽通道与外部C2服务器持续交互，可能跨越多个通信媒介及协议，展现持续渗透与远程操控的APT特征。整体链路反映出入口依赖水坑攻击后的移动终端渗透、C2维持及多渠道数据交互。"
  },
  "chain_21215": {
    "alerts_info": [
      "第1步攻击：T1593: 此告警检测到主机向外部服务器发起包含典型YandexBot User-Agent的HTTP请求，表明攻击者可能正在对目标环境进行侦察，通过模仿知名爬虫以规避检测，对开放网站及其属性进行信息收集。  从08/23/2024-10:08:21开始到08/24/2024-13:26:15结束，共10条，其关键特征为HTTP协议流量，方向为本地到外部（to_server）|HTTP User-Agent包含字符串 “YandexBot”，通常用于伪装成正常爬虫流量|流量已建立，可能表明主动或自动化脚本操作，疑似为恶意软件通信或伪装侦察行为",
      "第2步攻击：T1593: 本规则检测到HTTP流量中携带有疑似恶意Powershell代码，使用System.Net.FtpWebRequest组件，可能通过恶意内容投递到受害终端并诱使用户执行，属于攻击者初步渗透的环节。  从08/25/2024-15:05:18开始到08/26/2024-10:16:23结束，共7条，其关键特征为检测到HTTP报文Body中包含System.Net.FtpWebRequest字符串|匹配到Powershell恶意模块特征，且流量方向为to_client（流入内部终端）|告警针对Windows平台客户端，说明攻击面主要为终端用户",
      "第3步攻击：T1566.002: 该告警匹配到针对凭证窃取的钓鱼网站活动，攻击者通过伪造网站页面诱骗用户提交凭证信息，属于凭证访问阶段。  从08/28/2024-14:44:10开始到08/28/2024-14:44:10结束，共2条，其关键特征为HTTP POST 方法，表明为表单数据提交行为|请求URI包含'/remkus'路径，这可能为钓鱼套件的特定路径|HTTP请求体中包含'pass='参数，指向凭证采集字段",
      "第4步攻击：T1539: 攻击者通过注入恶意JavaScript（Pipka Skimmer）监控网页上的表单输入，窃取包括信用卡号在内的敏感支付数据。此类Web Skimmer通常嵌入电商网站前端，通过在用户输入支付信息时将数据偷偷发送给攻击者控制的后端服务。  从11/11/2024-04:46:55开始到11/11/2024-04:46:55结束，共1条，其关键特征为HTTP响应码为200，从服务端传送web页面数据|HTTP响应体包含：'scriptId','gate',以及'cc_number'等关键词，表明有可疑JS Skimmer脚本内容|脚本中定义gate（数据传出网关）和cc_number（信用卡号字段），高度契合于电商钓鱼数据窃取场景"
    ],
    "此攻击链关联的原因": "通过TTP时序递进（侦察-初始访问-凭证窃取-数据窃取）、HTTP协议与行为特征、脚本与数据收集语义串联，推断为同一攻击链，部分环节存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该攻击链展现了攻击者从网络侦察（模拟YandexBot进行资产摸排）、向终端递送含有Powershell恶意代码的初始渗透、利用钓鱼网页收集凭证，再到植入Web Skimmer脚本窃取敏感支付数据，全程采用HTTP协议分阶段推进，体现了多阶段网络攻击的完整流程。"
  },
  "chain_1493": {
    "alerts_info": [
      "第1步攻击：T1204.002: 检测到通过MalDoc（恶意文档）类型载荷，利用了微软诊断工具（ms-msdt）协议漏洞。一旦用户在客户端打开含有payload的文档（如Office文档），将触发远程代码执行，属于典型的用户驱动恶意内容。  从08/24/2024-09:16:25开始到08/24/2024-09:22:39结束，共3条，其关键特征为检测到内容特征：<title>Exploit</title>，属于恶意文档载荷标志|JavaScript脚本标签 <script> // ... window.location.href = \"ms-msdt:\"...|HTTP协议流量特征，数据流为established、to_client，偏移和深度匹配80字节内存在特定利用内容",
      "第2步攻击：T1204.002: 该Snort规则检测到了通过HTTP从外部下载HTA（HTML Application）文件的行为，这通常利用漏洞（如CVE-2017-0199）诱使用户或自动触发恶意脚本执行，从而在受害主机上执行恶意代码。  从08/24/2024-09:38:44开始到08/24/2024-09:38:44结束，共1条，其关键特征为HTTP流量，服务端主动向客户端传输数据（flow:established,from_server）|HTTP返回头部Content-Type含“application/hta”类型|与CVE-2017-0199漏洞利用相关，常针对Windows客户端。",
      "第3步攻击：T1203: 检测到攻击者利用CVE-2017-0199（Microsoft Office/WordPad远程代码执行漏洞）的网络活动，该类漏洞常见于Word文档或RTF，通过诱导用户开启恶意文档执行任意代码。  从08/25/2024-18:12:08开始到08/25/2024-18:12:08结束，共1条，其关键特征为HTTP协议，来自服务器到客户端的已建立连接流量（from_server）|内容包含伪装的RTF结构（如字节序列7b 5c 72 74 ``{\\rt`` 和 ``\\objautlink``特征）|利用CVE-2017-0199漏洞命中的Stage 2（第二阶段）下发恶意内容",
      "第4步攻击：T1140: 该HTTP请求的URI部分出现了Base64编码（正则和content检测），表明恶意软件利用编码方式对通信流量进行混淆，以绕过防御检测。恶意文档（Maldoc）可能通过编码后的数据通报系统环境信息、执行结果或其他情报，帮助攻击方回避网络检测。  从08/25/2024-22:36:44开始到08/25/2024-22:36:44结束，共1条，其关键特征为HTTP GET请求，目的地为外部网络(EXTERNAL_NET)|URI中含有Base64编码字符串，且路径以/开头符合编码正则（/^[A-Za-z0-9+/]{4}*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/）|缺少Referer HTTP头部，表明是直接请求且符合恶意软件自动化通信行为",
      "第5步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从08/26/2024-04:41:57开始到08/26/2024-04:41:57结束，共3条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第6步攻击：T1059.007: 检测到通过HTTP传输含大量String.fromCharCode拼接的JScript代码，属于利用JavaScript代码进行Payload解码和远程执行，是攻击者在受害主机浏览器或脚本引擎环境中实现代码执行的常见方式。  从08/29/2024-11:27:13开始到08/29/2024-11:27:13结束，共2条，其关键特征为HTTP文件传输场景，响应代码200，证明内容成功下发。|JScript代码中存在大量String.fromCharCode拼接（正则及内容匹配），用于字符混淆和动态解码。|内容中出现\\\\WMIC.exe\\\"，指示目标为调用Windows管理工具实现后续操作。",
      "第7步攻击：T1105: 本Snort规则监测到以HTTP协议形式，从外部网络向内网主机下发的可疑VBS脚本（可能为木马下载器的Payload），属于攻击者通过命令与控制通道传输工具或恶意负载到受害系统典型行为。  从09/05/2024-20:51:44开始到09/05/2024-20:51:44结束，共1条，其关键特征为HTTP响应体中包含特定标签 <component>|VBS脚本语句出现GetDrive(\"C:\")等本地驱动器操作|Windows Installer相关关键词出现（如windowsinstaller.installer, InstallProduct, SerialNumber）",
      "第8步攻击：T1071.001: 此告警检测到QuasarRAT的反向HTTPS通信证书，表明攻击者通过加密Web协议建立与受害者主机的命令与控制通道。QuasarRAT经常通过HTTPS与攻击者控制基础设施建立加密会话，从而绕过检测与防御。  从10/16/2024-00:18:33开始到10/16/2024-00:18:33结束，共4条，其关键特征为TLS会话证书字段存在典型的QuasarRAT生成模式（如C=US, OU=primary, emailAddress=primary@等）|告警针对从外部网络指向内部的TLS连接（$EXTERNAL_NET -> $HOME_NET）|侦测到与已知QuasarRAT攻击工具相关的证书内容或结构"
    ],
    "此攻击链关联的原因": "所有告警均围绕恶意文档初始入侵—漏洞利用—载荷混淆/解码—脚本执行—工具下发与C2阶段演变，TTP进程合理衔接且时间有序。多处辅助TTP和内容语义（如Koadic、QuasarRAT、RTF/HTA/PowerShell等）及流量特征支撑整体链条闭环。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链自钓鱼/恶意文档入侵（Word/RTF/HTA载荷，T1204.002）及漏洞利用（CVE-2017-0199，T1203），经通信/数据混淆与解码（T1140、T1027），逐步推进，并伴随PowerShell、JScript脚本执行（T1059.007），实现对目标主机硬盘信息侦查与木马下发（T1105），最终通过Koadic C3C或QuasarRAT建立HTTPS加密C2连接（T1071.001），涵盖完整APT攻击的主要阶段。"
  },
  "chain_25635": {
    "alerts_info": [
      "第1步攻击：T1204.002: 该告警检测到Gamaredon APT使用的恶意Office文档通过远程模板拦截（GET方法）技术拉取远程模板。这是利用用户打开恶意文档时自动从远程服务器加载有效载荷，实现代码执行。  从08/24/2024-09:18:40开始到08/24/2024-09:18:40结束，共1条，其关键特征为HTTP GET请求，URI以.kdc结尾，长度大于30|User-Agent头部内容包含“; ms-office; ”，表明与Office远程模板请求相关|HTTP请求无Referer头，进一步体现自动化远程模板拉取特征",
      "第2步攻击：T1547.001: 攻击者通过HTTP GET访问特定路径（/install.bak/），可能用于恶意软件安装或留存，利用启动项或脚本机制实现持久化。  从08/24/2024-09:51:20开始到08/24/2024-09:51:20结束，共1条，其关键特征为HTTP GET方法，访问特定路径 /install.bak/|User-Agent 为 'Mozilla/4.0'，缺失 Referer 头部|URI中包含/[0-9]{2}\\.html结尾的结构",
      "第3步攻击：T1082: 攻击者通过WMIC工具收集主机操作系统相关信息，如启动设备(Boot Device)、构建号(Build Number)、构建类型(Build Type)。这些信息常用于识别主机环境、辅助后续针对性攻击。  从08/25/2024-14:28:05开始到08/27/2024-08:56:42结束，共4条，其关键特征为WMIC命令输出（如 Boot Device, Build Number, Build Type）在流量中出现|TCP已建立连接流量，方向为本地主机到外部服务器（to_server）|目标环境为Windows操作系统家族",
      "第4步攻击：T1564.001: 告警检测到HTTP POST请求体内包含特征码'PK'，表明数据为ZIP压缩格式，说明攻击者可能通过加密（压缩）文件隐藏、绕过安全检测，将敏感信息（如Cards_Google.txt）上传到外部网络，实现防御规避。  从09/02/2024-21:17:52开始到09/02/2024-21:17:52结束，共1条，其关键特征为HTTP POST方法（http.method; content:\"POST\"）|请求体中出现ZIP文件头特征值'PK'（http.request_body; content:\"PK\"）|请求体中传输名为'Cards_Google.txt'的文件（content:\"Cards_Google.txt\"）",
      "第5步攻击：T1053.005: 威胁行为者可能通过系统服务或作业调度机制（如计划任务），保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件的持久化机制相关联。  从09/12/2024-12:03:22开始到09/12/2024-12:03:22结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第6步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从10/07/2024-20:19:53开始到10/07/2024-20:19:53结束，共1条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第7步攻击：T1105: 攻击者通过HTTP GET请求，尝试从外部网站（如kuwaiti.co）下载恶意文件或工具，绕过安全防护，将工具或其他恶意载荷传输到受害主机上。此类行为通常用于感染初期或C2阶段，用于后续活动。  从10/13/2024-08:31:48开始到12/01/2024-02:32:14结束，共8条，其关键特征为HTTP GET请求发送至kuwaiti.co域名，指向外部服务器|HTTP请求不包含常见的Accept、Referer、User-Agent头部，呈现自动化、异常通信特征|流量方向从内部到外部，符合典型恶意工具下载或C2流量",
      "第8步攻击：T1071.001: 攻击者通过HTTP GET请求向其远程C2服务器（/alive.php）发送系统信息（key, pcuser, pcname, hwid, country 等），建立和维持命令与控制通道，报告受控终端状态。  从12/13/2024-17:52:35开始到12/14/2024-10:16:44结束，共3条，其关键特征为HTTP协议，方法为GET|URI包含 /alive.php? 和参数 key=、pcuser=、pcname=、hwid=、country=|流量方向为内网主机到外部服务器（$HOME_NET -> $EXTERNAL_NET）",
      "第9步攻击：T1041: 恶意软件通过 HTTP POST 请求将凭证等敏感数据从受害主机向外部 C2 服务器渗出，使用常见的 web 通讯方式使渗出活动伪装成正常流量，逃避检测。  从01/17/2025-06:08:22开始到02/05/2025-12:29:15结束，共5条，其关键特征为HTTP POST 方法，URI 路径为 /index.php，且请求体以 id= 开头、&cred= 在头20字节内|内容类型为 application/x-www-form-urlencoded，请求体大小至少 33 字节|HTTP请求缺少 Referer 和 User-Agent 头，与常规HTTP流量不同，是恶意软件自制请求的特征"
    ],
    "此攻击链关联的原因": "基于TTP顺序（诱导→持久化→发现→防御规避→持久化→收集→工具投递→C2→数据渗出）及时间连续性，部分环节如发现与C2之间存在TTP跳跃，辅助关联特征如C2通信与异常持久化、压缩传输实现串联，整体攻击链逻辑连贯，允许潜在步骤缺失。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者利用钓鱼office文档诱导（T1204.002）初始投递，后通过HTTP与计划任务部署实现持久化（T1547.001、T1053.005），再通过系统信息收集（T1082）与键盘记录（T1056.001）窃取敏感数据。期间，通过ZIP压缩渗出（T1564.001）、工具下载（T1105）、C2联络（T1071.001）、最终敏感凭证外传（T1041），反映出多阶段APT攻击链，具备高度隐蔽与连续性。"
  },
  "chain_10948": {
    "alerts_info": [
      "第1步攻击：T1105: 该行为表现为攻击者通过 HTTP 下载可执行文件（如恶意 payload）到受害主机，是投递远控木马、dropper 或后门等工具的常见方式，辅助后续控制或内网渗透操作。  从08/24/2024-09:35:12开始到08/24/2024-09:35:12结束，共1条，其关键特征为HTTP协议下，直接请求可疑域名获取PE型可执行文件|检测内容：文件以'MZ'魔数开头且有有效的PE头，确认下载对象为Windows可执行文件|检测请求头或流特征伪装为浏览器请求，且域名被标识为疑似恶意（flowbits: ET.Suspicious.Domain.Fake.Browser）",
      "第2步攻击：T1573: 该告警监控客户端通过加密通道（TLS）向恶意域名（ticketsmaster.win）发起请求，用于隐藏恶意流量内容，绕过流量的明文检测，规避安全设备的监控。  从08/24/2024-10:02:44开始到09/01/2024-19:58:54结束，共13条，其关键特征为TLS SNI字段包含恶意域名 ticketsmaster.win|流量方向为内网客户端到外部网络服务器，TLS加密|告警关联Maldoc恶意文档家族，与已知恶意MD5（c81c4c5dd54fefdfa06f1206fc51f5ee）相关"
    ],
    "此攻击链关联的原因": "通过T1105（恶意软件投递）到T1573（C2通信加密）之TTP链条，时间上顺序合理，均涉及相同威胁基础设施及向外通信，虽部分中间步骤缺失，但PE下载后C2连接行为具备高度连续性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链以受害主机HTTP下载恶意PE文件（T1105）为起点，紧接着发起加密TLS通信（T1573）至同一威胁域名，表现为典型的恶意软件落地后进行隐匿C2流量的行动流程，实现从植入到远控通信的完整攻击阶段切换。"
  },
  "chain_3389": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到利用Microsoft Equation Editor (CVE-2017-11882) 漏洞的恶意RTF文档下载行为。攻击者常将此漏洞嵌入带有恶意OLE对象的Office文档，通过邮件等方式投递给受害者，实现初步访问。  从08/24/2024-09:47:12开始到08/24/2024-09:55:43结束，共6条，其关键特征为HTTP协议，检测到RTF文档下载流量|文件内容包含特征字符串 'objclass Equations}' 及特定十六进制标识 ('02CE020000000000C000000000000046')，表明嵌入OLE对象|流量方向为外部(攻击者)到内部(受害者)，常见于钓鱼攻击传输阶段",
      "第2步攻击：T1566.001: 此规则检测到CVE-2017-0199漏洞攻击，典型用于通过恶意Office文档（嵌入HTA文件）进行钓鱼欺骗，诱导目标打开并激活恶意代码，从而为攻击者获取初始访问权限。  从08/25/2024-11:08:22开始到08/25/2024-11:08:22结束，共3条，其关键特征为HTTP流量流向内网终端（$EXTERNAL_NET -> $HOME_NET）|Content-Type为application/hta（检测HTA文件传递）|内容中包含.expandedEnvironmntStrings与特定Microsoft Office宏相关字节特征，以及'|Menu\\Programs\\Startup\\'等可利用HTA绕过执行的痕迹",
      "第3步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/12/2024-03:23:49开始到09/12/2024-03:23:49结束，共2条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第4步攻击：T1547.001: 攻击者通过下发或修改含Winlogon相关注册表项的.reg文件，尝试改变系统登录行为或实现持久化，在用户登录时自动启动恶意程序。  从10/09/2024-06:11:13开始到10/09/2024-06:11:13结束，共1条，其关键特征为.reg文件以HTTP传输，文件内容以Unicode格式包含Winlogon注册表路径（含HKEY_LOCAL_MACHINE\\...\\Winlogon）|HTTP响应码为200（从外部下发/服务器响应成功）|注册表内容中明确指定explorer.exe作为启动程序，指纹特征聚焦Winlogon自动登录、Shell启动相关"
    ],
    "此攻击链关联的原因": "以TTP演进为主线，依次出现初始访问（钓鱼文档）、代码执行混淆与持久化。虽有时间跨度及中间步骤缺失（如横向移动/权限提升），但攻击流程及上下游逻辑一致，TTP及行为描述形成合乎常理故事线。步进链条涉及钓鱼利用（CVE-2017-11882/CVE-2017-0199）→恶意PowerShell脚本混淆→注册表持久化，具备典型攻击路径，个别阶段存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者利用钓鱼文档投递（CVE-2017-11882/CVE-2017-0199），引入恶意载荷并通过PowerShell脚本解压与内存加载进行混淆绕过。后续通过Winlogon注册表持久化机制实现系统启动时自动运行后门，完整呈现常见APT初始入侵、脚本执行与持久化存活的主线攻击流程。"
  },
  "chain_404": {
    "alerts_info": [
      "第1步攻击：T1588.003: 攻击者生成或获取伪造的SSL证书，以用于加密通信，从而隐藏与恶意基础设施的连接并规避检测。 从08/24/2024-10:08:14开始到08/24/2024-15:19:52结束，共3条，其关键特征为特定SSL证书主题字段（Subject）中存在C=--, ST=SomeState, root@localhost.localdomain等可疑标识|SSL证书序列号中包含12:85，进一步指向特定恶意SSL证书|流量方向为外部网络到内部终端（from $EXTERNAL_NET:443 to $HOME_NET:any），建立状态为to_client",
      "第2步攻击：T1566.001: 检测到带有可疑 Word 文件嵌入 PDF 文件的服务器响应，该手法常被 Locky、Dridex 等恶意软件用于钓鱼邮件，通过嵌入型恶意文档诱使用户开启恶意内容，达成初始入侵。  从08/29/2024-14:01:18开始到08/30/2024-18:45:01结束，共5条，其关键特征为检测到 HTTP 响应中 PDF 文件（flowbits:isset,ET.pdf.in.http）|PDF 内容包含 '\\nstream\\nPK'，表示 PDF 流对象中嵌入压缩文件结构（如嵌入 Word 的 ZIP 格式）|内容包含 'word/_rels/'，这是 Office Open XML Word 文档内部结构的目录特征，指向实际 Word 内容数据",
      "第3步攻击：T1055: 该告警检测到njRAT的安装行为，攻击者很可能利用进程注入等方法在目标系统中植入恶意程序，以规避检测机制和提升持久性。  从09/10/2024-23:32:28开始到09/12/2024-04:10:59结束，共10条，其关键特征为HTTP协议，POST方法，目标为外部网络(EXTERNAL_NET)|请求uri中包含/check?l=，并附带v、os、p等参数，c=emp作为请求体内容|HTTP请求不包含Referer头，且该行为常见于恶意流量",
      "第4步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从10/02/2024-03:59:17开始到10/02/2024-03:59:17结束，共1条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。"
    ],
    "此攻击链关联的原因": "依照TTP顺序，攻击者首先获取并利用伪造SSL证书（T1588.003），继而通过钓鱼文档（T1566.001）开展初始载荷投递，后续检测到njRAT的典型进程注入（T1055）和虚拟化侦查/反分析（T1497.001）行为。各环节行为逻辑连贯，时间连续但有MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者最初利用伪造的SSL证书进行隐蔽通信，随后通过带有恶意Word嵌入的PDF文档发动钓鱼攻击，引导用户感染njRAT，期间采用进程注入实现持久化和提权，末期执行反沙箱侦查以规避分析，展现典型APT攻击链。"
  },
  "chain_3084": {
    "alerts_info": [
      "第1步攻击：T1190: 攻击者利用Exim4邮件服务器处理BDAT命令中的非打印字符触发Use After Free (UAF)漏洞，尝试通过SMTP协议对目标服务器进行远程代码执行或服务崩溃，属于针对公开服务的漏洞利用。  从08/24/2024-10:12:03开始到08/24/2024-10:47:10结束，共3条，其关键特征为SMTP协议流量，客户端到SMTP服务器|出现BDAT命令（RFC 3030扩展）且后随异常的非打印字符|PCRE正则匹配BDAT命令后跟随非法（非x20-x7e, 非回车换行制表符）字符",
      "第2步攻击：T1140: 检测到HTTP请求URL中存在Base64编码且疑似恶意（字符串“aGFja2Vk”解码后为“hacked”），攻击者常使用Base64编码隐藏命令、有效载荷、或将恶意内容隐藏于通信之中，从而规避检测。  从08/25/2024-02:03:53开始到08/25/2024-02:03:53结束，共1条，其关键特征为HTTP请求的URL中出现Base64编码的字符串（例如“aGFja2Vk”）|HTTP请求未包含Referer头，常见于自动化工具、恶意流量或无Referer的攻击代码|通信方向为$HOME_NET发起至$EXTERNAL_NET，表示内部主机主动访问外部，可能为回连或数据外泄行为",
      "第3步攻击：T1055: 检测到远控工具EHDevel RAT通过进程注入下发KILL命令，可能用于终止安全产品或其他系统进程，实现防御绕过或维持持久控制。  从08/27/2024-13:26:20开始到08/27/2024-21:55:41结束，共5条，其关键特征为TCP流量（established,from_server方向）数据包长度小于300字节|内容包含关键字顺序：|00|, Packet, processManager, List, Kill|关联EHDevel RAT家族，出现在未知来源到内网主机的会话中，具系统进程管理能力",
      "第4步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从09/03/2024-08:16:12开始到09/03/2024-08:16:12结束，共1条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。"
    ],
    "此攻击链关联的原因": "按TTP时序链（T1190初始访问→T1140混淆与指令传输→T1055进程注入→T1497.001环境侦测）递进，时间顺序逻辑连续，且行为间在APT场景下具相关性。第3至第4步之间存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先利用Exim4邮件服务远程漏洞（T1190）获取初始访问，随后通过HTTP流量使用Base64编码实施数据隐藏与通信（T1140），进一步在内网主机植入EHDevel RAT并通过进程注入控制主机（T1055），最后执行虚拟化检测（T1497.001）以规避分析和提高隐匿性，展现一次较为完整的高度隐蔽攻击链。"
  },
  "chain_5782": {
    "alerts_info": [
      "第1步攻击：T1588.002: 该告警检测到与自签名TLS证书相关特征。攻击者通常通过生成或获取自定义伪造证书来实现C2（Command and Control）通信的加密，从而躲避检测。本次检测以国家为US、省为Arizona、城市为Chandler等伪造证书属性标志，证书无Organization字段、Subject结构等为特征,此类证书多用于加密C2流量规避安全检测。",
      "第2步攻击：T1105: 该行为表现为攻击者通过 HTTP 下载可执行文件（如恶意 payload）到受害主机，是投递远控木马、dropper 或后门等工具的常见方式，辅助后续控制或内网渗透操作。  从08/30/2024-02:31:19开始到09/06/2024-19:53:50结束，共7条，其关键特征为HTTP协议下，直接请求可疑域名获取PE型可执行文件|检测内容：文件以'MZ'魔数开头且有有效的PE头，确认下载对象为Windows可执行文件|检测请求头或流特征伪装为浏览器请求，且域名被标识为疑似恶意（flowbits: ET.Suspicious.Domain.Fake.Browser）",
      "第3步攻击：T1027: 攻击者通过混淆JavaScript代码（如使用Obfuscator.io）来规避检测与分析工具，提高恶意代码的隐蔽性并绕过安全产品。  从08/25/2024-18:36:44开始到08/25/2024-18:36:44结束，共3条，其关键特征为HTTP响应体中出现特定的混淆代码片段，如Obfuscator.io典型字符串特征（例如特殊变量命名或编码逻辑）|正则匹配到function(_0xxxxxxx,_0xxxxxxx){var _0xxxxxxx=/Qi等混淆代码结构|Base64特征字符串：abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=；以及'var '语句特征",
      "第4步攻击：T1133: 攻击者尝试通过WinRM服务的未认证接口进行访问，可能利用合法远程服务作为初始攻击入口，绕过边界防护进行横向渗透。  从09/29/2024-20:10:59开始到09/29/2024-20:10:59结束，共1条，其关键特征为POST请求方法针对/wsman路径，表明此为WinRM通信。|HTTP头包含 'WSMANIDENTIFY: unauthenticated' 字样，表明为未认证请求。|HTTP请求主体带有 <s:Envelope> 结构，且Content-Type为application/soap+xml，符合WinRM SOAP通信规范。"
    ],
    "此攻击链关联的原因": "以TTP顺序和时间线为主线，2037285（恶意C2基础设施搭建）→2018572（恶意payload下载，MISSING_STEP：初始入口/武器化环节 absent）→2038501（恶意脚本混淆以实现隐蔽执行）→2812380（利用WinRM横向渗透，时间链持续，POTENTIAL_GAP: 步骤间有大时间跨度）。行为语义关联以远控、持久化和横向移动为主。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击始于自签TLS证书搭建C2基础设施，随后通过HTTP恶意PE下载（疑似后门投递），再使用高度混淆JavaScript提升隐蔽性，在后期通过WinRM未认证访问尝试横向渗透，展现完整的渗透-控制-隐蔽-内网扩散链条，虽隐有步骤跳跃但阶段转移清晰。"
  },
  "chain_1587": {
    "alerts_info": [
      "第1步攻击：T1027.002: 该DLL文件名为Enc.dll，并通过特殊的HTTP请求从外部位置下载。恶意软件常利用动态链接库（DLL）的下载与加载进行恶意代码的动态部署或规避检测手段，例如利用自定义请求路径、不携带常规HTTP头部来躲避安全检测。  从09/05/2024-23:44:12开始到09/06/2024-11:33:52结束，共3条，其关键特征为HTTP协议，发起GET方法请求|URI结构为/某数字/Enc.dll，正则/^/\\d+/Enc\\.dll$/|HTTP头部缺失常见字段（User-Agent、Referer、Accept），流量异常",
      "第2步攻击：T1059: 检测到Sofacy后门与客户端的特征通信，通常代表后门程序正试图接收控制端命令，或正准备执行由攻击者下发的指令。这种行为属于远程控制恶意代码常见的执行阶段。  从08/24/2024-10:55:19开始到08/28/2024-03:41:08结束，共7条，其关键特征为流量方向为内部主机->外部任意主机，标志与服务器已建立会话（from_server, established）|报文负载长度固定为9字节（dsize:9），内容为二进制序列（|C5 f4 E6 E6 E2 FA E7 F1 AF|）|基于已知恶意软件样本md5（5138e1542dec11f0604037cb7082b96f）对应的签名匹配",
      "第3步攻击：T1140: Chopstick后门通过VBS脚本传送配置数据，通常以经过编码或混淆的内容下发至受害主机，通过文件型C2载荷渗透，试图绕开检测机制进行加载执行，规避安全防护。  从08/29/2024-16:19:01开始到08/29/2024-16:19:01结束，共1条，其关键特征为响应状态码为200，说明目标已成功返回VBS配置文件|返回数据中包含明确结构：'--- config ---', 'host = ', 'port = ', 'installdir = ', ' code start'等关键字，体现为VBS恶意配置|流量方向为服务器到客户端，典型的C2下发/远程管理行为，HTTP协议为载体",
      "第4步攻击：T1119: 检测到UserBenchmark程序主动通过POST方式，将包含计算机硬件与性能信息的原始数据(rawBenchData)自动收集并向外部服务器提交。这属于自动化工具批量收集、整理系统信息，并通过网络传输到外部，这一行为属于收集阶段的自动化收集技术。  从09/15/2024-16:57:55开始到10/01/2024-20:33:27结束，共3条，其关键特征为HTTP POST方法，目标路径为/Software|自定义HTTP头部 'Filename: rawresults.dat'，请求体包含 'rawBenchData=' 字符串|User-Agent为'UserBenchMark'，且缺失常见的Referer和Accept头",
      "第5步攻击：T1021.002: 告警检测到MoveLater模块尝试通过SMB命名管道与受害者系统进行通信。这属于利用Windows命名管道做为横向移动方式，攻击者以此在不同主机间传递数据或命令以实现后续控制。  从10/10/2024-13:14:29开始到10/13/2024-07:01:14结束，共5条，其关键特征为目标端口为139或445（SMB相关端口）|TCP会话，使用SMB协议（以0xFF开头的SMB头）|特定命名管道名（probable Unicode编码），用于MoveLater模块通信",
      "第6步攻击：T1573.001: 告警检测到利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从10/21/2024-22:55:18开始到11/10/2024-09:30:21结束，共3条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第7步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从12/18/2024-08:49:21开始到12/19/2024-14:20:14结束，共3条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第8步攻击：T1041: 检测到恶意Android应用（如Android.Trojan.Ansupv.B）与外部C2服务器建立HTTP连接，通过带有特征参数的.php脚本路径（如TG、IMEI、IMSI、PUSH_ID），试图通过C2通道传输敏感数据，实现数据渗漏与设备识别。  从01/28/2025-17:00:31开始到02/01/2025-11:37:41结束，共11条，其关键特征为HTTP请求URI包含.php?，并带有TG=、&IMEI=、IMSI=、&PUSH_ID=等参数，说明定制化数据上报格式。|HTTP头部缺失Referer字段，说明为自动化或隐蔽通信流量，典型恶意流量特征之一。|流量方向是HOME_NET->EXTERNAL_NET（移动端对外），符合移动恶意软件C2与数据外泄的典型行为。"
    ],
    "此攻击链关联的原因": "通过TTP行为链分析，涵盖恶意DLL下载（T1027.002）、后门C2通信与执行（T1059）、恶意脚本解码及配置下发（T1140）、系统硬件信息收集（T1119）、SMB横向移动（T1021.002），再到加密C2及凭据转储和数据外泄等，时间与TTP序列推动整体攻击流程。部分阶段（如从执行到解码、从收集到横向）有步骤缺失，已结合辅助TTP与语义连续性进行判断, 标记MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链从恶意DLL下载及混淆开始，后门程序远程控制并下发配置，自动化收集系统信息，随后通过SMB命名管道尝试横向移动，再借由加密隧道建立隐蔽C2通信通道。攻击者进而窃取系统凭据并外泄数据，最终实现了针对多平台（桌面与移动端）的完整数据窃取与持久化、多阶段攻击流程。"
  },
  "chain_24578": {
    "alerts_info": [
      "第1步攻击：T1027.002: 该告警匹配到Yoda's Protector 打包工具生成的特征码，属于恶意软件通过打包程序混淆恶意二进制，从而逃避防病毒软件或安全检测的常见方式。  从08/24/2024-12:01:10开始到08/24/2024-12:01:10结束，共1条，其关键特征为检测到Yoda's Protector打包特征字节流：E8 03 00 00 00 EB 01 和 BB 55 00 00 00 E8 03 00 00 00 EB 01|流方向为已建立连接且数据流来自服务器（from_server）|针对通过TCP协议任意端口，通常与恶意软件下发或回传阶段有关",
      "第2步攻击：T1055.001: 利用MySQL服务器将自定义可执行文件（.exe）写入Windows系统目录（C:\\windows\\system32），以便后续执行，以达到绕过安全控制、潜在获取SYSTEM权限等目的。此方法为Stuxnet等高级威胁常用技术。  从09/11/2024-01:23:45开始到10/03/2024-09:15:32结束，共5条，其关键特征为对MySQL服务（TCP 3306）的写入型SQL命令检测（INTO DUMPFILE 指向 C:\\windows\\system32\\*.exe）|SQL查询中带有SELECT data FROM ..., INTO DUMPFILE，目标为可执行文件（.exe）|利用MYSQL DUMPFILE功能直接在系统关键目录写入新文件，实现恶意持久化或远程利用",
      "第3步攻击：T1573.001: 告警检测到Cobalt Strike Beacon通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从11/14/2024-21:45:08开始到11/14/2024-21:45:08结束，共2条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第4步攻击：T1105: 该规则检测到恶意二阶段载荷下载请求，表明攻击者正在通过HTTP传输二进制或脚本型有效负载，属于典型的渗透后工具传送或命令与控制阶段的入侵行动。  从01/19/2025-04:35:01开始到02/09/2025-22:47:35结束，共6条，其关键特征为HTTP URI模式中出现：.php?rnd=[数字]&id=[32位及以上十六进制字符串]|HTTP请求无Referer头，可能躲避溯源及关联流量分析|已建立的HTTP会话（flow:established,to_server）专门向外部网络（$EXTERNAL_NET）发起"
    ],
    "此攻击链关联的原因": "基于TTP时序（T1027.002混淆→T1055.001可执行注入→T1573.001加密C2通信→T1105远程载荷下载）及时间顺序，所有行为符合典型APT攻击链。部分步骤间存在合理跳跃，整体链路及行为连续性强。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过Yoda's Protector将恶意软件混淆免杀，并尝试利用MySQL服务器执行写入型SQL命令向关键系统路径部署可执行文件，随后通过Cobalt Strike Beacon及定制SSL证书建立C2加密通信，在后期通过HTTP从外部下载二阶段恶意载荷，全链条展现高度隐蔽的APT攻击流程，涵盖免杀、持久化、外联控制与工具传送。"
  },
  "chain_24887": {
    "alerts_info": [
      "第1步攻击：T1588.002: 该告警检测到与Quasar RAT后门框架相关的自签名TLS证书，攻击者通常通过生成或获取自定义伪造证书来实现C2（Command and Control）通信的加密，从而躲避检测。此证书特征表明其用于恶意基础设施的搭建并支持后续攻击阶段。 从08/24/2024-12:56:14开始到08/24/2024-12:56:14结束，共1条，其关键特征为检测与Quasar工具相符的自签TLS证书Subject字段，如国家为US，省为Arizona，城市为Chandler。|TLS握手阶段，Client to Server流量，含有特定证书序列及模式（例如证书未包含组织名，pcre正则特征匹配证书序列号）。|证书中的结构及其缺省项符合已知Quasar默认生成证书特征（如证书无Organization字段，证书主题有特定ASN.1结构）。",
      "第2步攻击：T1557: 攻击者绕过TP-Link路由器身份验证机制，直接访问配置文件（conf.bin），以获取凭证或敏感信息。获取配置信息后，可进一步获取管理权限。 从09/03/2024-18:05:33开始到09/04/2024-10:12:41结束，共3条，其关键特征为HTTP请求路径包含 /cgi/conf.bin|HTTP请求头包含 /mainFrame.htm|针对TP-Link TL-WR840N/TL-WR841N型号存在认证绕过漏洞",
      "第3步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。 从10/06/2024-21:47:58开始到10/06/2024-21:47:58结束，共1条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第4步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。 从12/12/2024-09:41:02开始到12/21/2024-20:15:27结束，共4条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第5步攻击：T1071.004: 攻击者利用DNS协议进行命令与控制通信，将数据封装在DNS查询或响应之中，用于远程控制或数据传输时规避检测。该技术能实现隐蔽的流量隧道，将数据附加在DNS查询域名当中进行双向通信。 从02/09/2025-14:26:47开始到02/10/2025-16:31:24结束，共11条，其关键特征为DNS协议通信|DNS查询名含有大量[a-h,i-l,m-p,q,r,s,t,v,x,y,z,1-9]字符，且长度为62位+后缀('.aaaaaaaaaaaa')|正则表达式/内容匹配：/^[abcdefghiklmnopqrstvxyz123456789]{62}\\.aaaaaaaaaaaa/"
    ],
    "此攻击链关联的原因": "链以T1588.002初始武器化（恶意C2基础设施搭建）为起点，随后通过T1557路由器配置提取与T1555凭据收集、T1056.001键盘记录（均为TA0009信息收集阶段），继而T1071.004利用DNS隧道实现C2通信，行为和TTP顺序高度契合，存在步骤缺失但语义连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链起于恶意C2基础设施搭建（自签Quasar证书），攻击者随后通过路由器配置收集和凭据抓取、键盘记录等方式窃取敏感信息。最终利用DNS隧道实现命令与控制与数据外传，体现从准备、渗透到数据收集和隐蔽通信的完整APT攻击路径。"
  },
  "chain_14339": {
    "alerts_info": [
      "第1步攻击：T1204.002: 该规则检测到潜在的恶意程序下载（Dropper）正通过HTTP GET请求尝试安装不受欢迎程序（PUP）。攻击者利用社会工程或其他诱导用户执行的方式，让受害者端发起对恶意载荷的下载，从而达到绕过防御、植入恶意软件的目的。  从08/24/2024-14:27:45开始到08/24/2024-14:27:45结束，共1条，其关键特征为HTTP GET请求，目标路径为/ohupdate.php?program=...&q=...|User-Agent为\"Mozilla/4.0\"|流量方向为内部到外部（HOME_NET->EXTERNAL_NET），适用于已被植入Dropper的主机与外部C2或下载站通讯行为",
      "第2步攻击：T1140: Dunihi恶意软件通过VBS脚本传送配置数据，通常以经过编码或混淆的内容下发至受害主机，通过文件型C2载荷渗透，试图绕开检测机制进行加载执行，规避安全防护。  从08/28/2024-17:15:10开始到08/28/2024-17:15:10结束，共1条，其关键特征为响应状态码为200，说明目标已成功返回VBS配置文件|返回数据中包含明确结构：'--- config ---', 'host = ', 'port = ', 'installdir = ', ' code start'等关键字，体现为VBS恶意配置|流量方向为服务器到客户端，典型的C2下发/远程管理行为，HTTP协议为载体",
      "第3步攻击：T1027: 攻击者利用编码、转换或加密等方法隐藏恶意流量或敏感内容，使得检测变得困难。本规则中，数据通过HTTP协议及特定编码格式进行传输规避常规检测。  从09/01/2024-18:02:21开始到09/01/2024-18:02:21结束，共1条，其关键特征为HTTP请求路径包含/sendmessage?chat_id=，表明与Telegram API通信。|请求参数中出现已URL编码的波斯文字符串及IMEI关键字，说明发送的是设备数据。|HTTP请求header中无User-Agent与Referer字段，表明此流量为非标准客户端发起，具有伪造或自动化特征。",
      "第4步攻击：T1547.001: 攻击者通过滥用 ChilkatHttp ActiveX 控件存在的漏洞，能够任意覆盖指定文件（如exe、dll、bat等可执行文件及配置文件），从而实现在受害主机上植入恶意代码，获得持久化或规避检测。  从09/13/2024-08:15:33开始到09/13/2024-08:15:33结束，共1条，其关键特征为HTTP流量（to_client, established），表明通过Web途径下发恶意代码|包含 ChilkatHttp ActiveX 控件 CLSID（B973393F-27C7-4781-877D-8626AAEDF119），且请求目标包含.ini、.exe、.dll、.bat、.com、.cab、.txt等敏感扩展名|出现 SaveLastError 字段，关联控件常用调用接口，可能伴随目标文件被覆盖/写入行为",
      "第5步攻击：T1574.002: 攻击者通过诱导客户端访问 SMB 服务器，使受害系统通过地址簿 wab32res.dll 加载远程恶意 DLL，从而利用漏洞（CVE-2010-3147），实现恶意代码执行，绕过安全防护机制。  从09/22/2024-19:20:51开始到09/22/2024-19:20:51结束，共2条，其关键特征为SMB 协议 (TCP 445端口) 网络流量|包含 wab32res.dll 的请求 (文件名指向易受攻击组件)|SMB 报文头部特征为 |FF|SMB|a2|，并进行了特定字节测试以识别协议细节",
      "第6步攻击：T1083: 该告警检测到Loda Logger恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从10/05/2024-15:44:02开始到10/05/2024-15:44:02结束，共2条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与Loda Logger家族相关，且适用于Windows平台的多版本",
      "第7步攻击：T1548.002: 该Snort规则检测的是CVE-2023-23397，这是一个影响Microsoft Outlook的特权提升漏洞。攻击者可以通过特制邮件包在用户无需交互的情况下提升权限、收集NTLM哈希等敏感信息。此操作本质上属于利用客户端应用漏洞实现权限升级。  从10/14/2024-08:16:09开始到10/14/2024-08:16:09结束，共1条，其关键特征为SMTP协议邮件流量，邮件内容中包含特定Base64编码|邮件正文以特定压缩内容或标识（如|78 9f 3e 22|，'IPM.Microsoft Mail.Note'）开头|PCRE正则检测邮件中携带有特殊SMB路径结构（如'\\服务器名\\...'），配合CRLF标志邮件结构分界",
      "第8步攻击：T1021.001: 该规则检测SMB（端口139/445）上的特殊远控工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从10/28/2024-10:22:31开始到10/29/2024-14:44:45结束，共3条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'出现在SMB流量内容中，疑似定制化远控工具或框架伪装特征。",
      "第9步攻击：T1021.002: 此告警检测到利用SMB协议尝试访问或操控远程Windows服务，常用于横向移动或躲避检测。流量中包含Unicode编码的服务名 'Office 365 Proxy'，该特征也可由定制化工具通过手工混淆实现。  从11/13/2024-22:18:33开始到11/13/2024-22:18:33结束，共2条，其关键特征为目的端口为139或445，表征SMB协议通信|包含SMB协议标识符 |ff 53 4d 42| ('F','S','M','B')|SMB流量中出现Unicode编码的服务名 'Office 365 Proxy'，表现为混淆手段",
      "第10步攻击：T1071.001: 攻击者使用标准Web协议（如HTTP POST）与其控制服务器通信，实现与受害者系统的稳定交互。此处表现为恶意软件OrbitalBeam通过 HTTP POST 请求（以特定 URI 和 Header 格式）回传数据到远程 C2 服务器。  从12/02/2024-12:41:09开始到12/02/2024-12:41:09结束，共3条，其关键特征为HTTP POST 请求路径为 /api/v1/Client/Info|HTTP Header 含有 X-Request-ID 字段|POST包体内容以 'Info: ' 开头，且 request body 匹配仅含有74个字母/数字字符的正则（疑似信息标识/编码）",
      "第11步攻击：T1041: 攻击者通过HTTP POST请求，将窃取的 FileZilla 密码配置文件（sitemanager.xml）作为表单数据上传至攻击者控制的服务器，实现敏感数据的网络渗出。  从01/28/2025-18:17:21开始到01/28/2025-18:17:21结束，共2条，其关键特征为HTTP POST方法，URI以.php结尾，目标为外部网络。|请求体为multipart/form-data，包含 'hwid' 和带有 'sitemanager.xml' 的 'file' 字段，数据携带 <FileZilla 配置内容。|HTTP请求无 Referer 头，匹配特定恶意软件传输习惯。"
    ],
    "此攻击链关联的原因": "主要基于TTP顺序与时间逻辑，兼顾多阶段攻击常见行为。从初始投递、下载执行、持久化，直至后续横向移动、提权、C2通信及数据渗出环节，虽然部分阶段存在间断（MISSING_STEP, POTENTIAL_GAP），但整体链条行为顺畅；部分关联依赖辅助TTP/行为语义，如防御规避与发现阶段。时间跨度较长，适合APT长链推断。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "该攻击链展现了从社会工程诱导恶意下载（Dropper），到恶意脚本加载及编码隐藏流量，再到持久化机制建立。攻击者利用DLL劫持及提权攻击针对系统关键组件，横向移动并实施主机发现和权限提升。最终借助C2通道与Web协议持续通信，窃取包括FileZilla配置等敏感数据，并通过HTTP渗出，实现完整多阶段APT攻击流程。"
  },
  "chain_17604": {
    "alerts_info": [
      "第1步攻击：T1190: 攻击者尝试利用Web暴露应用（如ActiveX控件EasyMail IMAP4组件）中的漏洞，实施缓冲区溢出攻击，从而获得目标系统的初始访问权限。  从08/24/2024-15:13:45开始到08/24/2024-15:14:22结束，共3条，其关键特征为HTTP流量包含关键词ActiveXObject，表明涉及ActiveX控件调用。|包含EasyMail.IMAP4.6，定位为EasyMail IMAP4组件的相关攻击尝试。|包含字段LicenseKey，表明攻击与具体组件注册或验证相关，典型于溢出漏洞利用Payload传播。",
      "第2步攻击：T1059: 攻击者利用PowerShell脚本在受害主机上执行恶意命令或脚本，进行远程控制、数据收集等操作。规则中检测到HTTP POST请求体内存在PowerShell命令输出特征，表明主机可能运行了PowerShell命令。  从08/27/2024-10:08:12开始到08/27/2024-10:08:12结束，共4条，其关键特征为HTTP POST请求|请求体内包含“Handles NPM(K) PM(K) WS(K)”等进程输出特征|与PowerShell命令输出特征一致；数据流向为内网到外网（$HOME_NET -> $EXTERNAL_NET）",
      "第3步攻击：T1072: 攻击者通过将特制的DLL副本（如wlbsctrl.dll）放置在目标系统指定位置（如C:\\Windows\\System32），通过利用服务（如SCM服务或IKEEXT服务）加载恶意DLL，实现横向移动或持久化。  从09/19/2024-21:47:02开始到09/28/2024-09:22:40结束，共11条，其关键特征为HTTP协议响应状态码为200，流量方向为服务器到客户端|HTTP中包含命令组合如‘stop IKEEXT’、‘copy wlbsctrl.dll’，涉及系统服务控制和DLL文件操作|特定文件路径和文件名特征（例如‘\\Windows\\System32\\wlbsctrl.dll’）明确指示目标系统与相关DLL"
    ],
    "此攻击链关联的原因": "基于TTP演进和时间顺序串联：利用Web服务漏洞（T1190, 初始访问）→PowerShell命令执行（T1059, 执行命令与脚本，行为上体现内网已被攻陷，具备远程控制能力）→横向移动与服务相关DLL投递（T1072）。尽管期间存在阶段跳跃，但整体逻辑及时间合理。MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过Web暴露应用漏洞进行初始渗透，获得系统入口。后续通过PowerShell命令，在主机内部收集信息及远程操作，体现控制权。最终通过上传DLL并操控系统服务实现横向移动或持久化，揭示连续性攻击链条，由初始入侵到权限维持的阶段递进。"
  },
  "chain_4418": {
    "alerts_info": [
      "第1步攻击：T1583.001: 攻击者利用代码托管平台（如GoogleCode）存储和分发可执行文件，提升恶意载荷隐蔽性与可获取性。  从08/24/2024-15:18:43开始到08/25/2024-09:35:05结束，共3条，其关键特征为HTTP请求路径包含'/svn/'，指向疑似版本管理系统目录|请求下载的资源为'.exe'可执行文件|目标主机（http.host）为'.googlecode.com'域，属于公开代码托管服务",
      "第2步攻击：T1539: 该规则检测到Win32/FakeJami Stealer 恶意软件将地理位置信息（Geo Info，如IP和国家信息）收集于受害终端上，属于主机敏感信息或配置数据的收集。  从09/20/2024-18:44:02开始到10/11/2024-11:56:12结束，共5条，其关键特征为TCP高位端口(1024以上)到内部任意端口，伴随伴有回传数据包（to_client）|数据包内容中固定模式：包含序列\"========================[Geo Info]========================\"|地理信息字段结构如\"Ip: x.x.x.x\\r\\nCountry: ...\"，整包长度小于150字节"
    ],
    "此攻击链关联的原因": "通过TTP时序（T1583.001供应链构建→T1539信息收集）及时间线递进关联，均出现恶意文件分发、后继敏感信息收集行为；中间存在行为间隙（MISSING_STEP），但整体语义连贯，行为特征吻合。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "此攻击链先利用代码托管平台分发恶意可执行文件，随后检测到Win32/FakeJami Stealer在受害主机上收集地理位置信息并回传。虽存在中间步骤缺失，但整体展现了从初始投递到敏感信息收集的典型APT行动流程。"
  },
  "chain_18525": {
    "alerts_info": [
      "第1步攻击：T1204: 该告警检测到通过HTTP协议的可执行文件传输，特征串涉及Windows API函数，表明可能存在通过利用CVE-2016-3219（MS16-051，Internet Explorer内存破坏漏洞）触发恶意代码执行的攻击。此攻击需要用户或浏览器主动解析恶意内容，属于用户执行场景。  从08/24/2024-15:45:17开始到08/25/2024-10:11:39结束，共3条，其关键特征为涉及HTTP协议，方向为外部到内部（EXTERNAL_NET -> HOME_NET）|检测到文件内容中包含多个Windows API函数名称：如SHGetKnownFolderPath、GetModuleFileName、QueryDosDevice、GetFileAttributes等|利用CVE-2016-3219，指向Internet Explorer内存破坏漏洞，通过HTTP下载可执行内容",
      "第2步攻击：T1027: 攻击者通过对恶意代码（如shellcode、JavaScript等）进行混淆（此处表现为Hex编码、NOP滑块等）来逃避安全机制和检测。该行为可使恶意payload难以被安全产品静态查杀或分析识别。  从09/18/2024-10:22:17开始到09/18/2024-10:22:17结束，共1条，其关键特征为HTTP协议流量，流向为从外部网到内部网客户端（to_client）|检测HTTP内容中的'\\x90'（十六进制）连续4次出现，表现为NOP SLED|涉及含有混淆的JavaScript shellcode，通常与exploit kit和漏洞利用相关",
      "第3步攻击：T1140: 此规则检测到CORESHELL（或自研downloader）恶意文档在下载其恶意有效载荷（‘/Bmnby.png’）的过程。该行为通常通过将有效载荷伪装为图片文件以逃避安全检测，实现传输过程的隐藏和混淆。  从09/21/2024-16:54:33开始到09/21/2024-16:54:33结束，共2条，其关键特征为HTTP GET请求，URI以'/Bmnby.png'结尾并前有8-12位字母/数字目录，例如 '/abcdefghij/Bmnby.png'|Accept请求头包含'*/*'，且Connection请求头为Keep-Alive|HTTP请求头中无Referer字段，符合无典型浏览器访问源的恶意流量特征",
      "第4步攻击：T1005: 恶意软件尝试收集设备的IMSI（国际移动用户识别码）等移动终端敏感信息，并准备进一步处理或泄露。  从10/24/2024-07:02:01开始到10/24/2024-07:02:01结束，共2条，其关键特征为HTTP协议POST请求|请求体中包含关键字<IMSI>，表明数据类型为移动用户识别码|从受害终端（HOME_NET）到外部网络（EXTERNAL_NET）的跨边界行为，且多次出现IMSI字样与相关XML特征",
      "第5步攻击：T1020: 本条规则检测到使用FTP协议的数据外泄行为，攻击者可能使用自动手段将敏感信息通过FTP协议渗出。文件名“CRHOMEPER.zip”显示该文件可能包含收集的敏感数据，被攻击者上传到外部服务器以规避网络边界防御。  从10/14/2024-23:29:51开始到10/14/2024-23:29:51结束，共3条，其关键特征为FTP协议通信，方向为内部->外部|FTP命令 STOR 用于上传名为CRHOMEPER.zip的文件|被检测流为已建立会话（flow:established,to_server），结合特定Machete家族恶意软件参考"
    ],
    "此攻击链关联的原因": "以TTP为主线，初始入侵（T1190, TA0001）利用IE漏洞入侵，JavaScript混淆规避检测（T1027, TA0005），再到恶意载荷下载与解混淆（T1140, TA0005），IMSI等敏感信息收集（T1005, TA0009）及后续FTP外泄（T1020, TA0010）。TTP时序完整，行为链语义吻合。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链由IE漏洞入侵发起，攻击者通过HTTP传输并混淆恶意脚本、拉取CORESHELL（或自研downloader）恶意载荷完成持久化，后对受害终端收集IMSI等敏感数据，最终通过FTP上传敏感压缩包数据，实现数据窃取全流程，从初始访问、规避检测到敏感信息外泄，一气呵成。"
  },
  "chain_18420": {
    "alerts_info": [
      "第1步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/24/2024-18:22:45开始到08/24/2024-18:52:16结束，共3条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第2步攻击：T1057: 攻击者通过远程命令执行或恶意程序调用 Windows 的 'tasklist'、'System Idle Process' 等相关命令，收集目标主机上当前运行的进程清单。这可以帮助攻击者了解受感染主机上正在运行的安全产品或其他对攻击有影响的关键进程。  从08/26/2024-09:14:03开始到08/26/2024-09:14:03结束，共3条，其关键特征为检测具体Windows进程名称（如svchost.exe, winlogon.exe, System Idle Process），表明获取详细进程清单。|数据包内容含有Windows命令提示符相关英文及十六进制指纹（如Image Name、Session Name等tasklist输出字段）。|该行为从内网主机向外部网络进行，出现于TCP建立且to_server方向，通常代表感染主机正在回传收集到的信息。",
      "第3步攻击：T1047: 检测到流量中包含WMIC命令提示符，表明攻击者很可能利用WMIC进行远程命令执行或管理目标主机，主要用于横向移动以获取对更多系统的访问权限。  从08/28/2024-20:33:40开始到08/28/2024-20:33:40结束，共2条，其关键特征为TCP协议，已建立会话|通信内容包含字符串 'wmic:root\\cli>'|通信方向为从内部网络到外部网络，提示为攻击响应流量，管理命令可能已被远程执行",
      "第4步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从09/03/2024-11:28:54开始到09/03/2024-11:28:54结束，共5条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第5步攻击：T1071.001: Raccoon Stealer 恶意软件通过 TLS SNI（Server Name Indication）字段与其 C2 域名（number1g.top）进行通信，试图建立命令与控制信道，实现对受害主机的远程指令下发和数据回传。  从09/28/2024-22:05:41开始到09/28/2024-22:05:41结束，共7条，其关键特征为TLS/SNI 字段中包含 number1g.top，说明客户端在 TLS 握手期间主动请求与该域名建立加密连接。|协议为 TLS，使用 Server Name Indication（SNI）方式指定 C2 指定域名。|流量方向为 $HOME_NET 出向 $EXTERNAL_NET，且流状态为 established, to_server，表现为本地终端主动与外部域名通信。",
      "第6步攻击：T1113: 该规则侦测到MICROPSIA恶意软件通过HTTP POST方式上传屏幕截图文件，表明攻击者在受害主机上采集屏幕内容以实施信息收集。  从10/17/2024-03:02:22开始到10/17/2024-03:02:22结束，共2条，其关键特征为HTTP POST方法，目标为外部网络|请求体中的Content-Disposition头指示上传名为‘kerna’的表单数据，并包含名为图片的JFIF头（JPEG文件特征）|请求缺少常见的Referer和User-Agent头部，表现出自动化/非浏览器客户端特征"
    ],
    "此攻击链关联的原因": "以TTP逻辑为主线：初期以计划任务维持持久性（T1053.005），随后进程信息收集（T1057），远程管理与横向移动（T1047），敏感凭证获取（T1555），通过C2隧道外传并进行信息泄露（T1071.001、T1113）。各阶段间时间递进，TTP行为语义连续。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链以高权限计划任务建立为起点，攻击者先收集进程情报，利用WMIC横向渗透并管理主机，后通过恶意工具窃取用户凭证，再通过C2通道实现命令与控制，最终采用多手段（TLS SNI、HTTP POST）将凭证及屏幕截图等敏感信息外泄，完整涵盖持久化、信息收集、横向移动、凭证窃取与数据渗出等主要攻击阶段。"
  },
  "chain_8010": {
    "alerts_info": [
      "第1步攻击：T1059.005: 该告警检测到攻击者向受害主机下发以VBScript脚本形式实现的恶意载荷，属于使用VBScript脚本在受害主机上实现恶意代码执行的行为。  从08/24/2024-20:03:55开始到08/24/2024-20:03:55结束，共3条，其关键特征为HTTP响应码为200，且流向为外部主机到内部主机（established, to_client）|HTTP返回内容中包含 language=\"VBScript\"，表明是VBS脚本文件|脚本数据包含.open \"GET\",，暗示脚本内容具有网络交互能力，可能用于后续C2通信或二次载荷下载",
      "第2步攻击：T1055.002: 该告警检测到Win32/Meterpreter shellcode或payload通过会话传输到主机，典型用于Metasploit等工具远程植入并执行驻留型恶意代码，属于进程注入或远程payload投递。  从08/25/2024-07:32:25开始到08/25/2024-07:32:25结束，共1条，其关键特征为流量为已建立TCP会话，方向为from_server，符合远程控制工具下发payload的常见流量特征。|内容特征匹配PE可执行文件头（‘MZ’和‘PE\\x00\\x00’），及特定的Windows DOS模式字符串，表明有效载荷为Windows可执行格式。|fast_pattern与flowbits设置配合累计上下文，减少误报并关联后续检测（如Meterpreter session activity）。",
      "第3步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从08/28/2024-01:14:18开始到08/28/2024-01:14:18结束，共1条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第4步攻击：T1573.001: 告警检测到Carbanak远控恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/05/2024-16:51:07开始到09/14/2024-03:09:06结束，共6条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第5步攻击：T1071.001: 该告警检测到恶意软件Throwback通过HTTP协议与服务器进行C2通信，伪装成合法的Web服务器响应（如200状态码与404 Not Found页面），此举用于隐匿于正常流量中，维持和远程控制端的通信。  从10/02/2024-17:19:15开始到10/02/2024-17:19:15结束，共3条，其关键特征为HTTP响应代码为200，代表表面看似合法通信流量|响应体包含<title>404 Not Found</title>和<h1>Not Found</h1>，模拟正常Web错误页面|响应内嵌有特征字符串<hidden stup1fy|20|，作为Throwback特有的信号或标识"
    ],
    "此攻击链关联的原因": "基于TTP时序推进（脚本执行-进程注入-计划任务持久化-加密C2通信-伪装Web通道），每步行为语义连贯，均可视为APT攻击链主要阶段，告警时间先后符合长时间持续渗透特征。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过VBScript脚本投递恶意代码（T1059.005），后利用Meterpreter shellcode进行远程进程注入（T1055.002），创建高权限计划任务维持持久性（T1053.005），并基于Carbanak远控通过定制SSL证书建立加密C2通道（T1573.001）。最终通过HTTP伪装404页面的方式稳固远控通道（T1071.001），表现出明显的隐匿与持久多阶段APT攻击流程。"
  },
  "chain_7849": {
    "alerts_info": [
      "第1步攻击：T1566.001: 本次告警检测到HTTP POST请求中携带可疑参数（如&formimage1=Bel%C3%A9p%C3%A9s），指向/jaguda.php路径。该行为说明攻击者通过鱼叉式钓鱼表单（通常为伪造的登录页面），诱导受害者提交敏感凭据信息，实现凭据收集。  从08/25/2024-08:32:22开始到08/25/2024-08:42:45结束，共3条，其关键特征为HTTP POST请求，目标路径为/jaguda.php|请求体中包含表单数据参数（如&formimage1=Bel%C3%A9p%C3%A9s）|指向外部网络（$EXTERNAL_NET），利用正常的HTTP流量模拟合法用户行为",
      "第2步攻击：T1095: 攻击者利用DNS协议进行通信，绕过常规的网络检测防御措施，进行远程命令与控制。此流量中查询的为.onion代理域名，表明恶意软件通过DNS协议尝试与C2基础设施建立连接。  从08/25/2024-12:18:34开始到08/25/2024-13:07:01结束，共7条，其关键特征为DNS协议，查询特定.onion代理相关的域名（如fizxfsi3cad3kn7v）|HTTP等高级协议缺失，体现为DNS层面命令与控制|疑似DGA算法生成的高熵域名",
      "第3步攻击：T1573.002: Cobalt Strike Beacon Reverse HTTPS 使用自定义伪造的证书与C2服务器建立TLS加密隧道，实现命令与控制流量隐蔽传输，逃避检测。  从08/25/2024-15:56:28开始到08/25/2024-15:56:28结束，共7条，其关键特征为使用TLS协议并分析证书subject包含 C=US, ST=、O=、OU=pixel, CN=、/emailAddress=pixel@|流量方向为 established, to_client，即攻击者向被控端下发C2有效负载|匹配特定的X.509证书特征（如OU和emailAddress为pixel相关）表明来自Cobalt Strike Beacon HTTPS反向连接",
      "第4步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从08/26/2024-10:08:54开始到08/26/2024-10:08:54结束，共2条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。",
      "第5步攻击：T1070.006: 恶意软件通过常见合法的GeoIP查询服务（如extreme-ip-lookup.com），在C2或数据泄露活动前欺骗安全防护系统，降低被检测的风险。  从08/27/2024-17:23:50开始到08/27/2024-17:23:50结束，共1条，其关键特征为HTTP GET /json/ 请求到 extreme-ip-lookup.com|特定User-Agent: Go-http-client/1.1，通常不是普通浏览器或标准系统组件|请求Accept-Encoding为gzip，配合其它字段匹配特定恶意软件实现"
    ],
    "此攻击链关联的原因": "根据TTP时序（鱼叉式钓鱼诱导凭据提交→DNS与HTTPS隧道C2建立→环境侦查与反虚拟化→反取证与防御规避），各阶段语义连续，时间相近，攻击载体与C2基础设施存在可能重叠。命令与控制和活动链条紧密结合，符合APT常见链路模型。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过鱼叉式钓鱼表单诱骗用户提交凭据，随后利用DNS及HTTPS加密信道对目标主机进行远程命令与控制，并以PowerShell脚本方式进行主机虚拟化侦查和环境探测，最后通过访问GeoIP服务进行反检测和防御规避，形成一条较为完整的APT攻击链。"
  },
  "chain_25292": {
    "alerts_info": [
      "第1步攻击：T1133: 攻击者尝试利用SExim/Postfix等邮件服务漏洞扫描方式通过远程访问和扫描针对IoT设备或Linux系统，寻找可被利用的远程服务。 从08/27/2024-13:01:55开始到08/28/2024-09:58:40结束，共4条，其关键特征为外部远程访问尝试或扫描|来源于 EXTERNAL_NET，目标为IoT设备或Linux服务器|SSH、SMTP等协议，流量方向为 to_server，具备已建立会话",
      "第2步攻击：T1204.002: 该告警检测到主机通过HTTP协议下载可疑可执行文件（bitcoin-miner.exe），符合攻击者利用钓鱼或其他手段诱导用户下载和执行恶意可执行文件的执行阶段战术。 从08/25/2024-09:15:24开始到08/26/2024-18:41:20结束，共3条，其关键特征为HTTP流量中uri包含/bitcoin-miner.exe，且使用正则表达式精确匹配下载请求|HTTP请求头部包含Connection字段，但不包含常见的Accept、Referer、User-Agent头，表现为非正常自动化下载流量|已知恶意文件（MSIL/Downcoin.B）的下载请求，对应hash: 6ad385f2b1161f2cff4e6ccc10e648b6",
      "第3步攻击：T1106: 攻击者可能使用含有恶意VBA代码的二进制流，通过HTTP响应分发给终端用户，使得目标系统在本地执行或解析恶意VBA内容，实现数据收集或准备进一步攻击。此技术常见于利用浏览器或文档载体执行恶意脚本。 从09/11/2024-23:56:14开始到09/15/2024-18:44:56结束，共3条，其关键特征为HTTP响应体中包含指令片段：'Dim BinaryStream'，'BinaryStream.Type = adTypeBinary'，'BinaryStream.Open'，'BinaryStream.Write '，表明尝试分发和写入二进制内容至目标主机。|触发流向为对客户端的HTTP流量，重点针对通过Web下载文档或脚本的场景。|通常与诱导邮件、恶意文档下载等初始访问攻击链相关联，配合二进制流实现Payload落地。"
    ],
    "此攻击链关联的原因": "依托TTP进展和行为语义关联：首先检测外部远程访问及扫描（T1133），随后发现可疑恶意文件下载及传输（T1204.002，辅助T1105），最后执行恶意VBA脚本（T1106）；符合初始访问-执行完整攻击路径。部分中间步骤缺失，推断连续性为合理逻辑链。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链起于外部针对IoT或Linux服务器的远程访问及扫描，紧接着诱导受害设备下载bitcoin-miner恶意程序，并通过自动化流程实现有效落地。随后，终端主机接收到携带VBA二进制流的恶意脚本并本地执行，可能进一步用于数据收集或后续攻击，表现为典型的初始访问到本地执行的攻击活动。"
  },
  "chain_11877": {
    "alerts_info": [
      "第1步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从08/25/2024-09:25:13开始到08/25/2024-11:03:12结束，共5条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第2步攻击：T1059: 攻击者利用PowerShell脚本在受害主机上执行恶意命令或脚本，进行远程控制、数据收集等操作。规则中检测到HTTP POST请求体内存在PowerShell命令输出特征，表明主机可能运行了PowerShell命令。  从08/26/2024-20:40:55开始到08/26/2024-20:40:55结束，共1条，其关键特征为HTTP POST请求|请求体内包含“Handles NPM(K) PM(K) WS(K)”等进程输出特征|与PowerShell命令输出特征一致；数据流向为内网到外网（$HOME_NET -> $EXTERNAL_NET）",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从08/27/2024-17:09:31开始到08/27/2024-17:09:31结束，共5条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1573: 检测到加密C2通信，利用加密或混淆信道隐藏与命令控制服务器的流量，规避安全检测。  从09/01/2024-13:55:45开始到01/13/2025-18:03:29结束，共10条，其关键特征为检测流量方向为 from $EXTERNAL_NET 到 $HOME_NET，双方端口均为1024以上，表明非标准服务端口通信。|TCP流量内容特征为以16进制31 36 00（十进制'16'字符串+NULL）作为消息前缀，且数据包大小为19字节。|正则表达式匹配通信前部分为0~13字节内ASCII可见字符，然后跟随1个不可打印字符，实现混淆数据开头检测。"
    ],
    "此攻击链关联的原因": "TTP阶段进展清晰：先通过Powershell脚本混淆/解压载荷（T1027），后远程执行恶意命令并开展主机信息收集（T1059），再通过启动项创建持久化（T1547.001），最终建立C2加密通信（T1573），事件语义和时间链条完整。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链先由Powershell脚本混淆和流量解压载荷开始，攻击者远程执行命令收集主机信息，随后利用Startup文件夹实现持久化，通过rundll32绕过安全防护，最后建立加密的C2通信，与XWorm家族特征吻合，完整覆盖投递、执行、持久化、C2全阶段。"
  },
  "chain_17499": {
    "alerts_info": [
      "第1步攻击：T1027.001: 检测到HTTP响应体中出现了Base64编码形式的WScript.Shell对象创建代码，常用于通过脚本混淆和编码的方式规避安全检测，将恶意代码嵌入或分发到目标环境。  从08/25/2024-10:18:43开始到08/25/2024-10:18:43结束，共1条，其关键特征为HTTP响应体包含Base64编码片段 ‘ID0gQ3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIi’|使用了WScript.Shell对象，表明意图执行系统命令或脚本|流量方向为来自外部网到内部网，数据通过HTTP协议传递",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从09/06/2024-03:52:05开始到09/21/2024-21:34:19结束，共3条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1573.001: 告警检测到攻击者利用RAT进行加密通信，通过自定义SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从10/12/2024-14:09:18开始到01/18/2025-19:00:35结束，共6条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "基于TTP时间顺序推进，首先发现脚本混淆与恶意代码（防御规避），随后出现DLL劫持（横向移动/持久化），最终检测到SSL加密C2通信（命令与控制）。虽然中间TTP有跳跃，整体行为链条与APT攻击流程一致。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该链描述攻击者先利用Base64编码和WScript.Shell对象进行脚本投递与防御规避，随后借助DLL劫持控制系统服务实现横向移动与持久化，最终通过定制SSL证书建立加密C2通道，指挥内网主机，实现典型APT多阶段渗透与远控流程。"
  },
  "chain_19616": {
    "alerts_info": [
      "第1步攻击：T1057: 攻击者通过远程命令执行或恶意程序调用 Windows 的 'tasklist'、'System Idle Process' 等相关命令，收集目标主机上当前运行的进程清单。这可以帮助攻击者了解受感染主机上正在运行的安全产品或其他对攻击有影响的关键进程。  从08/25/2024-14:05:10开始到08/25/2024-14:05:10结束，共2条，其关键特征为检测具体Windows进程名称（如svchost.exe, winlogon.exe, System Idle Process），表明获取详细进程清单。|数据包内容含有Windows命令提示符相关英文及十六进制指纹（如Image Name、Session Name等tasklist输出字段）。|该行为从内网主机向外部网络进行，出现于TCP建立且to_server方向，通常代表感染主机正在回传收集到的信息。",
      "第2步攻击：T1003: EQUATIONDRUG模块发起针对目标系统的凭证窃取行为，下载具有凭证抓取模块的恶意组件，目标是收集和导出受害者操作系统中的账号密码等敏感信息。  从09/12/2024-10:54:19开始到09/12/2024-10:59:11结束，共6条，其关键特征为HTTP协议流量，服务器到受害主机（from_server）|HTTP响应码为200，表示文件成功下发|HTTP返回数据包含关键词\"get-pass-offline|7c|\""
    ],
    "此攻击链关联的原因": "以主TTP链路递进和时间先后顺序关联。第一步为Windows进程信息收集（T1057），第二步为凭证窃取（T1003），TTP语义存在攻击信息流从侦察到数据窃取的合理演化，虽中间缺少明显持久化或权限提升环节（MISSING_STEP），但整体属于常见内网攻击路径。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "链条展现攻击者先通过收集主机进程清单（T1057），了解目标环境及安全防护状况，随后部署凭证抓取恶意模块（T1003），通过HTTP协议进行凭证窃取，反映出一次典型的由内部侦察到敏感数据窃取的攻击过程、中间可能包含隐写或权限提升但未被检测到。"
  },
  "chain_6714": {
    "alerts_info": [
      "第1步攻击：T1190: 该告警检测到了针对Microsoft Outlook利用CVE-2017-0199漏洞的攻击行为，攻击者会向目标用户发送含特制恶意RTF文件的邮件，一旦目标打开此邮件，邮件客户端便会通过漏洞远程执行恶意代码，实现初始访问。  从09/02/2024-21:54:07开始到09/02/2024-21:54:07结束，共1条，其关键特征为RTF文件中出现特定的关键字 'objautlink'|文件包含特定哈希值或序列 'e0c9ea79f9bace118c8200aa004ba90b'|正则匹配PCRE: /objdata[^}]+e0c9ea79f9bace118c8200aa004ba90b/，指示文档含有特制OLE对象数据",
      "第2步攻击：T1566.001: 此规则检测到CVE-2017-0199漏洞攻击，典型用于通过恶意Office文档（嵌入HTA文件）进行钓鱼欺骗，诱导目标打开并激活恶意代码，从而为攻击者获取初始访问权限。  从08/25/2024-14:12:23开始到08/25/2024-14:12:39结束，共5条，其关键特征为HTTP流量流向内网终端（$EXTERNAL_NET -> $HOME_NET）|Content-Type为application/hta（检测HTA文件传递）|内容中包含.expandedEnvironmntStrings与特定Microsoft Office宏相关字节特征，以及'|Menu\\Programs\\Startup\\'等可利用HTA绕过执行的痕迹",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从10/06/2024-09:37:19开始到10/06/2024-09:37:19结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1547.001: 检测到RAT后门下载其配置文件，这通常用于实现或维持该恶意软件的持久化。在目标主机上持续运行代理型木马程序，通常会通过配置文件下发命令和C2信息，保证木马自动启动与反复控制。  从01/15/2025-16:22:45开始到01/15/2025-16:22:45结束，共1条，其关键特征为HTTP协议传输，流量方向为服务器到客户端（from_server）|配置文件内容含有标志性字符串“@$@”，并紧接base64编码结构（详见正则规则）|敏感文件传递常出现在POST响应体或文件型URL路径"
    ],
    "此攻击链关联的原因": "依据信息流时间顺序及TTP行为进展（漏洞利用→钓鱼初始访问→持久化手法演进），语义层均指向以恶意文档攻击初始入侵，后持续驻留，部分环节因缺事件链MISSING_STEP，推测持续攻击链。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链起于利用CVE-2017-0199的恶意邮件与文档获取初始访问，随后通过HTA/宏脚本等机制执行payload，最终利用PowerShell脚本及Win32持久化组件加固驻留，实现木马配置下发和长期控制，表现出典型APT攻击阶段跃迁和持续隐蔽性。"
  },
  "chain_15897": {
    "alerts_info": [
      "第1步攻击：T1566.002: 该Snort规则检测到攻击者试图通过传递包含恶意Microsoft Equation Editor OLE组件（CVE-2017-11882）的RTF文档发动攻击，用以获得初始访问权。  从08/26/2024-09:12:10开始到08/26/2024-09:14:55结束，共5条，其关键特征为HTTP流量涉及RTF文档下载，流量中含特征流bit: ET.http.rtf.download|数据内包含OLE对象标识内容：objclass Equation.3|特定的ole内容特征和十六进制序列，如02CE020000000000C000000000000046，以及|31 63 30 30 30 30 30 30 30 32 30 30|等字节流",
      "第2步攻击：T1140: 该HTTP请求的URI部分出现了Base64编码（正则和content检测），表明恶意软件利用编码方式对通信流量进行混淆，以绕过防御检测。恶意文档（Maldoc）可能通过编码后的数据通报系统环境信息、执行结果或其他情报，帮助攻击方回避网络检测。  从08/27/2024-16:35:19开始到08/27/2024-16:35:19结束，共1条，其关键特征为HTTP GET请求，目的地为外部网络(EXTERNAL_NET)|URI中含有Base64编码字符串，且路径以/开头符合编码正则（/^[A-Za-z0-9+/]{4}*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/）|缺少Referer HTTP头部，表明是直接请求且符合恶意软件自动化通信行为",
      "第3步攻击：T1119: MSIL-based RAT或AcidBox变种通过远程命令自动枚举受害主机上的桌面文件，属于恶意软件自动化收集文件内容与信息的行为，以便后续窃取敏感数据。  从09/09/2024-12:41:03开始到09/15/2024-18:22:55结束，共6条，其关键特征为特定内容匹配：流量中包含'|44 65 73 6b 44 69 72|'（ASCII为'DeskDir'），表明列举桌面目录请求。|流量方向：检测到从外部网络(EXTERNAL_NET)发送到内部主机(HOME_NET)，且为已建立的会话流量。|针对已感染终端，表明主机或被控端正在与远程C2进行恶意数据交换。",
      "第4步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从10/07/2024-03:19:45开始到10/07/2024-03:19:45结束，共1条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。"
    ],
    "此攻击链关联的原因": "基于TTP顺序：鱼叉式钓鱼投递（T1566.002）后检测到流量混淆（T1140），再到主机信息收集（T1119），及最终持久化行为（T1547.001），多阶段行为时间线完整。部分阶段间存在跳跃，符合APT攻击的常见链路。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于通过带有CVE-2017-11882漏洞的恶意文档进行鱼叉式钓鱼，随后检测到恶意编码数据外发，表明可能进行初步通信与信息回传，进而出现主机桌面信息自动收集。最终通过PowerShell及rundll32结合Startup文件夹实现持久化，展示典型APT从入侵、信息收集到落地持久化的完整阶段。"
  },
  "chain_19835": {
    "alerts_info": [
      "第1步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从08/26/2024-11:08:23开始到08/26/2024-12:02:45结束，共4条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第2步攻击：T1552.001: 检测到通过HTTP协议的Basic身份验证方式，将用户凭证暴露在明文的Autodiscover请求中，可能会导致攻击者窃取用户的邮箱登录信息。这种凭据泄露通常由于配置不当，使得敏感凭证发送到攻击者控制的服务器。  从08/27/2024-09:37:18开始到08/27/2024-09:37:18结束，共2条，其关键特征为HTTP方法为GET|请求URI为/autodiscover/autodiscover.xml|Authorization头部中出现‘Basic’（Base64编码凭证）"
    ],
    "此攻击链关联的原因": "两条告警在时间上有序（均不足10天），存在攻击链逻辑：首先实现系统持久化（T1547.001），随后发生凭据明文泄露（T1552.001），形成攻击者入侵后利用持久化控制点进一步采集敏感信息的链条。事件特征之间语义连接明确，虽然其中缺少典型的信息收集或权限提升环节，但整体符合APT渗透路径。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "此次攻击链始于通过PowerShell脚本调用rundll32.exe将恶意程序添加至Windows启动目录实现持久化，随后检测到敏感邮箱凭据因配置不当以明文方式被泄露。攻击者先稳固对主机控制，再窃取关键信息，为后续横向移动与数据渗出提供条件。"
  },
  "chain_25380": {
    "alerts_info": [
      "第1步攻击：T1204.002: 此规则检测到MS16-007（CVE-2016-0016）漏洞相关的RCE攻击，该漏洞利用恶意Office文档加载恶意DLL，最终远程执行代码，属于用户驱动型执行的范畴。  从08/26/2024-12:25:18开始到08/26/2024-12:45:29结束，共4条，其关键特征为HTTP协议传输，方向为from_server，已建立连接|文件数据内容包含特征字符串'637c490d-eee3-4c0a-973f-371958802da2'，定位特定漏洞利用组件|流量上下文中流位设置ET.http.rtf.download，暗示通过RTF文档诱导下载",
      "第2步攻击：T1055: 检测到类似SHELLCODE的特征码（SGI NOOP sled），通常用于恶意代码注入目标进程，实现持久化或进一步攻击。攻击者利用shellcode尝试将恶意代码注入到受害系统的运行进程中。  从08/26/2024-13:07:06开始到08/26/2024-13:07:06结束，共1条，其关键特征为SGI架构下常见的NOOP sled字节序列，二进制为24 0F 12 4。|$EXTERNAL_NET（外部源）向$HOME_NET（内部目标）任意端口发起连接，端口通常为shellcode攻击目标端口。|协议类型为IP，无关具体上层协议，泛用性高，针对性检测NOP sled结构，表明攻击载荷中存在典型SHELLCODE模式。",
      "第3步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。  从08/26/2024-13:31:42开始到08/26/2024-13:31:42结束，共1条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第4步攻击：T1027: 该行为通过对 Cookie 字段使用 base64 编码（如 LSID 字段值），利用 HTTP 正常流量及资源（如伪装为 CSS 文件请求），隐藏恶意载荷或命令并规避检测。与 Sednit 的 loader 活动高度相关。  从08/27/2024-08:03:24开始到08/27/2024-08:03:24结束，共1条，其关键特征为HTTP GET 请求，URI 为 /mobile-ipad-home.css，模拟正常静态资源访问。|HTTP Cookie 字段以 'LSID=' 开头，后跟 base64 编码内容，疑似传递敏感或控制数据。|User-Agent 头部特征为 'Linux; ' 指向类 Linux 客户端；已知 md5 哈希与恶意流量相关。",
      "第5步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从08/29/2024-11:12:56开始到08/29/2024-20:42:23结束，共4条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第6步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从09/01/2024-06:29:12开始到09/01/2024-06:29:12结束，共1条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端",
      "第7步攻击：T1041: 该规则检测到恶意软件Win32/Wacatac.B!ml 通过已建立的会话向外部网络渗出数据，可能利用伪装的流量通道（如自定义HTTP头、特定二进制标志）隐藏其传输内容。  从10/31/2024-01:03:52开始到11/10/2024-10:22:31结束，共9条，其关键特征为TCP已建立会话，源自内部主机到外部网络（可能为数据出站通道）|连续出现三次特殊分隔符十六进制字符串|23 23 23|，作为流量标志|出现ZIP文件头（PK|03 04|）以及类似‘Google/Chrome/User Data/’的User-Agent/路径特征，具备伪装为浏览器数据的能力"
    ],
    "此攻击链关联的原因": "各告警呈现由初始RCE钓鱼投递、后续注入、implant落地与C2、数据混淆渗透、凭证与敏感数据窃取和外泄的完整TTP链，时间顺序合理，行为关联紧密。部分阶段存在典型威胁进程、持续性操作与数据外泄语义支撑。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "该攻击链始于恶意Office文档RCE利用（钓鱼/下载），攻击者利用注入与植入implant，建立C2通信并对攻击流量进行混淆隐藏。主机随后被用于抓取凭证、敏感数据，进而窃取系统凭据与导出数据。最后数据通过混淆和隐蔽通道流出，体现了经典的持久化、隐侦查APT攻击流程，覆盖投递、植入、横向移动、信息收集及外泄全阶段。"
  },
  "chain_17134": {
    "alerts_info": [
      "第1步攻击：T1203: 检测到针对Adobe Flash远程执行漏洞CVE-2018-4878的攻击行为。该攻击通常通过精心构造的文档或恶意网页利用Flash漏洞，实现对目标系统的初始访问。这类攻击常见于APT攻击链的初步渗透阶段。 从08/27/2024-07:24:31开始到08/27/2024-07:46:23结束，共3条，其关键特征为TLS流量中使用的服务器证书subject字段为CN=www.falcancoin.io，表明与可疑服务端建立加密会话。|流量方向为外部到内部（$EXTERNAL_NET -> $HOME_NET），目标为本地客户端。|关联CVE-2018-4878漏洞",
      "第2步攻击：T1071.001: 攻击者利用TLS协议通信，并通过恶意域名（如通过TLS SNI字段中的database-files.com）建立与外部基础设施的加密通信通道，以实现远程命令与控制。 从10/04/2024-10:33:54开始到01/13/2025-03:35:10结束，共31条，其关键特征为检测到TLS SNI字段含有恶意域名（.database-files.com）|通信方向为内网客户端到外网服务器（$HOME_NET -> $EXTERNAL_NET）|使用TLS协议建立加密流量，难以通过内容明文检测（基于SNI域名特征触发）"
    ],
    "此攻击链关联的原因": "以TTP为主线推理，T1203（初始入侵/利用漏洞）到T1071.001（C2通信）,时间序列合理，均为TLS流量且存在APT相关特征。两个阶段间虽有时间跨度大，符合APT攻击链长时间潜伏特征。存在POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过Adobe Flash远程溢出漏洞（T1203）实现对内网主机的初始渗透，利用伪造SSL证书隐蔽入口行为，随后经过一段潜伏，在约230天后通过外部C2域名通信（T1071.001）与恶意基础设施实现远程控制，展现典型APT攻击链条的隐秘入侵与指挥控制阶段。"
  },
  "chain_20802": {
    "alerts_info": [
      "第1步攻击：T1566.001: 此规则检测到CVE-2017-0199漏洞攻击，典型用于通过恶意Office文档（嵌入HTA文件）进行钓鱼欺骗，诱导目标打开并激活恶意代码，从而为攻击者获取初始访问权限。  从08/27/2024-08:16:23开始到08/27/2024-08:28:46结束，共3条，其关键特征为HTTP流量流向内网终端（$EXTERNAL_NET -> $HOME_NET）|Content-Type为application/hta（检测HTA文件传递）|内容中包含.expandedEnvironmntStrings与特定Microsoft Office宏相关字节特征，以及'|Menu\\Programs\\Startup\\'等可利用HTA绕过执行的痕迹",
      "第2步攻击：T1027: 该告警检测到通过HTTP传输的，应答内容中包含使用VBA/Subdoc.B恶意载荷的混淆特征。攻击者常对恶意代码进行混淆，以规避安全检测及分析。  从08/29/2024-13:54:18开始到08/29/2024-13:54:18结束，共3条，其关键特征为HTTP响应状态码为200，表示文件成功下发。|Content-Type头为text/plain，掩盖可执行或脚本型内容本质。|响应体中包含特定混淆关键字（如System.Text.Encoding::UTF8.GetString、System.Convert::ToInt32等）及PCRE规则匹配到的混淆payload格式。",
      "第3步攻击：T1518.001: 该告警检测到PowerShell脚本通过WMI查询（SELECT * FROM AntiVirusProduct）来识别受害主机上已安装的防病毒产品信息，这通常用于攻击者了解受害环境中所部署的安全防护措施。  从09/11/2024-16:32:48开始到09/14/2024-19:20:12结束，共2条，其关键特征为HTTP协议响应中带有200状态码，表示成功的下载操作|HTTP内容包含SELECT * FROM AntiVirusProduct，表明WMI查询本地防病毒产品信息|出现.Net.WebClient与.Download，指示通过PowerShell远程下载行为",
      "第4步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从10/06/2024-06:45:55开始到10/06/2024-06:45:55结束，共4条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递"
    ],
    "此攻击链关联的原因": "告警以T1566.001钓鱼文档初始访问为起点，经T1027恶意载荷混淆传递，T1518.001环境探测与T1053.005计划任务建立，遵循MITRE TTP进展且时间链条连续。辅助TTP分析强化载荷下发与命令执行阶段，行为语义相符，链路合理。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过带有CVE-2017-0199漏洞的钓鱼Office文档获取初始访问，随后利用HTTP混淆传递恶意载荷，借PowerShell与WMI进行环境防护信息探测，最终通过schtasks创建高权限计划任务以实现持久化，展现了完整的渗透、落地、侦察到驻留攻击链。"
  },
  "chain_16571": {
    "alerts_info": [
      "第1步攻击：T1195.002: 通过篡改合法应用的供应链环节，攻击者将恶意代码植入了3CX官方分发的软件更新，从而使受害者在正常安装或更新过程中被动感染恶意负载，实现初始访问。  从08/27/2024-08:22:13开始到08/27/2024-08:26:54结束，共3条，其关键特征为检测到具有特定User-Agent的HTTP流量(Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.128 Safari/537.36)，该特征与3CX后门通信特征高度一致|HTTP流量方向为‘内部主机到外部网络’，重点监控已建立到服务器的会话|请求体长度（bsize:116）为独特识别3CX攻击链流量的显著特征，可作为区分正常流量与恶意行为的关键指标",
      "第2步攻击：T1090.003: 攻击者可能通过访问Tor隐藏服务（例如，tordevice.ch或其子域名）建立多级代理通信。这可以帮助攻击者规避流量监控，实现与受控主机的匿名通信。  从09/24/2024-03:52:41开始到09/24/2024-03:52:41结束，共2条，其关键特征为DNS协议通信，查询内容包含 \".tordevice.ch\"|终止于以.tordevice.ch结尾的域名（典型Tor代理/隐藏服务标记）|流量方向是本地网络($HOME_NET)对外部（any），符合恶意流出或代理访问信号",
      "第3步攻击：T1095: 检测到内网主机对.light2mind.com的DNS查询，该域名疑似为通过Tor或匿名网络提供命令与控制通道的代理服务。攻击者可利用这类匿名化网络隐藏C2基础设施与通信内容，逃避防御检测。  从10/07/2024-19:05:09开始到10/07/2024-19:05:09结束，共5条，其关键特征为DNS查询内容为.light2mind.com，疑似.onion代理相关域名|源地址为内网($HOME_NET)，目标可能是Tor匿名代理服务用于隐藏C2|触发Snort规则的请求路径为特定后缀，nocase匹配、endswith限定，参考Tor匿名网络防御对抗",
      "第4步攻击：T1047: 检测到流量中包含WMIC命令提示符，表明攻击者很可能利用WMIC进行远程命令执行或管理目标主机，主要用于横向移动以获取对更多系统的访问权限。  从10/17/2024-14:11:13开始到10/17/2024-14:11:13结束，共1条，其关键特征为TCP协议，已建立会话|通信内容包含字符串 'wmic:root\\cli>'|通信方向为从内部网络到外部网络，提示为攻击响应流量，管理命令可能已被远程执行",
      "第5步攻击：T1047: 此告警检测到通过WMIC（Windows Management Instrumentation Command-line）命令在受害主机上运行命令。攻击者通常利用WMIC远程执行命令、收集信息或操作系统对象。这是一种常见的恶意软件手法，用于在受害系统上执行恶意payload或者查询系统信息。  从10/23/2024-21:04:10开始到10/23/2024-21:04:10结束，共1条，其关键特征为TCP已建立会话向外部服务器通信|数据包内容包含关键WMIC输出参数（如AccountExpires、AuthorizationFlags、BadPasswordCount）|流量目标为EXTERNAL_NET，目的系统为非本地网络",
      "第6步攻击：T1210: 攻击者尝试利用网络服务（如Web接口）中的漏洞（此处为Netgear路由器的CVE-2023-24749和CVE-2022-47208）在网络设备上执行未授权命令，实现对设备的远程控制和突破，从而实现横向扩展或进一步攻击。  从09/12/2024-12:18:22开始到09/12/2024-12:18:22结束，共3条，其关键特征为HTTP协议，目的端口为80|异常User-Agent头部，包含分号（;，0x3b），可能用于命令拼接|HTTP方法限定为GET，且payload末尾特征为分号包裹的字符串",
      "第7步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从12/11/2024-11:46:55开始到12/11/2024-11:46:55结束，共2条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第8步攻击：T1048.002: 检测到通过HTTP POST请求方式，将可疑的压缩(zip)文件（文件名包含google_chrome_default_，如cookie、ccdata、logins等）外发到外部网络。这通常是敏感数据（如浏览器数据、凭证等）被压缩后通过HTTP协议偷偷传出到攻击者服务器的典型方式。  从12/25/2024-21:50:03开始到12/25/2024-21:50:03结束，共2条，其关键特征为HTTP POST请求，目的地为外部网络|请求体为form-data格式，以及存在 Content-Disposition 字段，filename后缀为 .zip|请求体中包含 'google_chrome_default_' 字样，以及ZIP压缩文件头（PK），且文件名符合如 logins、ccdata、cookie 等类型",
      "第9步攻击：T1573.001: 攻击者可能通过加密的TLS通道进行命令与控制。TLS SNI 字段中出现.burpcollaborator.net，表明有流量正在利用该域进行后门或C2通信，常见于安全测试或攻击场景。  从11/28/2024-00:35:21开始到11/28/2024-00:35:21结束，共3条，其关键特征为TLS协议，SNI字段包含.burpcollaborator.net|通信方向为内网($HOME_NET)到外部网络($EXTERNAL_NET)|流量已建立且指向服务器端",
      "第10步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从02/10/2025-09:23:16开始到02/10/2025-09:23:16结束，共2条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第11步攻击：T1555.003: 该告警检测到MSIL/ChromePasswordDump.A恶意软件尝试通过与C2（命令与控制）通信的HTTP POST请求发送窃取的浏览器存储的凭证和敏感数据，属于直接的浏览器凭证窃取行为。  从02/02/2025-16:34:51开始到02/02/2025-16:34:51结束，共1条，其关键特征为HTTP POST请求方式（http.method: POST）|请求体中包含字段：fname=、&encabezado=、&data=、&process=，表明固定格式的数据上报结构|告警分类为凭证窃取（classtype: credential-theft），指向Chrome等浏览器账户信息的盗取",
      "第12步攻击：T1048.003: 攻击者利用电子邮件协议（如SMTP）将被窃取的数据通过普通非C2信道发送出受害网络。该规则命中表明恶意软件BadPasta通过SMTP协议发送信息到外部目标。  从01/13/2025-07:42:18开始到01/13/2025-07:42:18结束，共2条，其关键特征为SMTP协议，流向为内网主机向外部主机发送数据|邮件主题包含'Ip Add'关键字，疑似传递被控主机网络信息|邮件正文内容特征为'\\r\\n\\r\\nSVCju'，且与已知恶意软件BadPasta相关（有指定MD5参考值）",
      "第13步攻击：T1036.005: 该告警表明恶意流量伪装为合法的POST请求，并使用类似于常见Web应用接口的路径（如.php?type=）以及文件传输格式，试图绕过安全检测。通过不带常见HTTP头（如User-Agent、Referer、Accept）进一步避免被检测。  从02/15/2025-14:44:03开始到02/15/2025-14:44:03结束，共1条，其关键特征为HTTP POST请求，URL路径包含.php?type=，且参数有&file=和&software=|请求体包含multipart/form-data内容（Content-Disposition: form-data; name=\"file\"; filename=\"…\"），疑似上传文件行为|HTTP头字段缺失常见字段（User-Agent、Referer、Accept），为绕过检测而定制"
    ],
    "此攻击链关联的原因": "基于供应链初始访问（T1195.002）起，后有匿名代理通信（T1090.003/T1095）、后门控制、远程命令（T1047）、漏洞利用横向移动（T1210）、持久化计划任务（T1053.005）、数据收集与外传，以及Chrome凭证、按键、邮件外泄等TTP时序链。辅助以时间推进、行为语义和相关TTP描述贯通。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链始于3CX供应链漏洞实现初始访问，随后通过Tor匿名服务建立外部通信及命令控制，利用远程执行（WMIC）、横向漏洞利用，植入持久化任务，盗取浏览器及账户凭证，并通过HTTP/TLS/SMTP等多通道外传收集的数据。多阶段TTP进阶、匿名通道和多样数据泄漏展现出高级持续性威胁，从渗透、横向、持久化到信息窃取与外泄全链路贯通。"
  },
  "chain_24064": {
    "alerts_info": [
      "第1步攻击：T1140: 告警检测到通过HTTP通道传输的Base64编码PE文件，攻击者通常采用编码对载荷（如PE文件）进行混淆，以绕过安全检测。此行为符合MITRE ATT&CK中T1140的防御规避战术。  从08/27/2024-08:36:04开始到08/27/2024-08:36:04结束，共1条，其关键特征为HTTP协议流量，方向为从外部到内网（to_client）。|file_data内容以Base64编码的MZ头（TVqQA）开头，表明为PE（二进制可执行文件）上传。|关联Pastebin简短HTTP请求特征，存在特定正则匹配及流量标记（flowbits:isset,ET.Terse.Pastebin）。",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从08/30/2024-11:41:23开始到09/01/2024-05:06:56结束，共3条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1003.001: 告警检测到SMB流量中传输了由凭证提取工具procdump.exe相关模块，该工具常用于从LSASS等内存中提取凭证。攻击者通常在获取目标主机的访问权限后，使用procdump导出LSASS进程内存，再进行密码哈希分析，从而进行后续横向移动或提权。  从09/17/2024-18:15:09开始到10/03/2024-09:38:11结束，共6条，其关键特征为TCP 139 或 445 端口（SMB协议）|SMB数据包包含特定字节序列：|FF|SMB|a2||SMB流量中出现文件名字符串：procdump.exe",
      "第4步攻击：T1021.001: 该规则检测SMB（端口139/445）上的SMB横向工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从11/20/2024-01:55:22开始到01/16/2025-07:19:35结束，共6条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'疑似为定制工具或常规SMB流量处理。"
    ],
    "此攻击链关联的原因": "基于TTP阶段进展和时间序列，从HTTP编码PE传输（T1140）到DLL劫持（T1574.002），随后凭证提取（T1003.001，此处已改为procdump.exe）再横向移动（T1021.001）。部分阶段间存在POTENTIAL_GAP、MISSING_STEP，但整体行为与常见攻击链条一致。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链以编码混淆的PE文件传输作为起点，继而通过DLL劫持控制系统服务，实现持久化。之后攻击者利用凭证导出工具procdump.exe在内网导出和提取凭证，最终检测到自研SMB横向工具相关流量，整体反映APT横向渗透、提权及扩展控制的完整过程。"
  },
  "chain_17633": {
    "alerts_info": [
      "第1步攻击：T1566: 攻击者通过构建恶意仿冒页面诱骗用户提交敏感信息，实现对受害者的初始访问。本规则检测到用户向伪造的Banco do Brasil网站提交数据，系典型钓鱼行为。  从08/27/2024-09:46:14开始到08/27/2024-09:53:40结束，共5条，其关键特征为HTTP协议POST方法，流向外部（to_server）|POST请求体包含特定参数：&xmxexlxaxoxaxgx=、&xmxexlxaxoxcxtx=、&xmxexlxaxoxcxlx=|告警元数据显示目标为Web浏览器客户端，触发点为用户凭据提交",
      "第2步攻击：T1078.001: 攻击者利用 SolarWinds Web Help Desk 的硬编码凭证（默认帐户）尝试对系统 authentication 进行绕过或非法访问，获取后台或敏感资源控制权。  从09/08/2024-16:43:11开始到09/08/2024-16:43:11结束，共1条，其关键特征为HTTP POST 方法，针对 /helpdesk/assetReport 路径|请求体带有 select、password 等敏感关键词，暗示数据库操作与凭证行为|Content-Type 为 text/plain，非标准 API 格式，具有绕过应用检测的意图",
      "第3步攻击：T1068: 攻击者利用CVE-2017-12636漏洞通过向CouchDB的/_config/query_servers/cmd接口发送经过精心构造的PUT请求，以提权为管理员，用于后续控制系统。  从09/10/2024-19:19:36开始到09/10/2024-19:19:36结束，共1条，其关键特征为HTTP请求方法为PUT，针对CouchDB配置接口（/_config/query_servers/cmd）|HTTP头中包含Authorization: Basic，试图认证进行敏感配置操作|HTTP请求体以引号（' 或 \"）开头，通常是用于注入恶意命令",
      "第4步攻击：T1542.001: 检测到疑似GrayFish启动活动，此Bootkit通过UEFI/ESP分区实现持久化，确保恶意代码在主机重启后继续运行。  从09/14/2024-09:24:08开始到09/14/2024-09:24:08结束，共1条，其关键特征为HTTP GET方法，URI为/Heart.aspx?ti=，并带有&tn=、&tg=、&tv=等参数|缺少Referer字段，表明为恶意自动化请求而非正常浏览器行为|流量方向为从受害主机l ($HOME_NET) 至外部网络 ($EXTERNAL_NET) 的服务器",
      "第5步攻击：T1027: 该流量涉及使用非标准的HTTP请求方式传输敏感信息，包括设备信息的exfil，用于规避安全监控与检测。特定的路径和编码内容表明恶意应用正有意隐藏其行为过程。  从09/21/2024-02:11:56开始到09/21/2024-02:11:56结束，共2条，其关键特征为HTTP POST方法，指向/dataLog/addLog路径|User-Agent为okhttp/，通常见于Android恶意应用|HTTP请求体含有特殊数据结构（如dataType字段），且请求头无Referer",
      "第6步攻击：T1059.006: 该告警检测到通过JNBridge组件存在Java反序列化漏洞的利用行为，攻击者试图通过Java反序列化远程执行特定命令，属于在目标主机进行初步代码执行。  从10/03/2024-17:21:42开始到10/05/2024-10:33:58结束，共5条，其关键特征为流量为TCP协议，发往HTTP服务器|消息体以JNB开头，符合JNBridge组件协议特征|存在.exec(指令)调用尝试，表明试图实现远程命令执行",
      "第7步攻击：T1021.002: 该告警检测到通过SMB协议在445端口上传输powershell命令，通常表明攻击者正在利用SMB远程服务进行横向移动，以在网络内其他主机上远程执行命令或脚本。  从10/19/2024-21:21:15开始到10/19/2024-21:21:15结束，共2条，其关键特征为流量为SMB协议，目标端口为445，表明为Windows远程文件共享服务。|检测内容包含Unicode格式的“powershell”，提示远程命令执行载荷涉及Powershell脚本。|网络会话方向为to_server，说明客户端正向服务器发起可能的攻击行为。",
      "第8步攻击：T1112: 攻击者通过 GrayFish 攻击框架的 stdapi_registry_create_key 创建或修改 Windows 注册表项，以实现持久化、权限提升或隐藏恶意行为，对系统安全配置产生影响，从而躲避检测并保持对受害系统的控制。  从10/26/2024-03:14:34开始到10/26/2024-03:14:34结束，共1条，其关键特征为TCP协议，流向客户端流量（to_client, established）|数据包内容包含关键词 'stdapi_registry_create_key'，与GrayFish的注册表操作模块特征吻合|触发条件为GrayFish与被控端交互，指向主动注册表操作",
      "第9步攻击：T1048: 通过非标准协议（在此案例中为SMTP邮件协议）向外发送感染信息，实现数据（或者状态）的外泄。此规则检测的是恶意Android软件通过SMTP通道向攻击者报告感染情况。  从11/14/2024-15:27:49开始到11/16/2024-08:40:17结束，共6条，其关键特征为检测到TCP流向外部SMTP服务器（端口25,587）|邮件Subject头部包含特定的Base64编码中文内容，表征感染状态|邮件格式包含标准MIME头，通常自动构造，含Android木马独有格式化内容"
    ],
    "此攻击链关联的原因": "整个链条展现从钓鱼初始访问（T1566）到凭证滥用（T1078.001）、漏洞提权（T1068）、UEFI启动持久化（T1542.001）、混淆与外联（T1027）、远程命令与横向移动（T1059.006、T1021.002）、持久化操作（T1112），最终以SMTP外泄（T1048）收尾；时间线、TTP行为及高相关的APT攻击语义支撑串联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者通过网络钓鱼诱骗用户泄露凭证后，利用默认凭证进行系统访问，并通过CouchDB和JNBridge等服务漏洞提权和远程命令执行。其后通过Bootkit和注册表持久化，巧妙混淆流量及多协议与C2通信，横向移动控制更多主机，最终通过SMTP通道外泄敏感信息，体现了完整的APT攻击生命周期。"
  },
  "chain_3061": {
    "alerts_info": [
      "第1步攻击：T1027: 该规则检测到通过HTTP POST和多层结构（FormData，二进制ZIP包）隐蔽发送文件，意图规避内容监测和安全设备的检测。这是Malware特有的数据封装与传输技巧，能够躲避简单的明文检测。  从08/27/2024-10:18:00开始到08/27/2024-10:18:00结束，共3条，其关键特征为HTTP POST请求，目标URI结尾为.php（通常用于C2）|POST请求体为form-data类型，上传文件名含有.zip及PK文件头标识（表示ZIP压缩包），内部含system.txt|HTTP头部不含Referer和User-Agent，意图规避常规安全分析",
      "第2步攻击：T1059: 攻击者通过SimplexTea远控马远程执行命令，进行目标系统控制，此技术为远控工具远程下发命令或脚本。  从09/10/2024-22:02:31开始到09/10/2024-22:02:31结束，共5条，其关键特征为TCP协议已建立连接|数据包12字节偏移处包含SimplexTea典型模块特征字符串|流量方向为外部主机到内部主机，表明控制指令或命令在流入内部主机",
      "第3步攻击：T1059.003: 该告警检测到与Microsoft Windows命令提示符（cmd.exe）相关的典型返回内容，表明攻击者已在受害主机上成功打开命令行shell，通过cmd.exe进行系统命令执行，从而达到规避防御、提升权限或后续渗透目的。  从09/14/2024-09:34:45开始到09/14/2024-09:34:45结束，共4条，其关键特征为数据包大小小于200字节（dsize:<200），符合命令行回显输出的特征。|检测内容含有'微软公司版权所有'、'[Version'等cmd.exe界面典型输出。|定位到HTTP或TCP流量中出现Windows命令行界面的特征字符串，表明本地系统已通过shell被远程访问。",
      "第4步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被检测到。  从09/25/2024-07:20:03开始到10/02/2024-15:12:57结束，共3条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第5步攻击：T1574.002: 攻击者利用 Microsoft PowerPoint 存在的不安全库加载漏洞（CVE-2011-3396），通过诱导程序加载恶意 DLL，实现代码执行并规避传统检测防护。  从10/21/2024-11:53:39开始到10/21/2024-11:53:39结束，共2条，其关键特征为检测到对外 445 端口（SMB）流量。|SMB 报文中包含特殊标识符|FF|SMB|a2|。|传输数据中存在目标 DLL 名称 'pp4x322.dll'，指示尝试加载该库。"
    ],
    "此攻击链关联的原因": "以TTP推进及时间顺序为主轴，从恶意流量隐蔽传输（T1027）到远控工具命令执行与Shell访问（T1059/T1059.003）、计划任务持久化（T1053.005）、最终通过DLL劫持实现提权（T1574.002）。TTP序列与行为紧密衔接，覆盖多阶段攻击链。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP POST隐蔽传输数据至C2（T1027），随后利用远控工具实现远程命令执行（T1059），并在受害主机上成功打开cmd shell（T1059.003）。之后，攻击者通过SMB命名管道建立持久化（T1053.005），最终利用PowerPoint DLL侧载漏洞完成权限提升（T1574.002），展现出多阶段、持续渗透与隐蔽操作的APT攻击流程。"
  },
  "chain_6581": {
    "alerts_info": [
      "第1步攻击：T1027: 该告警检测到通过HTTP传输的，应答内容中包含使用VBA/Subdoc.B恶意载荷的混淆特征。攻击者常对恶意代码进行混淆，以规避安全检测及分析。  从08/27/2024-10:35:24开始到08/27/2024-10:39:17结束，共3条，其关键特征为HTTP响应状态码为200，表示文件成功下发。|Content-Type头为text/plain，掩盖可执行或脚本型内容本质。|响应体中包含特定混淆关键字（如System.Text.Encoding::UTF8.GetString、System.Convert::ToInt32等）及PCRE规则匹配到的混淆payload格式。",
      "第2步攻击：T1543.003: 检测到通过批处理脚本使用sc create命令创建内核模式驱动服务(.sys驱动)，意在获得或维持系统持久控制权。攻击者经常利用服务安装来自动重启恶意代码或实现高权限运行。  从10/30/2024-04:12:56开始到01/07/2025-16:31:09结束，共4条，其关键特征为HTTP响应状态码为200，表明目标成功返回了数据流|批处理脚本包含'sc create'和'type=kernel'，说明在创建内核驱动服务|.sys 文件后缀出现，进一步明确为驱动文件；后续还有'sc start'，显示驱动被尝试启动",
      "第3步攻击：T1573: 该告警检测到使用CSPY Downloader等通过自定义（XOR）加密的信息进行通信，属于典型的恶意软件C2流量隐蔽技术。  从09/15/2024-15:21:14开始到09/15/2024-15:21:14结束，共1条，其关键特征为TCP协议，流量来自服务器方向 (from_server)|特定Payload特征：前7字节为 |fe d6 57 37 c9 50 f7|，疑似XOR加密命令|payload内容特征：前0~13字节为可打印字符，随后紧跟非可打印字符，表明混淆/加密特征",
      "第4步攻击：T1560: 攻击者在数据窃取或 exfil 前，将收集的数据打包成常见压缩格式（如 .zip 文件），以规避安全检测。这通常出现在数据准备出站时，用于避开协议、内容等检测。  从09/02/2024-23:22:39开始到09/02/2024-23:22:39结束，共1条，其关键特征为HTTP POST方法，内容带有Content-Disposition: form-data; name=*.zip|zip文件魔术头（PK）位于HTTP请求体内，文件名包含screen.|支持图片类型（jpeg/bmp/png）表单名混淆，多用于伪装正常上传请求"
    ],
    "此攻击链关联的原因": "以T1027混淆载荷初始投递为起点，后续出现内核驱动服务创建（T1543.003）实现持久化， 用RAT变种流量指示C2加密通信（T1573），最终发现被打包数据外渗（T1560）。各告警TTP相符且时间序列合理，场景高度关联。T1573使用了其辅助TTP（T1027）与链路前期告警有关联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过HTTP混淆载荷（T1027）投递攻击，随后利用批处理脚本创建内核驱动服务（T1543.003）以获得持久化和高权限。受害主机随后与C2通信，采用加密RAT流量（T1573）进行隐蔽命令与控制，最终将敏感数据打包压缩并通过HTTP协议进行外渗（T1560）。各阶段行为衔接紧密，显示完整渗透-控制-窃密链路。"
  },
  "chain_10802": {
    "alerts_info": [
      "第1步攻击：T1112: 攻击者通过VBS脚本向受害主机的注册表写入值，降低Office安全级别（如设置VBAWarnings），从而启用所有Office宏，绕过安全保护机制，为后续宏恶意代码执行提供条件。  从09/10/2024-06:33:58开始到09/10/2024-06:33:58结束，共2条，其关键特征为HTTP流量，响应码为200，文件数据中包含 '.RegWrite \"HKCU\\Software\\Microsoft\\Office\\...\\VBAWarnings',1'|VBS脚本通过'WScript.Shell.RegWrite'方法修改注册表路径，指定Office宏安全设置|针对Windows客户端（XP/Vista/7/8/10/Server等），可能作为钓鱼传播和宏恶意代码投递链的一部分",
      "第2步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件持久化机制相关联。  从09/15/2024-17:50:24开始到09/15/2024-17:50:24结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道,TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段"
    ],
    "此攻击链关联的原因": "通过TTP时间顺序和行为语义关联：先利用脚本修改注册表（T1112，防御规避），降低Office宏安全等级，为后续攻击投递及持久化创造条件。随后通过SMB命名管道计划任务（T1053.005，实现持久化），二者可形成完整持续化链路。中间可能存在遗失环节（如初始访问），但整体TTP链条顺畅。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者先通过VBS脚本篡改注册表设置，降低宏安全防护，为恶意宏或脚本执行提供条件（防御规避）。接着利用计划任务和SMB命名管道建立持久化访问，实现长期控制与隐蔽通信，展现典型的持续渗透与后门植入攻击流程。"
  },
  "chain_1521": {
    "alerts_info": [
      "第1步攻击：T1566.002: 攻击者通过伪造的、看似合法的TLS SNI域名（如 enderssubmission-usdabid2023.com）诱导用户访问钓鱼站点，达到获取凭证或执行后续攻击目的。  从08/28/2024-10:33:21开始到08/28/2024-10:33:21结束，共1条，其关键特征为TLS协议特征，检测SNI（Server Name Indication）扩展字段|SNI域名以 enderssubmission-usdabid2023.com 结尾，意图伪装或误导目标用户|流量方向为内网主机主动访问外部主机 (to_server), HTTP请求为加密Web流量",
      "第2步攻击：T1204.002: 此规则检测到MS16-007（CVE-2016-0016）漏洞相关的RCE攻击，该漏洞利用恶意Office文档加载恶意DLL，最终远程执行代码，属于用户驱动型执行的范畴。  从09/04/2024-14:08:07开始到09/04/2024-14:10:11结束，共4条，其关键特征为HTTP协议传输，方向为from_server，已建立连接|文件数据内容包含特征字符串'637c490d-eee3-4c0a-973f-371958802da2'，定位特定漏洞利用组件|流量上下文中流位设置ET.http.rtf.download，暗示通过RTF文档诱导下载",
      "第3步攻击：T1059.001: 告警涉及Cobalt Strike Beacon，该工具主要通过命令行或PowerShell注入和操控Kerberos凭据实现持久化与凭证操作，适用于威胁在受害主机上执行Kerberos操作、提权等攻击活动。Cobalt Strike Beacon常被攻击者用于Windows系统上执行针对身份凭证的攻击。  从09/14/2024-08:27:09开始到09/14/2024-08:27:09结束，共5条，其关键特征为特定字符串匹配 - 'User32LogonProcesss'，为Cobalt Strike Beacon活动关键标识。|TCP协议，流向服务器，一般为命令与控制或凭证操作流量。|相关工具与攻击知名度高（FireEye、Cobalt Strike），常与域环境渗透、凭证滥用相关。",
      "第4步攻击：T1018: 检测到Windows nbtstat -r命令相关内容，说明主机可能正在枚举并解析NetBIOS名字服务，获取网络中其他主机的NetBIOS相关信息。这属于攻击者在内网中识别网络资源和其他主机的一种典型方式。  从10/21/2024-21:44:12开始到10/21/2024-21:44:12结束，共4条，其关键特征为检测到TCP流量出站，目标为EXTERNAL_NET|内容中包含“NetBIOS Names Resolution and Registration Statistics”，高度疑似nstat -r输出|内容还需连续出现关键字“Name”、“Type”、“Status”",
      "第5步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从01/15/2025-03:39:58开始到01/16/2025-15:13:21结束，共3条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端"
    ],
    "此攻击链关联的原因": "链路基于TTPs逻辑递进：钓鱼(Spearphishing—T1566.002)→用户诱导执行(RCE—T1204.002)→主机命令执行(Cobalt Strike/凭证操作—T1059.001)→内网发现(nbtstat—T1018)→凭据窃取(procdump—T1003)。时序较长，存在阶段性缺口。整体行为线索一贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击初始通过伪装SNI钓鱼引诱目标，随后利用恶意Office文档实现远程代码执行，入侵主机后执行命令及Kerberos票据操控。内网阶段通过NetBIOS枚举发现资源，最终利用procdump窃取凭据外发，展现典型初始访问、持久化、横向侦察、数据窃取等完整攻击链。"
  },
  "chain_19708": {
    "alerts_info": [
      "第1步攻击：T1210: 攻击者利用CVE-2020-1472（Zerologon漏洞）在Netlogon远程协议（MS-NRPC）中实现身份验证绕过，通过伪造认证数据，直接修改域控制器的计算机账户密码，从而获得高权限访问。该操作属于通过漏洞利用远程服务突破访问控制，典型表现为防御绕过。  从08/28/2024-17:53:23开始到08/29/2024-10:27:11结束，共3条，其关键特征为针对 Netlogon 协议的 TCP 流量（dcerpc.rpcnetlogon）|特定的数据包模式 (如 |05 00 00| 起始，|1e 00| 位于 offset 22，NetrServerPasswordSet2 全为零的认证挑战)|利用身份验证过程中的全0挑战响应包，满足 Zerologon 攻击特征（NetrServerPasswordSet2大量0字节）",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从09/06/2024-22:11:06开始到09/15/2024-11:33:44结束，共3条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1047: 此告警检测到通过WMIC（Windows Management Instrumentation Command-line）命令在受害主机上运行命令。攻击者通常利用WMIC远程执行命令、收集信息或操作系统对象。这是一种常见的恶意软件手法，用于在受害系统上执行恶意payload或者查询系统信息。  从09/25/2024-21:18:55开始到09/25/2024-21:18:55结束，共1条，其关键特征为TCP已建立会话向外部服务器通信|数据包内容包含关键WMIC输出参数（如AccountExpires、AuthorizationFlags、BadPasswordCount）|流量目标为EXTERNAL_NET，目的系统为非本地网络",
      "第4步攻击：T1555.003: 该告警检测到Win32/BrowserPassview恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从10/06/2024-09:37:21开始到10/06/2024-09:37:21结束，共1条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。",
      "第5步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从11/02/2024-14:27:44开始到01/19/2025-19:58:12结束，共5条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。"
    ],
    "此攻击链关联的原因": "以TTP时序为主线，先有Zerologon远程利用（横向移动）；后DLL劫持操作，进一步持久化和横移；再用WMIC获取用户信息，随后窃取凭证，最后进行环境检测。行为间虽存在阶段缺失，但整体TTP逻辑及时间序列连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先利用Zerologon漏洞横向突破域控，随后通过DLL劫持建立持久后门。紧接着使用WMIC收集敏感账户信息，提取浏览器凭证用于继续渗透和横移，最后实施虚拟化检测以避免被沙箱捕获。整个过程展现了从入侵、持久化、收集、凭证窃取到规避检测的完整高级威胁攻击链。"
  },
  "chain_14089": {
    "alerts_info": [
      "第1步攻击：T1140: 检测到HTTP请求URL中存在Base64编码且疑似恶意（字符串“aGFja2Vk”解码后为“hacked”），攻击者常使用Base64编码隐藏命令、有效载荷、或将恶意内容隐藏于通信之中，从而规避检测。  从08/29/2024-03:21:24开始到08/29/2024-03:22:09结束，共3条，其关键特征为HTTP请求的URL中出现Base64编码的字符串（例如“aGFja2Vk”）|HTTP请求未包含Referer头，常见于自动化工具、恶意流量或无Referer的攻击代码|通信方向为$HOME_NET发起至$EXTERNAL_NET，表示内部主机主动访问外部，可能为回连或数据外泄行为",
      "第2步攻击：T1574.002: 检测到攻击者通过DLL劫持技术（特别是针对Windows系统服务管理器SCM下的TSVIPSrv.dll文件）实现横向移动，引入恶意DLL，以劫持合法服务组件，获得目标系统权限。  从09/03/2024-11:42:18开始到09/03/2024-13:12:55结束，共5条，其关键特征为HTTP响应状态码为200，表示请求正常返回，流量方向为服务器到客户端。|检测到HTTP流量中包含命令：stop 服务、复制（copy）TSVIPSrv.dll至C:\\Windows\\System32\\TSVIPSrv.dll|文件路径和操作特征高度一致于已知的SCM服务相关DLL注入和劫持手法，指向TSVIPSrv.dll这一目标。",
      "第3步攻击：T1547.001: 攻击者通过在Windows的启动文件夹（如C:\\Start Menu\\Programs\\Startup\\）中放置恶意程序或快捷方式，使恶意程序在用户登录时自动执行，实现持久性驻留。此告警检测PowerShell脚本操作rundll32并利用Startup目录设置持久化。  从09/15/2024-21:08:39开始到09/15/2024-21:08:39结束，共2条，其关键特征为HTTP响应码为200，表明恶意payload成功下发。|文件流中包含CreateObject(\"Shell.Application\").ShellExecute调用，显示PowerShell脚本在调用Windows脚本宿主组件。|包含路径\\Start Menu\\Programs\\Startup\\，指示操作目标为Windows启动文件夹，结合rundll32.exe实现持久化。",
      "第4步攻击：T1059.001: 检测到恶意利用PowerShell在目标主机上执行脚本，通常用于攻击者下载与执行进一步恶意载荷，实现初步控制。  从10/07/2024-07:47:14开始到12/01/2024-16:32:44结束，共6条，其关键特征为HTTP响应码为200且Content-Type为text/html; charset=UTF-8|响应内容包含powershell并带有-NonInteractive参数|包含PowerShell语句：(Get-WmiObject -Class Win32_ComputerSystem).SystemType -match 和 (New-Object System.Net.WebClient)).DownloadString('http"
    ],
    "此攻击链关联的原因": "本链以TTP推进顺序为主，结合各告警行为语义及时间先后推理。首先出现Base64编码通信隐匿初步动作（T1140），后有DLL劫持横向移动（T1574.002），随后通过Startup目录实现持久化（T1547.001），最后检测到PowerShell代码执行（T1059.001）。部分TTP关联存在MISSING_STEP与POTENTIAL_GAP，且持久化与最终payload执行联系偏弱。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链涵盖数据隐匿传输、横向移动、持久化及最终远控执行。攻击者首先利用Base64编码隐藏通信和指令，继而通过TSVIPSrv.dll劫持实现服务权限提升及横向移动。随后在启动目录设置后门以维持持久访问，最终通过PowerShell在目标主机执行指令，下载与执行后续载荷，展现出典型的分阶段渗透与持久控制过程。"
  },
  "chain_17122": {
    "alerts_info": [
      "第1步攻击：T1566.001: 该告警检测到TLS流量中的SNI字段包含疑似钓鱼域名（.mylifemsde.com），属于钓鱼活动，攻击者通过诱导目标点击恶意链接获取初始访问权限。  从08/29/2024-08:12:33开始到08/29/2024-09:34:15结束，共5条，其关键特征为TLS SNI字段出现.mylifemsde.com（疑似钓鱼域名）|流量方向为内部主机访问外部网络（to_server）|协议为TLS，属于加密流量，内容隐蔽性强",
      "第2步攻击：T1204: 该告警检测的是通过HTTP响应对象传递恶意DLL，利用MS Office相关的DLL加载漏洞（CVE-2016-0016），需要用户打开受影响的文档，从而触发远程代码执行。这属于用户交互触发的执行技术。  从08/29/2024-16:01:22开始到08/29/2024-16:01:22结束，共1条，其关键特征为检测HTTP流量中恶意DLL文件特征值（magic number/指纹）：CB314187CC4E3B448948746B89595D20|通信方向为从互联网到企业内部（from_server,established），流入型威胁|利用CVE-2016-0016（MS Office DLL远程代码执行漏洞），通过文件数据部分触发",
      "第3步攻击：T1059.001: 检测到恶意利用PowerShell在目标主机上执行脚本，通常用于攻击者下载与执行进一步恶意载荷，实现初步控制。  从09/02/2024-12:26:17开始到09/03/2024-17:17:53结束，共6条，其关键特征为HTTP响应码为200且Content-Type为text/html; charset=UTF-8|响应内容包含powershell并带有-NonInteractive参数|包含PowerShell语句：(Get-WmiObject -Class Win32_ComputerSystem).SystemType -match 和 (New-Object System.Net.WebClient)).DownloadString('http",
      "第4步攻击：T1562.001: 攻击者尝试绕过Windows反恶意软件扫描界面（AMSI），以避免恶意Powershell脚本被检测到。该技术通过利用AMSI的缺陷或对其进行禁用，使得后续恶意行为可以隐蔽执行。  从10/03/2024-15:56:44开始到10/03/2024-15:56:44结束，共2条，其关键特征为HTTP流量中包含 '<script' 关键字，指示为含脚本的网页内容。|脚本内容中带有关键字 'powershell'，表明涉及Powershell命令调用。|脚本内存在base64编码字符串 'YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBk'（解码为'amsiInitFailed'，是尝试绕过AMSI的典型指标）。",
      "第5步攻击：T1059.005: 检测到通过HTTP传输的内容中，存在经过编码的VBS脚本，这种脚本通常用于在受害主机上执行恶意命令或加载其他恶意载荷，是直接利用脚本语言进行攻击执行的典型方式。  从09/05/2024-18:44:10开始到09/05/2024-18:44:10结束，共2条，其关键特征为HTTP协议内容，流量方向为服务端到客户端|检测到Base64编码字符串‘Q2xlYXJJbnRlcm5ldENhY2hlK’|Exploit Kit流量识别标记（flowbits:set,et.exploitkitlanding）",
      "第6步攻击：T1083: 该告警检测到RAT远控木马尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从09/07/2024-21:13:23开始到09/07/2024-21:13:23结束，共3条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与Windows平台的多版本RAT家族相关",
      "第7步攻击：T1021.001: 该告警检测到了恶意软件通过WMI（Windows Management Instrumentation）进行远程进程创建，实现横向传播与远程代码执行。WMI是常见的横向移动与远程命令执行手段。  从09/14/2024-10:27:43开始到09/17/2024-19:48:10结束，共7条，其关键特征为TCP流量，已建立连接，目标为受保护主机或服务器|内容中包含Unicode字符串Win32_Process和Create，表明涉及通过WMI创建进程|检测到regsvr32.exe参数用于加载DLL，说明有DLL注册和代理执行行为",
      "第8步攻击：T1547.001: 攻击者通过HTTP GET访问特定路径（/install.bak/），可能用于恶意软件安装或留存，利用启动项或脚本机制实现持久化。  从09/21/2024-07:40:33开始到09/21/2024-07:40:33结束，共1条，其关键特征为HTTP GET方法，访问特定路径 /install.bak/|User-Agent 为 'Mozilla/4.0'，缺失 Referer 头部|URI中包含/[0-9]{2}\\.html结尾的结构",
      "第9步攻击：T1112: 攻击者通过VBS脚本向受害主机的注册表写入值，降低Office安全级别（如设置VBAWarnings），从而启用所有Office宏，绕过安全保护机制，为后续宏恶意代码执行提供条件。  从10/08/2024-06:28:46开始到10/08/2024-06:28:46结束，共2条，其关键特征为HTTP流量，响应码为200，文件数据中包含 '.RegWrite \"HKCU\\Software\\Microsoft\\Office\\...\\VBAWarnings',1'|VBS脚本通过'WScript.Shell.RegWrite'方法修改注册表路径，指定Office宏安全设置|针对Windows客户端（XP/Vista/7/8/10/Server等），可能作为钓鱼传播和宏恶意代码投递链的一部分",
      "第10步攻击：T1056: 该规则检测来自已感染主机到外部的恶意HTTP GET请求，特征明显为Exploit Kit（漏洞利用包）相关回传请求，经常用于收集受害主机插件、环境等信息，以决定下一步攻击payload。  从10/23/2024-19:57:50开始到10/23/2024-19:57:50结束，共1条，其关键特征为HTTP GET 请求路径为 /conn.php?callback=?&data1=&data2=&data3=&callback=JSONP_|Cookie中包含 username= 字段|Accept包含 application/javascript, */*;q=0.8，显示为浏览器或脚本交互行为",
      "第11步攻击：T1560: 攻击者将收集到的数据（如Google Chrome自动填充日志文件）压缩为归档文件（如ZIP），以便规避网络检测系统及绕过内容过滤。  从12/11/2024-23:28:19开始到02/17/2025-02:39:03结束，共3条，其关键特征为HTTP POST方法，表示数据从内网向外部服务器主动发送。|请求体内含有‘PK’，即ZIP格式魔数，说明传输的是压缩档案。|归档文件中明确包含‘Default_Google_Chrome_Autofill.log’，指示浏览器填充数据被窃取。"
    ],
    "此攻击链关联的原因": "链条以钓鱼初始访问（T1566.001）为起点，涵盖恶意载荷投递、脚本与Powershell执行、横向移动、权限维持、系统发现、持久化、信息收集与数据渗出阶段。部分环节通过辅助TTP或语义推理衔接，行为链符合APT渗透与持久控制特征。标记两处MISSING_STEP和多环节弱时序耦合。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于钓鱼邮件诱导访问恶意域名，后通过恶意DLL与脚本，利用Office漏洞实现初步落地，随后通过Powershell和VBS脚本提升权限并实施规避；利用WMI横向移动，脚本与注册表修改实现持久化，期间持续信息收集和C2通信，最终打包敏感数据外传，展现了完整APT攻击的全阶段行为。"
  },
  "chain_1251": {
    "alerts_info": [
      "第1步攻击：T1566.002: 此告警发现客户端通过TLS SNI请求特定用于钓鱼活动（由TA4903使用）的伪造微软授权域名（.auth-msauthoffice.com），用于引导受害者访问恶意登录页面实现凭证窃取。  从08/29/2024-10:18:22开始到08/29/2024-10:22:19结束，共3条，其关键特征为TLS SNI字段包含.auth-msauthoffice.com（高仿微软域名，用于鱼叉式钓鱼）|流量方向为客户端到外部服务器（to_server established ）|使用TLS加密协议，SNI捕获到特定的钓鱼域名",
      "第2步攻击：T1059.001: 该告警检测到恶意HTML页面中包含经过十六进制编码的PowerShell下载执行命令，属于利用脚本命令在受害主机上自动执行恶意代码的行为。攻击者利用PowerShell命令下载和执行后续payload，达到远程控制、持续驻留或其他目的。  从09/16/2024-19:59:01开始到09/16/2024-20:08:10结束，共5条，其关键特征为检测HTTP 200状态码后，响应体中出现十六进制转义编码的PowerShell WebClient对象调用（'\\x73\\x79\\x73\\x74\\x65\\x6D\\.\\x6E\\x65\\x74\\.\\x77\\x65\\x62\\x63\\x6C\\x69\\x65\\x6E\\x74').|该流量为HTTP，流方向为由服务器到客户端（from_server），常见于恶意HTML页面下发时。|特征命中特定情形：以file.data内容匹配特定PowerShell下载执行的payload，并与已知Xbash相关家族恶意哈希(md5:3b5baecd61190e12a526c51d5ecccbbe)相关。",
      "第3步攻击：T1558.003: Rubeus是一种常用于Kerberos票据操作的攻击工具，被用于Kerberos TGT票据的窃取或操作。该告警指向此工具针对88端口（Kerberos服务）通信，通过非正常协议行为窃取或伪造Kerberos票据，实现凭据访问。  从10/13/2024-11:42:37开始到10/13/2024-11:42:37结束，共1条，其关键特征为目的端口为88，指向Kerberos服务|内容特征为十六进制|a7 06 02 04 6C 69 6C 00| —— 该特征与Rubeus伪造或操作Kerberos票据通信相关|相关威胁活动与FireEye披露的红队工具和异常Kerberos认证流量有关",
      "第4步攻击：T1021.001: 该规则检测SMB（端口139/445）上的特殊Impacket工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从11/03/2024-17:22:44开始到12/15/2024-09:50:11结束，共6条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'出现在SMB流量内容中，指向Impacket工具的某种变体或obfuscation处理。"
    ],
    "此攻击链关联的原因": "主要依据TTP序列递进及行为语义逻辑形成链条：钓鱼引导（T1566.002）后检测PowerShell执行（T1059.001，暗示入侵者获得初步脚本运行权限），进而观测到Kerberos票据操作（T1558.003，凭证访问与提权），最终Impacket工具特征指向SMB横向（T1021.001）。少部分阶段存在MISSING_STEP。无强基础重叠，但TTP与行为衔接合理。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链起始于鱼叉式钓鱼活动诱导访问仿冒微软域并窃取凭证，随后检测到PowerShell执行下载型payload，暗示主机受控。后续出现Kerberos票据操作行为，表明攻击者已获取内部凭证并可能提权，最终在网络中使用SMB（Impacket工具）横向移动，表现出持续渗透与扩展，步骤具备一定APT特征。"
  },
  "chain_8575": {
    "alerts_info": [
      "第1步攻击：T1543.003: 检测到恶意软件（Win32/T34 Loader）通过HTTP POST，将配置信息上传到远程服务器/web服务。这表明攻击者试图通过植入web后门或服务，实现对受害主机的持续远程控制。  从08/29/2024-15:42:17开始到08/29/2024-15:42:55结束，共4条，其关键特征为HTTP POST方式访问/abd3wufkw/post.php（bsize:19）|User-Agent为WinHttpClient|HTTP Body以cfg=开头且无Referer头",
      "第2步攻击：T1573.001: 告警检测到恶意软件3Proxy（Windows版本），通过自签名SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/03/2024-09:08:32开始到12/25/2024-13:43:01结束，共13条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "通过TTP序列递进，前后时间连续，均表现为C2通信行为。2856212首先建立持久后门并进行HTTP C2，2823005后续使用加密TLS C2链路（采用3Proxy/自定义SSL隧道），TTP具备攻击链承接逻辑。中间存在POTENTIAL_GAP及MISSING_STEP，主序列由攻击目的和通信隐蔽性承接，辅助TTP与C2特性亦一致。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于恶意软件以HTTP POST方式进行Web后门植入与C2通信，接着使用工具通过自签名SSL证书建立加密TLS C2信道，逐步升级对主机的远程控制和通信隐蔽性，展现典型持久化与多阶段隐蔽C2策略。"
  },
  "chain_1848": {
    "alerts_info": [
      "第1步攻击：T1552: 攻击者利用CWMP漏洞，通过远程请求试图获取Eir D1000路由器中的WiFi密钥、系统配置等未加密敏感信息。这属于对凭证的直接访问，目标为提取或滥用网络设备中的敏感配置和凭证数据。  从08/30/2024-09:32:21开始到08/30/2024-10:47:02结束，共3条，其关键特征为HTTP协议，目标端口为5555或7547，常用于CWMP (TR-069)管理接口。|请求或包含特征字符串“urn:dslforum-org:service:Time:1#SetNTPServers”以及在请求体中出现“<u:GetSecurityKeys>”，命中CWMP相关远程配置漏洞。|针对Eir D1000等特定型号的家庭或SOHO网络设备，攻击流量目标为设备的管理接口，尝试非法读取安全配置。",
      "第2步攻击：T1055: 本告警检测到了对存在漏洞的 Microsoft Windows cmd.exe 的远程访问横幅信息，说明攻击者可能通过利用远程命令执行漏洞获取了高级权限。此类行为常用于权限提升，通过漏洞或者后门以管理员权限执行命令。  从08/31/2024-13:19:45开始到08/31/2024-13:19:45结束，共1条，其关键特征为检测到TCP会话中包含'String: Microsoft Windows '与版权信息，表明响应内容为Windows命令行界面横幅|起始端口号非21-23（排除了FTP和Telnet常见端口），暗示访问为非标准服务暴露|流量方向属于内网主机出站至外部（$HOME_NET -> $EXTERNAL_NET），可能表明内网主机被攻击后进行外部交互",
      "第3步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。  从09/03/2024-18:55:11开始到09/03/2024-18:55:11结束，共1条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第4步攻击：T1573.001: 告警检测到Cobalt Strike Beacon通过自签名SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/04/2024-21:16:09开始到09/06/2024-16:27:30结束，共4条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第5步攻击：T1574.002: 该告警检测到对受 CVE-2012-1854 漏洞影响的 imeshare.dll 的不安全库加载操作。攻击者可通过放置恶意 DLL 于特定路径，并利用受影响应用（如 Microsoft Word）错误搜索顺序，诱使应用加载攻击者提供的恶意 DLL，实现持久化或绕过安全防护。  从09/15/2024-11:34:13开始到09/15/2024-11:34:13结束，共1条，其关键特征为流量为 TCP 445 端口（SMB协议）|SMB请求包含特征内容：“\\imeshare.dll” (Unicode编码)|匹配到 CVE-2012-1854 相关的 DLL Side-Loading 攻击行为"
    ],
    "此攻击链关联的原因": "告警按TTP阶段及时间顺序构建主线链路。T1552（敏感信息获取）后，T1055（权限提升）及T1620（implant远控），后续T1573.001和T1574.002分别为C2通道建立与持久化，存在部分MISSING_STEP因中间行为缺失，主线合乎APTC攻击流程。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过CWMP漏洞获取路由器敏感信息，随后权限提升并远程注入implant控制移动设备，借助加密C2通道长时间隐蔽操控，最终实现持久化控制。期间涉及数据窃取、横向移动、加密通信及侧载持久化，展现高级攻击链条。"
  },
  "chain_12145": {
    "alerts_info": [
      "第1步攻击：T1190: 攻击者利用Adobe Flash的CVE-2018-4878漏洞（Use After Free）对目标服务器上的可公开访问服务发起攻击，通常通过特制Flash文件诱使用户访问以执行恶意代码，实现最初的渗透。  从08/30/2024-09:42:12开始到08/30/2024-09:42:12结束，共1条，其关键特征为HTTP协议中的Flash文件数据流检测（flowbits:isset,HTTP.UncompressedFlash）|多组与Flash UAF漏洞相关的特征字节序列（如|60|，|66|，|80|等）与特定关键字（如PSDK，pSDK）|正则匹配pcre静态内容，定位利用代码结构、对象创建、LocalConnection、drmManager，指向典型利用CVE-2018-4878的攻击载荷",
      "第2步攻击：T1027: 检测到Powershell脚本使用.NET对象如MemoryStream和GzipStream进行内容解压和加载，旨在利用编码、压缩等手段混淆恶意代码，从而绕过安全检测和分析。此行为常见于恶意载荷下载和执行过程中，通过混淆提升隐蔽性。  从09/02/2024-14:18:08开始到09/04/2024-20:07:17结束，共3条，其关键特征为PowerShell脚本使用System.IO.MemoryStream和System.IO.Compression.GzipStream解压执行|特定内容匹配如|20 3d 20|New|2d|Object|20|System|2e|IO|2e|MemoryStream|和|CompressionMode|5d 3a 3a|Decompress||攻击流量为已建立的TCP连接，方向为外部到内部流量，目标为客户端终端（Windows平台）",
      "第3步攻击：T1055: 检测到MSIL/Haemorrhage RAT远控木马通过processManager模块下发KILL命令，可能用于终止安全产品或其他系统进程，实现防御绕过或维持持久控制。  从09/13/2024-07:16:55开始到09/13/2024-07:16:55结束，共1条，其关键特征为TCP流量（established,from_server方向）数据包长度小于300字节|内容包含关键字顺序：|00|, Packet, processManager, List, Kill|关联MSIL/Haemorrhage RAT家族，出现在未知来源到内网主机的会话中，具系统进程管理能力",
      "第4步攻击：T1059: 检测到RokRAT木马下发命令，表明攻击者已获得目标系统的远程命令执行能力。RokRAT 属于远控后门类工具，常用于远程执行命令和操控受害主机。  从09/22/2024-13:09:21开始到09/22/2024-13:15:33结束，共5条，其关键特征为检测到特定TCP响应流中包含RokRAT通信标识，表明为RokRAT家族通信特征。|检测方向为从外部网络到内部网络的通信，且已建立的TCP连接。|关键内容定位于前11字节，以及MD5特征匹配，适用于检测此类恶意程序特有的命令通道行为。",
      "第5步攻击：T1041: 该规则检测到恶意后门（如DTrack Beacon）通过标准C2通道（HTTP协议）与攻击者服务器通信，从被攻击主机向外部渗出数据。攻击流量中携带的数据采用特定JSON格式伪装为合法流量，目的是隐藏恶意活动。  从10/05/2024-03:42:47开始到10/12/2024-23:27:19结束，共7条，其关键特征为HTTP协议通信（服务器端返回流量）|通信体内容包含特定JSON结构，如{\"meta\":{},\"status\":\"OK\",\"saved\":\"1\",\"starttime\":...}DTrack Beacon使用自定义通信包，存在伪装和通用JSON响应字段"
    ],
    "此攻击链关联的原因": "基于TTP顺序（初始渗透T1190→载荷混淆加载T1027→进程注入T1055→C2远控T1059→数据泄露T1041）与时间逻辑建立链路；每步语义与黑客活动典型阶段匹配。辅助TTP、行为与时间序列均支持链路，间隔未超APT合理时长。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者首先利用Flash漏洞（T1190）渗透初始主机，随后通过Powershell脚本混淆与加载（T1027），实现恶意代码落地与内存执行。后续远控RAT实现进程管理（T1055）与命令执行（T1059），攻击者获得持久控制及C2通信，并最终通过隐匿数据通道（T1041）渗出敏感信息，完整展现一条高隐蔽性入侵与数据泄露攻击链。"
  },
  "chain_12846": {
    "alerts_info": [
      "第1步攻击：T1204.002: 告警检测到通过HTTP协议下发潜在加密勒索软件（如Cryptowall）加密二进制文件，常见于诱导用户执行恶意文件的攻击流程，此举触发了‘恶意文件执行’的技战术。  从08/30/2024-13:06:09开始到08/30/2024-13:06:09结束，共2条，其关键特征为HTTP协议下行流量携带特征性二进制内容（|65 5d d1 c6 b0 88 68 62|）|流量方向为已建立的从外部到内部的to_client流|利用Snort flowbits标记为 exploit kit landing，常与钓鱼或exploit kit活动关联",
      "第2步攻击：T1218.011: 攻击者利用Windows自带的CertUtil工具来下载和执行恶意可执行文件（.exe），以绕过安全检测并规避防御措施。CertUtil常被合法使用，因此易于被滥用，成为Living-off-the-land Binaries (LOLBins)的一部分。  从09/09/2024-23:33:57开始到09/09/2024-23:33:57结束，共2条，其关键特征为http请求URI结尾为.exe，表明请求可能是用于下载Windows可执行文件|User-Agent字段为'CertUtil URL Agent'，显示是用CertUtil工具发起的HTTP请求|HTTP头部顺序和内容极为特定且缺少Referer、Cookie和Accept-字段，指向自动化、非浏览器工具的下载行为",
      "第3步攻击：T1059.001: 攻击者利用shellcode launcher木马启动器代码以绕过安全检测，实现持续性驻留与命令执行。该行为通常通过文件或网络会话将命令下载至受害者主机，并使用shellcode launcher进行解析和执行。  从10/23/2024-09:29:21开始到10/23/2024-09:29:21结束，共1条，其关键特征为HTTP响应中包含特定Unicode编码的数据片段（如|22 00 20 00 24 00 28 00|等），与shellcode launcher载荷结构高度吻合。|仅在已建立的HTTP会话并从服务器向客户端方向检测，关键特征表现为file_data内容及正则匹配PowerShell代码首字母。|涉及shellcode launcher恶意代码，面向Windows客户端主机，攻击面常为渗透后阶段的横向移动与持久控制。",
      "第4步攻击：T1570: 攻击者通过SMB协议在网络内部向目标机器传送工具（如Powershell脚本），并通常结合命令行参数尝试绕过执行限制，实现进一步攻击或持久化。  从11/05/2024-19:14:58开始到11/05/2024-19:14:58结束，共2条，其关键特征为SMB协议的445端口通信，流向内部主机|SMB数据包中包含Unicode形式的powershell命令，带有'execution bypass'参数（如-bypass），意图绕过策略限制|检测到powershell相关内容与关键参数（如exec、bypass）联合出现，表明自动化或远程工具操作行为",
      "第5步攻击：T1003.001: 告警检测到SMB流量中传输了由Mimikatz工具相关的mimidrv.sys模块，该模块常用于从LSASS等内存中提取凭证。攻击者通常在获取目标主机的访问权限后，使用Mimikatz提取操作系统存储的明文账户密码、哈希或其他认证信息，从而进行后续横向移动或提权。  从12/09/2024-12:10:22开始到12/09/2024-12:10:22结束，共1条，其关键特征为TCP 139 或 445 端口（SMB协议）|SMB数据包包含特定字节序列：|FF|SMB|a2||SMB流量中出现文件名字符串：mimidrv.sys",
      "第6步攻击：T1555.003: 该告警检测到Win32/BrowserPassview恶意软件用于收集主机上浏览器保存的账户凭证。攻击者通过本地读取或导出浏览器内保存的用户名、密码、相关字段和密码强度等敏感信息，作为后续横向移动和权限提升的重要依赖数据。  从09/25/2024-10:44:53开始到09/25/2024-10:44:53结束，共1条，其关键特征为TCP协议，内部网络主机向外部网络服务器发起已建立会话的通信。|载荷内容包含固定格式的大量分割符（0x3d=等于号），以及敏感字段如'URL : ', 'Web Browser', 'User Name', 'Password'等。|数据包中多次出现特定敏感关键词，反映结构化的浏览器凭证信息被提取并准备外传。",
      "第7步攻击：T1114.001: 攻击者窃取Steam帐户信息，包括账号和密码，通过HTTP请求将这些敏感信息收集后准备泄露或导出。该规则捕捉到恶意软件通过特制的POST请求收集受害者凭证。  从09/30/2024-09:19:44开始到09/30/2024-09:19:44结束，共1条，其关键特征为HTTP请求URI包含info=Steam Steal0r关键字|POST参数中包含&acc=和&pw=，疑似封装帐号和密码字段|User-Agent头为：Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)，伪装为老旧浏览器"
    ],
    "此攻击链关联的原因": "本链条以‘恶意文件投递（T1204.002）’、‘工具下载执行（T1218.011）’到‘Empire马持久化控制（T1059.001/T1570）’为主线，后续凭证提取（T1003.001/T1555.003）与敏感信息窃取（T1114.001）时间排序和行为吻合，TTP递进明确，辅助SMB/shellcode launcher场景及凭证提取语义支撑因果关联。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击初期通过钓鱼或exploit kit诱导用户接收加密勒索或恶意载荷（T1204.002），随后利用CertUtil下载可执行文件并落地（T1218.011）。shellcode launcher执行（T1059.001）和SMB协议工具传递（T1570）实现持久化。随后Mimikatz等手段提取系统和浏览器凭证（T1003.001/T1555.003），最终大量敏感信息（如Steam账号）被窃取并外泄（T1114.001），形成较完整的多阶段攻击链。"
  },
  "chain_6560": {
    "alerts_info": [
      "第1步攻击：T1021.002: 告警检测到恶意软件EQUATIONDRUG模块尝试通过SMB命名管道与受害者系统进行通信。这属于利用Windows命名管道做为横向移动方式，攻击者以此在不同主机间传递数据或命令以实现后续控制。  从09/02/2024-13:12:09开始到09/02/2024-14:46:51结束，共5条，其关键特征为目标端口为139或445（SMB相关端口）|TCP会话，使用SMB协议（以0xFF开头的SMB头）|特定命名管道名（probable Unicode编码）",
      "第2步攻击：T1547: 检测到后门DoubleFantasy通过设置持久化命令，以确保恶意代码在系统重启或者用户登录后能够自动执行，实现长期驻留。  从09/10/2024-22:13:03开始到09/10/2024-22:13:03结束，共1条，其关键特征为Snort规则检测TCP从外部服务器回送到内部主机，端口大于1024|特定payload内容：\"persistent\\x0a\"，表示持久化操作命令|流量方向为已建立连接（流量为from_server），主要影响Windows客户端",
      "第3步攻击：T1573.001: 通过HTTPS/TLS隧道对控制流量进行加密，隐藏常用Fanny工具与攻击者C2服务器之间的通信，避免被检测。  从10/13/2024-17:17:51开始到10/21/2024-09:54:07结束，共2条，其关键特征为TLS证书subject包含OU=reboot和emailAddress=reboot@，为C2生成HTTPS回连的典型伪造证书特征|使用加密协议（一般为HTTPS）进行通信，方向为外部到内部的被控命令下发或数据回传|流量特征（flow:established,to_client）指向主机作为被控端，存在外部控制风险",
      "第4步攻击：T1542.001: 检测到HardDrive Bootkit启动活动，此Bootkit通过UEFI/ESP分区实现持久化，确保恶意代码在主机重启后继续运行。  从01/23/2025-10:31:15开始到01/23/2025-10:31:15结束，共1条，其关键特征为HTTP GET方法，URI为/Heart.aspx?ti=，并带有&tn=、&tg=、&tv=等参数|缺少Referer字段，表明为恶意自动化请求而非正常浏览器行为|流量方向为从受害主机l ($HOME_NET) 至外部网络 ($EXTERNAL_NET) 的服务器"
    ],
    "此攻击链关联的原因": "以横向移动（T1021.002）开局，其后出现持久化（T1547），检测到加密C2通讯（T1573.001），最终记录Bootkit持久化（T1542.001）；TTP时序合理，均为APT攻击常见链路。Bootkit邻接联接为POTENTIAL_GAP，整体行为以持续渗透和持稳控制为主，存在POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击活动以模块通过SMB命名管道进行横向移动为起点，随后DoubleFantasy后门通过持久化命令实现长期驻留，并建立Fanny加密C2隧道进行远程控制，最终通过HardDrive Bootkit深化持久化机制，实现高隐蔽性和持久掌控，为典型分阶段APT攻击链，链路中Bootkit持久化与前期持久化存在阶段跳跃但具整体攻击逻辑。"
  },
  "chain_8990": {
    "alerts_info": [
      "第1步攻击：T1105: 攻击者尝试通过HTTP协议向受害主机传送恶意文件implants，如DoubleFantasy的卸载器，以完成恶意软件传递、植入和后续控制。  从10/20/2024-19:10:59开始到10/21/2024-01:14:03结束，共5条，其关键特征为HTTP协议，GET方法用于向外部网络发起请求|请求的URI路径以/cook32.rar结尾，表明试图下载DoubleFantasy droppers |HTTP请求未包含Referer头部，常见于自动化下载、恶意工具流量",
      "第2步攻击：T1056: 该规则检测来自已感染主机到外部的恶意HTTP GET请求，特征为自研或者植入的攻击组件所产生的回传请求，经常用于收集受害主机插件、环境等信息，以决定下一步攻击 payload。  从12/05/2024-08:57:16开始到12/05/2024-08:57:16结束，共3条，其关键特征为HTTP GET 请求路径为 /conn.php?callback=?&data1=&data2=&data3=&callback=JSONP_|Cookie中包含 username= 字段|Accept包含 application/javascript, */*;q=0.8，显示为浏览器或脚本交互行为",
      "第3步攻击：T1564.003: 恶意流量通过HTTP POST请求，以看似正常的流量进行C2通信和日志传输，企图隐藏其控制行为并绕过安全检测。定制植入GrayFish以及多种隐晦HTTP POST封装手法实现同类流量混淆及隐蔽通信。  从12/28/2024-23:42:07开始到12/28/2024-23:42:07结束，共2条，其关键特征为HTTP POST 请求流量，目标为外部网络|请求体（body）中包含 'M] Execution started on ', 并紧跟 '! Ducky now safe to remove.' 或相关自定义执行状态字符串|HTTP头部缺少 Referer 字段，疑似规避溯源",
      "第4步攻击：T1573: 该告警检测到加密C2通道活动。攻击者使用定制加密协议（如RC5, RC6等）隐藏命令和控制信号，防止被传统安全产品检测和拦截。  从01/15/2025-17:22:54开始到01/15/2025-17:22:54结束，共2条，其关键特征为恶意签名内容可由implants定制生成，而非Xworm C2通信标志|通信方向为HOME_NET向EXTERNAL_NET（出站流量）、TCP协议|流量目的地为已建立连接的服务器，行为特征为命令与控制通信"
    ],
    "此攻击链关联的原因": "该链基于TTP阶段进展、时间顺序及行为语义进行关联。攻击链体现了从恶意载荷传递（T1105）到利用回传（T1056）、隐匿C2通信（T1564.003）、最终加密C2及潜在数据回传（T1573）的完整攻击流程，虽然部分中间步骤缺失，整体逻辑连贯。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先投递DoubleFantasy恶意载荷，随后利用回传被感染主机环境信息，经隐匿手段建立持久C2通信，入侵链条以Win32/XWorm的加密操控与可能数据外泄收尾，体现从植入、侦察、隐蔽、控制到潜在渗出的完整APT攻击轨迹。"
  },
  "chain_15121": {
    "alerts_info": [
      "第1步攻击：T1027: 该告警检测到Mydoom蠕虫通过SMTP协议发送带有编码/封装（二进制数据以文本形式，如base64编码）的可执行文件（邮件附件）。这种模糊处理意图躲避杀毒或安全网关的检测。  从11/22/2024-23:41:42开始到11/22/2024-23:41:42结束，共3条，其关键特征为SMTP会话（邮件通信协议）|邮件正文中出现hex序列'0d 0a 0d 0a'后紧跟base64编码的PE文件前缀（UEsDB…）|邮件内容中存在Mydoom蠕虫的特征码片段'5zY3JNWp'",
      "第2步攻击：T1059: 检测到PowerShell相关命令在主机上执行，这是攻击者常用来自动化任务、下载并运行payload的常见手段，尤其是在Windows平台上。  从12/01/2024-12:17:15开始到12/01/2024-12:17:15结束，共2条，其关键特征为HTTP协议的POST方法，数据通过HTTP POST发送|请求体中包含PowerShell输出的Base64编码数据（字段关键内容如\"hhbmRsZXMgIE5QTShLKSAgICBQTShLKSAgICAgIFdTKEspIFZNKE0pICAgQ1BVKH\"）|目标为$EXTERNAL_NET（出网流量），存在数据由受害主机向外发送的迹象",
      "第3步攻击：T1090: 攻击者利用非法或特制的代理工具（如Socks5Cap），通过代理或隧道中转通讯流量，实现隐藏通信源头、绕过安全检测与网络边界管控，提升对目标的长期控制能力。Socks5Cap曾被用于后门通信隐藏。  从12/18/2024-09:35:24开始到12/18/2024-09:35:24结束，共2条，其关键特征为匹配特征数据串aaaabbbbccccdddd|00 00 00 00 00 00 00 00|（Socks5认证包识别特征）|TCP协议，流向服务器端，状态已建立（flow:established,to_server）|数据报文中间具有固定特征|00 00 04 00 00 00|，高度说明为恶意通信协议的数据结构",
      "第4步攻击：T1573: 攻击者通过Meterpreter恶意软件与C2服务器通信时，利用自定义协议进行流量加密，规避检测和拦截。该行为属于利用加密或自定义协议建立C2通道，实现与被控主机间持续、隐蔽通信。  从01/17/2025-03:19:22开始到01/19/2025-13:47:59结束，共5条，其关键特征为TCP协议，特征流量方向为本地主机（$HOME_NET）发往外部（$EXTERNAL_NET）|服务器侧会话总流量小于等于5字节，携带48字节负载|有效载荷以hex值: 46 98 6b dd 00 17 35 10 开头，20 a3 5c b6 68 d3 2c 75 结尾，为Meterpreter典型C2 Checkin特征序列",
      "第5步攻击：T1071.001: 攻击者通过HTTP协议与受感染主机建立命令与控制（C2）通信，并利用定制的User-Agent头（如“BSC Agent”）进行特征化的流量标识，以区分正常与恶意流量，从而实现对受害主机的持续控制。  从01/28/2025-17:44:45开始到01/28/2025-17:44:45结束，共4条，其关键特征为HTTP协议通信|User-Agent字段包含'BSC Agent'|流量方向为内网到外网，表现为客户端向外部服务器建立HTTP会话",
      "第6步攻击：T1486: 该检测规则通过HTTP流量识别Sage勒索软件活动，主要目的是加密受害者的数据以造成影响并勒索赎金。  从02/05/2025-08:30:34开始到02/05/2025-08:30:34结束，共1条，其关键特征为HTTP响应包中含特征头部 Content-Length: 1|流量方向为服务器到受害主机，且已建立连接|HTTP Body仅含有单字节‘k’字符，作为加密成功后的回包特征"
    ],
    "此攻击链关联的原因": "告警TTP序列完整反映了邮件钓鱼-渗透-持久化和远控-勒索破坏的进攻链路，涵盖Mydoom蠕虫投递、PowerShell后渗透、恶意代理（Socks5Cap）、Meterpreter与BSC Agent C2通信直到Sage勒索收尾，时间连续且语义连贯。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "本攻击链反映从Mydoom蠕虫邮件初始入侵（T1027），通过PowerShell攻击自动化渗透（T1059），再借助恶意代理（Socks5Cap）和Meterpreter流量加密建立隐蔽C2隧道（T1090、T1573）、HTTP标志性C2通信（T1071.001），最终触发Sage勒索攻击（T1486）导致数据加密勒索。链路展示了完整的钓鱼-信息收集-远控-加密破坏攻击流程。"
  },
  "chain_18": {
    "alerts_info": [
      "第1步攻击：T1204.002: 告警的流量特征显示终端用户访问了形如“.php?rnd=&id=”参数的URL，这类URL结构常被利用于恶意攻击包（如Exploit Kit）进行第二阶段（payload）恶意文件下载并诱导主机执行，从而实现攻击代码的植入和执行。  从09/11/2024-16:26:28开始到09/17/2024-13:05:50结束，共3条，其关键特征为HTTP协议二阶段下载流量，通常作为exploit kit攻击链的一环|URL中包含“.php?rnd=[数字]&id=[44-54位16进制]”的参数结构，具有典型恶意载荷下发特征|流量方向为from $HOME_NET to $EXTERNAL_NET，且流程已建立，表明主机对外主动访问",
      "第2步攻击：T1055: 检测到类似SHELLCODE的特征码（SGI NOOP sled），通常用于恶意代码注入目标进程，实现持久化或进一步攻击。攻击者利用shellcode尝试将恶意代码注入到受害系统的运行进程中。  从10/20/2024-03:10:56开始到10/22/2024-10:05:17结束，共4条，其关键特征为SGI架构下常见的NOOP sled字节序列，二进制为24 0F 12 4。|$EXTERNAL_NET（外部源）向$HOME_NET（内部目标）任意端口发起连接，端口通常为shellcode攻击目标端口。|协议类型为IP，无关具体上层协议，泛用性高，针对性检测NOP sled结构，表明攻击载荷中存在典型SHELLCODE模式。",
      "第3步攻击：T1027: 攻击者使用混淆的JavaScript代码以逃避检测，提升恶意代码的隐蔽性，使安全产品难以发现真实意图。该规则检测通过典型phishkit散布并混淆的JavaScript，旨在窃取敏感信息。  从10/29/2024-15:18:44开始到10/29/2024-15:18:44结束，共2条，其关键特征为HTTP 200响应，表明目标正在下载或加载恶意网页内容|JavaScript混淆手法：var <array>=new Array; 以及大规模动态数组与document.write结合进行payload解码|检测特定混淆关键词和编码手法（如Math.pow, String.fromCharCode, for循环动态拼接脚本）",
      "第4步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件的持久化机制相关联。  从11/03/2024-06:27:09开始到11/03/2024-06:27:09结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第5步攻击：T1570: 攻击者通过SMB协议在受害网络内部传输如PowerShell脚本等工具，实现对其他系统的访问或持久化，也可能用于执行远程命令，扩展持久性或权限。此次告警监测的是SMB流量中传输带有'PowerShell -NoProfile'参数的命令，表明可能有恶意脚本或工具被横向传播。  从11/12/2024-09:45:18开始到11/12/2024-09:45:18结束，共1条，其关键特征为TCP 445端口（SMB协议）|通信内容包含ASCII + Unicode编码的'PowerShell'字符串，且带有'-NoProfile'参数|已建立且指向服务器（to_server）的SMB流量",
      "第6步攻击：T1098: Skeleton Key 恶意软件通过向目标系统植入认证绕过模块，实现对域控制器的持久权限控制，能够绕过身份认证机制，持久化操控目标环境。  从10/12/2024-11:52:20开始到10/12/2024-11:52:20结束，共1条，其关键特征为检测到TCP流量目的端口为139或445（SMB典型端口）|SMB流量中包含'\\ole.dll'（Unicode编码）特征，表明恶意DLL的传输|报文中包含'|FF|SMB|a2|'标志及特定SMB包格式和属性",
      "第7步攻击：T1003: 攻击者通过dump进程（如procdump.exe）获取LSASS等进程的内存数据，从而转储并窃取凭据，常用于后续横向移动等攻击阶段。  从12/01/2024-12:54:45开始到12/01/2024-12:54:45结束，共1条，其关键特征为TCP流量，已建立连接由内网主机向外部主机发送数据|流量内容包含Unicode编码的字符串‘procdump64.exe’，表明正在尝试外发procdump导出的dmp文件|与已知高危凭据转储工具相关的文件传输行为，通常异常出现在非日常运维时间及非受控终端"
    ],
    "此攻击链关联的原因": "按TTP时间序列和语义分析：从诱导型下载、代码注入、混淆隐蔽、持久化、横向SMB传递、认证绕过到凭据窃取逐步推进，时序逻辑流畅。链路中存在阶段跳跃（MISSING_STEP），推测为高隐蔽持续攻击，部分以行为语义和辅助TTP补充。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链始于利用恶意下载实现初步入侵，随后代码注入与混淆JavaScript增强隐蔽性，经由计划任务及SMB命名管道达成持久化与远控，横向移动利用SMB传递PowerShell脚本扩展攻势，最终通过认证绕过与凭据窃取获取更高权限和敏感数据，实现深度渗透和信息泄露。过程中多次阶段跳跃，指向持续、隐蔽性强的APT攻击。"
  },
  "chain_4512": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击利用Greatness Phish Kit，在钓鱼页面引导受害者输入认证信息，通过诈骗登录页面等方式收集凭证。此类活动常见于针对Microsoft 365等云服务账户的窃取行动。  从08/20/2024-09:15:23开始到08/20/2024-09:15:23结束，共1条，其关键特征为HTTP请求URI包含/host和/admin/js/mj.php，表明命中Greatness Phish Kit服务器特定钓鱼资源。|HTTP方法为GET，常见用于向钓鱼页面发起访问请求，可能为钓鱼登录界面加载。|关联IoC参考（https://blog.talosintelligence.com/new-phishing-as-a-service-tool-greatness-already-seen-in-the-wild/），证明其为实际威胁情报中的指标。",
      "第2步攻击：T1203: 攻击者通过利用Adobe Flash中的Use After Free漏洞（CVE-2018-4877），诱导受害者访问特制恶意网页，实现对终端的远程代码执行。这种攻击属于客户端利用，通常依赖用户访问被攻击者控制或被篡改的网页。  从08/20/2024-09:45:41开始到08/20/2024-09:45:41结束，共1条，其关键特征为HTTP协议，触发于与服务器建立的连接（from_server端流）|内容检测关键字包括：PSDK、pSDK、createDispatcher、createQOSProvider、MediaPlayerItemLoader、attachMediaPlayerItemLoader等，指向Flash组件被恶意利用|检测HTTP流量中文件数据与特定Flash对象及关键字顺序共现，涉及特定字节序列，表明恶意Flash漏洞利用载荷传输",
      "第3步攻击：T1204.002: 攻击者诱导用户触发，下载和执行含有恶意代码的JS/HTA文件，常用于下发后续载荷。该告警检测的是与已知下载器行为（JS/HTA Downloader）相关的HTTP请求，属于被动执行阶段。  从08/21/2024-17:08:56开始到08/21/2024-17:26:43结束，共4条，其关键特征为HTTP请求的URI符合/r[a-z0-9].php?group=xxx模式，利用GET参数和伪随机路径隐蔽访问|User-Agent头伪装为早期浏览器，如Mozilla/4.0 (compatible; MSIE 7.0;...)，试图规避安全检测以及适应服务端脚本针对性响应|HTTP头部未包含Referer和Cookie字段，常见于自动化或恶意流量，区别正常用户交互行为",
      "第4步攻击：T1027: 告警检测到含有LaZange相关payload的二进制文件通过HTTP下发给主机。这类行为常见于攻击者将攻击工具（如LaZange的pye2exe封装程序）通过网络隐蔽传输，用于在受害者主机上规避安全监控和检测机制。  从08/20/2024-10:41:10开始到08/20/2024-10:58:37结束，共4条，其关键特征为HTTP协议，合法服务端返回码200，文件流内容包含LaZange相关特征字符串|文件内容携带 'lazagne.config.powershell_execute', 'lazagne.softwares.browsers.', 'chats.skype', 'windows.creddump'，涉及多种信息窃取配置|溯源码侧重Windows平台，典型于攻击者正在尝试部署或下发LaZange信息窃取工具",
      "第5步攻击：T1105: 检测到通过HTTP协议从外部站点向本地内部网络传送可执行文件（EXE），常见于恶意软件或攻击者远程传入工具执行后续攻击。  从08/23/2024-23:00:51开始到08/24/2024-01:17:22结束，共5条，其关键特征为HTTP协议流量，已建立且方向为服务器到客户端|User-Agent为wininet（常见于恶意自动化或模拟真实IE客户端下载）|传输内容包含EXE文件标识头部（MZ + PE），且落地EXE二进制",
      "第6步攻击：T1140: 部分恶意程序通过编码或解码在HTTP头部中嵌入系统信息，以规避安全监测。此类行为常用于绕过传统安全检测和提高C2通信隐蔽性。  从08/20/2024-12:21:01开始到08/20/2024-12:21:01结束，共1条，其关键特征为HTTP User-Agent 字段中包含形式为“UserName: ”、“System: ”、“CPU: ”、“GPU: ”、“RAM: ”的内容|通信方向为内网主机到外网服务器（$HOME_NET -> $EXTERNAL_NET）|使用HTTP协议，信息嵌在User-Agent字段，行为符合恶意软件C2与情报外送习惯",
      "第7步攻击：T1571: 攻击者利用非标准端口对外通信以规避网络检测机制，使恶意通信不易被发现。例如，H.323协议（视频会议/VoIP相关协议）通常不会在低端口上运行，本规则检测的是H.323 Q.931 CONNECT数据通过非标准低端口的出站通信，这可能是攻击者利用非标准端口建立后门控制通道。  从08/23/2024-14:52:15开始到08/23/2024-16:40:27结束，共3条，其关键特征为检测的是出站H.323 Q.931 CONNECT数据（由二进制头部特征识别）|通信协议为TCP，目的端口为非标准低端口（排除80, 389, 443, 1024以上端口）|流量方向为已建连且发往外部服务器（flow: established, to_server）",
      "第8步攻击：T1083: 该告警检测到Loda Logger恶意软件尝试枚举受害主机的磁盘驱动器列表。这种行为通常是攻击者在感染后执行发现操作的一部分，用于获取系统中所存在的驱动器信息，以便后续行动。  从08/25/2024-15:11:45开始到08/25/2024-15:11:45结束，共1条，其关键特征为流量为TCP，从远端服务器到内部主机（from_server）|数据包长度为9字节；包含ASCII字符串: AllDriver|该通信特征与Loda Logger家族相关，且适用于Windows平台的多版本",
      "第9步攻击：T1041: 该规则检测到恶意Android应用（Trojan-Clicker.AndroidOS.Simpo.bq）通过HTTP协议与C2服务器通信，对外建立命令控制通道，并可能携带数据进行传输。攻击者通过该技术实现与被控终端的数据收集和命令下发。  从09/01/2024-09:42:27开始到09/03/2024-13:31:09结束，共10条，其关键特征为HTTP GET请求，路径为 /pptest.php，协议版本为 HTTP/1.x|User-Agent 字段为 Apache-HttpClient/，为常见的HTTP客户端库伪装特征|HTTP请求中无 Referer 和 Accept 头，常见于自动化恶意流量，指示异常请求行为",
      "第10步攻击：T1573.001: 告警检测到APT28（奇幻熊/Fancy Bear）利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/06/2024-21:12:37开始到09/06/2024-21:12:37结束，共3条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "链按TTP阶段顺序推进，事件时间先后明确匹配攻击流程，从鱼叉钓鱼、漏洞利用、加载/混淆载荷、工具落地、信息收集、C2通信到加密后门覆盖关键攻击阶段。部分阶段（如发现/渗透动作）通过TTP/语义强连接，充分利用各告警辅助属性建立因果链。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击链始于鱼叉钓鱼获取凭证（T1566.001），后利用Flash漏洞执行远程代码（T1203）诱导执行恶意JS/HTA（T1204.002），随后通过混淆工具（T1027）和文件传输（T1105）工具落地。恶意程序解码主机信息并建立C2通信（T1140、T1571），期间收集系统信息与外联（T1083、T1041），最终使用加密通道强化持久远控（T1573.001）。整体反映了完整的定向攻击事件。"
  },
  "chain_23590": {
    "alerts_info": [
      "第1步攻击：T1566.002: 该告警通过检测与社交媒体恶意广告相关的域名访问，反映出攻击者通过恶意广告引诱受害者访问伪装的站点，通常用于鱼叉钓鱼、凭证窃取或进一步植入恶意 payload。  从08/22/2024-09:13:15开始到08/22/2024-09:13:15结束，共1条，其关键特征为TLS SNI 字段含 itstrq.itsm-us1.comodo.com，可用于流量分析及威胁检测|告警针对已建立的 TLS 连接至外部域名，流量方向为内部到外部|关联恶意广告活动，来源于社交媒体伪装与仿冒网站，可能涉及社会工程诱骗",
      "第2步攻击：T1204.002: 检测到疑似投递的恶意下载器（Trojan.Downloader）通过HTTP协议与外部C2服务器通信，请求配置文件以实现后续攻击步骤。这类行为主要发生在受害者点击钓鱼邮件中的恶意链接或文档后，恶意代码被激活并连接外部以下载指令或载荷。  从08/22/2024-09:35:47开始到08/22/2024-09:35:47结束，共2条，其关键特征为HTTP访问特定路径：/logo.html，属于恶意样本常用的C2配置请求路径|特定User-Agent：Mozilla/4.0 (兼容 MSIE 6.0 Windows NT 5.1等)，表明恶意软件伪装成过时的IE浏览器以躲避检测|流向由本地网络端口发起到外部网络任意端口，表现为典型的受害主机向C2中心通信行为",
      "第3步攻击：T1566.001: 该告警检测到含有潜在恶意文档（MalDoc）的邮件，利用WinInet API调用迹象（InternetOpen），常见于Dridex恶意软件的邮件传播。这是一种通过带有恶意附件的钓鱼邮件执行初始访问的攻击技术。  从08/28/2024-08:17:12开始到08/29/2024-14:50:58结束，共6条，其关键特征为SMTP协议中传输邮件数据|内容特征匹配Base64编码后的InternetOpen WinInet API调用|邮件附件中可能含有恶意代码（通常为Office宏或脚本）",
      "第4步攻击：T1055.002: 该告警检测到Win32/Meterpreter shellcode或payload通过会话传输到主机，典型用于Metasploit等工具远程植入并执行驻留型恶意代码，属于进程注入或远程payload投递。  从09/01/2024-21:37:24开始到09/01/2024-21:37:24结束，共3条，其关键特征为流量为已建立TCP会话，方向为from_server，符合远程控制工具下发payload的常见流量特征。|内容特征匹配PE可执行文件头（‘MZ’和‘PE\\x00\\x00’），及特定的Windows DOS模式字符串，表明有效载荷为Windows可执行格式。|fast_pattern与flowbits设置配合累计上下文，减少误报并关联后续检测（如Meterpreter session activity）。",
      "第5步攻击：T1059.004: 攻击者通过交互式Shell（如bash/sh）远程控制受害者主机，实现防御绕过与操控。告警检测到传出数据中包含bash/sh提示，说明攻击者可能获得shell访问，且提示无TTY，常见于逆向shell攻击。  从09/02/2024-02:40:48开始到09/02/2024-02:40:48结束，共2条，其关键特征为TCP流量方向为内部主机到外部主机，且为已建立连接（flow:established, to_server）|数据包内容特征为shell提示符'no job control in this shell'（通常为反弹shell缺乏TTY时的提示信息）|正则匹配bash/sh作为进程/命令前缀，疑似逆向shell会话",
      "第6步攻击：T1053.005: 威胁行为者可能通过系统服务或定制的作业调度机制，如计划任务，保持远程访问，SMB命名管道的使用被发现与高度隐蔽的恶意软件（如Duqu 2.0）的持久化机制相关联。  从09/03/2024-09:33:45开始到09/03/2024-09:33:45结束，共1条，其关键特征为目的端口为139和445，目标为SMB/SMB2协议通信|使用特殊格式（Unicode编码）的SMB命名管道，与Duqu 2.0相关|TCP协议通信，流向为to_server，内容特征包含特定的管道内容片段",
      "第7步攻击：T1555: 检测到基于SecurityXploded工具的恶意软件试图收集用户凭证（如密码、账号等），该阶段属于威胁行为者在受害主机上获取敏感信息的操作。  从09/14/2024-23:02:14开始到09/14/2024-23:02:14结束，共1条，其关键特征为TCP流已建立，方向从内网到外网|数据包中特征字符串包含‘Recovery Report’及‘Produced by’等凭证报告相关字样|出现十六进制分隔与数据报格式（如|0d 0a 0d 0a|，|2a 2a 2a 2a 2a 2a 2a 2a|），疑似为自动生成的凭证提取报告内容",
      "第8步攻击：T1552.004: 攻击者利用IKEv1协议中的信息泄露漏洞（CVE-2016-6415），试图通过发送特制UDP数据包获取Cisco设备的敏感凭据信息，如预共享密钥、配置凭证等。这属于凭据访问阶段，意在盗取网络设备中的认证信息。  从09/18/2024-08:35:17开始到09/18/2024-08:35:17结束，共2条，其关键特征为基于UDP协议、目的端口500（典型IKE流量）|特征内容匹配模式：‘|00 00 00 00 00 00 00 00 01 10|’以及‘|80 02 00|’、‘|80 04 00 01 00 06|’等IKE Payload结构特征|数据包体积大于828字节，表明为特制大包，试图触发潜在的协议响应漏洞",
      "第9步攻击：T1218.001: 攻击者利用 Windows BITSAdmin 工具，通过被信任的二进制程序下载和执行恶意代码，以逃避传统安全检测。此流量发现了 bitsadmin /transfer 命令，表明恶意 PowerShell downloder 被利用。  从09/18/2024-22:02:18开始到11/21/2024-13:57:02结束，共19条，其关键特征为目的端口为 5900，通常为VNC远程桌面相关流量|流量包含 bitsadmin /transfer 和 /priority high，结合&start参数，符合恶意利用模式|流量方向为 $HOME_NET 到 $EXTERNAL_NET，指向外部C2或恶意下载站点",
      "第10步攻击：T1027: 检测到通过 PowerShell one-liner 的二进制编码内容下发，隐匿真实的恶意负载，以绕过检测，表明攻击者使用了编码和混淆技术来规避安全防护。  从10/19/2024-16:11:03开始到10/19/2024-16:11:03结束，共1条，其关键特征为HTTP 响应体中包含 PowerShell One-liner Base64 编码内容|HTTP 协议，从服务器下发送到客户端|匹配关键字符串：New-Object IO.StreamReader(New-Object IO.Compression.GZipStream(...)），表明载荷在客户端解码、解压缩和执行",
      "第11步攻击：T1132: 攻击者利用自定义或加密、编码的数据传输方式，隐藏C2通信内容。该告警检测到Karkoff/APT DNSpionage相关样本通过XOR编码的配置内容进行通信，隐匿恶意活动。  从11/03/2024-09:48:21开始到11/03/2024-09:48:21结束，共1条，其关键特征为HTTP响应状态码为200，通信流量来源为外部网络服务器，可能伪装为正常Web流量。|内容体匹配字节流：11 75 35 2f 15 13 17 2f 09 2f 07 2f（疑似XOR编码的C2配置或心跳数据）。|与Karkoff 或 APT DNSpionage家族的已知活动相关联，存在配置下发或命令接收行为，且专门针对Windows平台。",
      "第12步攻击：T1071.001: 攻击者控制的恶意软件通过使用HTTP GET请求与其C2服务器通信，实现恶意代码的回连和远程命令接收。  从11/18/2024-00:22:44开始到11/18/2024-00:22:44结束，共4条，其关键特征为HTTP请求方法为GET|请求URI路径包含/ok.asp?uid=，且uid格式为IPv4地址|HTTP头部中包含Content-Length: 0，通常用于告知服务端该请求无实体内容",
      "第13步攻击：T1095: 检测到内网主机通过DNS查询 .onion 域名（askhoreasption.com），通常用于绕过安全检测，将流量伪装成正常DNS流量以隐藏真实通信内容，这是一种防御规避手法。攻击者可能试图通过这种方式联系Tor代理或暗网资源。  从12/01/2024-18:00:11开始到12/01/2024-18:00:11结束，共2条，其关键特征为DNS协议被用于请求.onion代理相关域名（askhoreasption.com）|查询内容中包含特定的二级域名后缀（.askhoreasption.com）|涉及Tor匿名网络，暗示意图可能是隐匿通信或连接暗网服务",
      "第14步攻击：T1036.005: 攻击流量通过看似常规的HTTP POST请求（/tsone/ajuno.php）传输数据，并且省略了典型的User-Agent及Referer头部，企图避开传统检测手段。  从12/27/2024-13:17:25开始到12/27/2024-13:17:25结束，共1条，其关键特征为HTTP POST请求，目标路径为/tsone/ajuno.php|HTTP Host字段为IP地址（使用正则匹配IP格式），无User-Agent和Referer头|请求体包含以u=, &p=, &l=等参数格式，疑似提交账号凭证信息",
      "第15步攻击：T1573.002: Metasploit Meterpreter Reverse HTTPS 使用自定义伪造的证书与C2服务器建立TLS加密隧道，实现命令与控制流量隐蔽传输，逃避检测。  从01/24/2025-09:21:37开始到01/24/2025-09:21:37结束，共3条，其关键特征为使用TLS协议并分析证书subject包含 C=US, ST=、O=、OU=pixel, CN=、/emailAddress=pixel@|流量方向为 established, to_client，即攻击者向被控端下发C2有效负载|匹配特定的X.509证书特征（如OU和emailAddress为pixel相关）表明来自Metasploit Meterpreter HTTPS反向连接"
    ],
    "此攻击链关联的原因": "基于TTP逐步推进（初始访问→执行→持久化→凭证访问→命令控制→防御规避→数据渗出）、多阶段时间序列、恶意广告/鱼叉钓鱼/文档诱导/下载器/进程注入/命令执行/凭证收集等链式行为。部分阶段存在POTENTIAL_GAP和MISSING_STEP，各告警特征、TTP描述和IOC信息有较强关联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链自社交工程诱导和恶意广告/鱼叉钓鱼开始，诱骗用户点击恶意链接或文档，植入恶意下载器与shellcode，经进程注入与反弹shell远控主机。攻击者随后利用计划任务保持持久，窃取本地和网络凭证，并通过持久化和混淆技术绕过防御。链中后续包含利用脚本/二进制下载、数据编码、流量伪装、DNS及HTTP/SMB等多协议数据渗出和C2控制，整体表现为端到端的APT攻击活动，覆盖初始访问、执行、持久化、凭证访问、C2及防御规避等多阶段。"
  },
  "chain_23752": {
    "alerts_info": [
      "第1步攻击：T1566.002: 攻击者通过仿冒合法网站(email.gov.in)搭建钓鱼页面，诱导受害者误输入凭据，实现凭据窃取。此类攻击是社交工程的一种常见方式。  从08/25/2024-00:13:22开始到08/25/2024-01:18:31结束，共3条，其关键特征为HTTP协议响应码为200（表示正常的网页加载响应），用于伪装钓鱼页面合法性。|HTTP响应数据中包含‘<!-- saved from url=’)https://email.gov.in/’字符串，表明页面为仿冒email.gov.in。|流向为to_client，表明告警监测到外部恶意内容在向内部用户发送，属于客户端受害场景。",
      "第2步攻击：T1566.002: 该Snort规则检测到攻击者试图通过传递包含恶意Microsoft Equation Editor OLE组件（CVE-2017-11882）的RTF文档发动攻击，用以获得初始访问权。APT组织（如Zebrocy）常用该漏洞在目标环境植入恶意payload。  从08/26/2024-13:11:12开始到08/26/2024-14:21:16结束，共3条，其关键特征为HTTP流量涉及RTF文档下载，流量中含特征流bit: ET.http.rtf.download|数据内包含OLE对象标识内容：objclass Equation.3|特定的ole内容特征和十六进制序列，如02CE020000000000C000000000000046，以及|31 63 30 30 30 30 30 30 30 32 30 30|等字节流",
      "第3步攻击：T1059.001: 该告警检测到通过PowerShell进行的HTTP流量，请求恶意内容。这类行为常用于执行绕过防御或直接实现攻击者控制的脚本。攻击者可利用PowerShell远程下载和执行代码，逃避安全防护措施。  从09/01/2024-17:08:43开始到09/01/2024-20:37:21结束，共4条，其关键特征为HTTP GET请求，URI不包含点号（可能绕过默认拦截规则）|Header存在特定的Proxy-Connection字段，且无Referer字段|User-Agent包含“Microsoft Windows PowerShell/”字段",
      "第4步攻击：T1588.002: 告警识别到Metasploit Meterpreter Reverse HTTPS 会话中使用了具有固定特征的自签数字证书，属于攻击者为隐匿通信流量、绕过安全设备检测而获取或伪造数字证书的行为。  从08/22/2024-09:38:53开始到08/22/2024-09:38:53结束，共1条，其关键特征为通过TLS协议建立的会话，方向为外部到内部，回连场景|TLS证书Subject字段中存在固定的Metasploit生成特征: C=US, ST=、O=、OU=bus, CN=、/emailAddress=bus@|该证书结构高度匹配Metasploit/Meterpreter逆向HTTPS连接默认行为",
      "第5步攻击：T1071.001: 该告警检测到恶意软件通过 TLS 协议和已知 TA444 恶意域名（.disneytv.net）建立加密通信，可能用于命令与控制通信。攻击者利用 TLS 加密隐藏其流量意图，通过 SNI 字段传递 C2 通信域名。  从09/08/2024-10:46:12开始到09/10/2024-03:33:35结束，共13条，其关键特征为TLS协议通信，SNI字段中含有.disneytv.net恶意域名|流量方向为内网主机到外部（to_server），处于已建立的TLS会话中|使用Snort规则的fast_pattern快速检测已知恶意域名，关联TA444威胁组织"
    ],
    "此攻击链关联的原因": "以TTP路径为主线，钓鱼（T1566.002）到利用文档漏洞，再经PowerShell远程执行（T1059.001），证书制备（T1588.002）及C2通信（T1071.001）；时间顺序合理，有部分阶段缺失（MISSING_STEP），但全局链条具备APT攻击典型特征。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链自仿冒钓鱼页面诱捕用户（T1566.002）、利用恶意RTF文档和漏洞初始获取访问权，接着检测到PowerShell远程下载与潜在执行恶意代码，攻击者通过自签数字证书隐匿通信，最终与C2服务器建立加密TLS通信。全链呈现出钓鱼入侵、漏洞利用、持久化准备和远控回连等主要阶段，符合APT攻击的行为模式。"
  },
  "chain_20730": {
    "alerts_info": [
      "第1步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。  从08/22/2024-13:05:12开始到08/22/2024-13:07:41结束，共3条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第2步攻击：T1071.001: 威胁行为者利用HTTP POST请求，将受害主机的系统信息及敏感数据（如Cookie、操作系统、信用卡等）通过Web流量发送到攻击者控制的服务器，实现与C2服务器的通信。  从10/14/2024-22:48:09开始到01/10/2025-13:10:41结束，共13条，其关键特征为HTTP协议POST方法，通信方向为内网到外网（to_server）|HTTP请求体中特征字符串：data=[{\"Cookie\":\"...\",\"Os\":...,\"Creditcard\":...}]&type=&arg=|内容包含系统信息和敏感数据（Cookie、操作系统、信用卡信息）结构化打包上报，无URL参数和分隔符（如&、?、.）"
    ],
    "此攻击链关联的原因": "两条告警均表现为移动设备通过HTTP协议与外部C2服务器通信，先是implant远程运行命令（T1620），后续检测到敏感数据通过HTTP POST上报（T1071.001）。两条TTP存在命令与控制阶段的连续演进，结合时间顺序及行为语义形成因果链。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链呈现为先在iOS设备上成功植入后门implant，建立HTTP通道与C2服务器通信，并远程执行恶意命令，继而通过HTTP POST协议将被窃取的系统信息及敏感数据打包上传外泄，完整复现了从后门植入到C2及数据泄露的关键攻击过程。"
  },
  "chain_19739": {
    "alerts_info": [
      "第1步攻击：T1055.001: 利用MySQL服务器将自定义可执行文件（.exe）写入Windows系统目录（C:\\windows\\system32），以便后续执行，以达到绕过安全控制、潜在获取SYSTEM权限等目的。此方法为Stuxnet等高级威胁常用技术。  从08/22/2024-22:18:33开始到08/23/2024-01:17:43结束，共5条，其关键特征为对MySQL服务（TCP 3306）的写入型SQL命令检测（INTO DUMPFILE 指向 C:\\windows\\system32\\*.exe）|SQL查询中带有SELECT data FROM ..., INTO DUMPFILE，目标为可执行文件（.exe）|利用MYSQL DUMPFILE功能直接在系统关键目录写入新文件，实现恶意持久化或远程利用",
      "第2步攻击：T1572: 攻击者利用自定义协议隧道（如Fast Reverse Proxy协议），绕过网络监控和防御系统，实现与受控主机之间的隐蔽命令与控制通信。此行为匹配Hydrochasma相关的恶意活动，使用自定义的加密TLS流量进行的Fast Reverse Proxy连接。  从08/25/2024-03:22:18开始到08/25/2024-03:22:18结束，共8条，其关键特征为TCP协议，目标为$EXTERNAL_NET|特定的TLS握手指纹——前14字节匹配|10 61 62 16 03 01 00 ee 01 00 00 ea 03 03|，为Hydrochasma Fast Reverse Proxy通信特征|流量方向为内网到外网，且已建立连接（flow:established,to_server），用于命令控制目的",
      "第3步攻击：T1562.001: 攻击者尝试绕过Windows反恶意软件扫描界面（AMSI），以避免恶意Powershell脚本被检测到。该技术通过利用AMSI的缺陷或对其进行禁用，使得后续恶意行为可以隐蔽执行。  从09/03/2024-17:53:10开始到10/12/2024-10:41:11结束，共2条，其关键特征为HTTP流量中包含 '<script' 关键字，指示为含脚本的网页内容。|脚本内容中带有关键字 'powershell'，表明涉及Powershell命令调用。|脚本内存在base64编码字符串 'YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBk'（解码为'amsiInitFailed'，是尝试绕过AMSI的典型指标）。"
    ],
    "此攻击链关联的原因": "TTP序列合理：先通过MySQL服务写入系统关键目录的恶意文件（T1055.001），后利用自定义代理（T1572）建立命令控制和数据通道，最后通过Powershell脚本绕过AMSI进行进一步操作（T1562.001）。阶段逻辑顺畅，但存在较大时间间隔，标记POTENTIAL_GAP和MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先利用MySQL DUMPFILE技术在目标主机的系统目录投放恶意可执行文件，随后通过加密的自定义协议隧道（Fast Reverse Proxy）进行C2联通，紧接着尝试绕过AMSI检测来执行隐蔽的Powershell脚本，实现深度持久化与后门控制，揭示APT级多阶段攻击流程。"
  },
  "chain_13753": {
    "alerts_info": [
      "第1步攻击：T1003: WSHRAT发起针对目标系统的凭证窃取行为，下载具有凭证抓取模块的恶意组件，目标是收集和导出受害者操作系统中的账号密码等敏感信息。  从08/22/2024-23:10:16开始到08/22/2024-23:10:16结束，共1条，其关键特征为HTTP协议流量，服务器到受害主机（from_server）|HTTP响应码为200，表示文件成功下发|HTTP返回数据包含关键词\"get-pass-offline|7c|\"，为WSHRAT凭证抓取恶意模块特征",
      "第2步攻击：T1071.004: 该告警检测到利用DNS协议进行C2通信的行为，攻击者通过伪装正常的DNS请求与恶意C2服务端进行通信。这种方式可绕过传统出口监控，难以被检测，常被用于间谍软件、后门程序维持远程控制。  从08/23/2024-03:46:57开始到08/24/2024-16:12:31结束，共5条，其关键特征为DNS应答数据包中包含|00 01 00 01|，为标准A记录查询回应格式特征。|DNS查询名称内出现|03|（3字节标签长度）和随后含有'_domainkey'，与邮件安全机制伪装相关（模拟DKIM相关域名）。|DNS响应中嵌入了DKIM格式的内容，如'v=DKIM1; p='（公钥前缀），表明存在带有嵌入数据的伪造DNS文本记录。",
      "第3步攻击：T1071.004: 攻击者利用DNS协议作为命令与控制（C2）信道，向被控主机下发指令或接收数据。该规则检测到恶意软件（Win32_Ardamax Keylogger）发起到已知C2域名（asterscorner.wordpress.com）的DNS查询，表明其试图建立或维持远程指挥通道。  从08/29/2024-02:19:44开始到08/29/2024-02:19:44结束，共2条，其关键特征为DNS协议流量检测，查询域名为asterscorner.wordpress.com|content关键字匹配，限制查询数据包前26字节查找目标域名（depth:26），匹配结尾（endswith），不区分大小写（nocase）|该C2域名归属于已知的Win32_Ardamax键盘记录恶意软件，活动对象为客户端终端，告警级别为Major",
      "第4步攻击：T1071.004: 攻击者利用DNS协议作为命令与控制信道，将恶意数据封装在DNS请求中进行通信，从而绕过常规网络监控与出站流量检测。  从09/10/2024-20:54:15开始到09/15/2024-11:15:44结束，共6条，其关键特征为DNS查询内容包含20-80位的字母、数字、符号（-、_、.），格式疑似编码后内容|查询的域名以.com结尾，且中间含有[a-z]{2}\\d{2}特征字符串|数据包包含十六进制00 00 13 00 01，代表特定类型DNS查询"
    ],
    "此攻击链关联的原因": "链路以T1003凭证窃取为起点，接续多起基于DNS的C2与数据渗出（T1071.004），时间顺序及TTP演进具逻辑连贯性；辅助TTP如T1041、T1568.002强化了C2与隐蔽通信语义。部分环节存在POTENTIAL_GAP与MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过WSHRAT实施凭证窃取，随后分阶段使用多种DNS通道（如DKIM伪装、动态C2域名等）建立隐蔽远控C2通信，实现横向持久和敏感数据的外传渗透。多起DNS请求与特征数据表明攻击链呈现持续潜伏与递进演化态势。"
  },
  "chain_20197": {
    "alerts_info": [
      "第1步攻击：T1046: 该告警检测到ZxShell木马发起的端口扫描行为，属于攻击者发现目标网络中开放服务的常见技术。端口扫描常用于发现可用服务，从而为后续渗透和利用做准备。  从08/23/2024-03:17:12开始到08/23/2024-03:24:27结束，共7条，其关键特征为TCP协议下，从外部网络到内部网络的已建立流|内容匹配：TCP负载中包含字符串“PortScan”及“ip”|此行为指示ZxShell木马特有的扫描命令下发和执行操作",
      "第2步攻击：T1047: 检测到流量中包含WMIC命令提示符，表明攻击者很可能利用WMIC进行远程命令执行或管理目标主机，主要用于横向移动以获取对更多系统的访问权限。  从08/23/2024-05:40:36开始到08/23/2024-05:40:36结束，共3条，其关键特征为TCP协议，已建立会话|通信内容包含字符串 'wmic:root\\cli>'|通信方向为从内部网络到外部网络，提示为攻击响应流量，管理命令可能已被远程执行",
      "第3步攻击：T1562.004: 攻击者通过系统命令（如netsh）禁用或绕过主机防火墙，以规避检测并允许后续恶意活动（如数据渗出、远程控制等）。本告警检测到netsh防火墙相关输出，表明防火墙配置被修改或禁用。  从08/24/2024-09:15:04开始到08/24/2024-09:15:04结束，共1条，其关键特征为检测内容包含'netsh firewall|22| is deprecated|3b|'——识别系统防火墙配置相关输出|检测内容包含'use |22|netsh advfirewall'——表明与防火墙操作相关的系统消息|tcp流中存在'Ok.'输出，结合context为Windows命令行操作的响应",
      "第4步攻击：T1572: 攻击者利用自定义协议隧道（如Fast Reverse Proxy协议），绕过网络监控和防御系统，实现与受控主机之间的隐蔽命令与控制通信。此行为匹配Hydrochasma相关的恶意活动，使用自定义的加密TLS流量进行的Fast Reverse Proxy连接。  从08/26/2024-22:54:01开始到08/27/2024-00:13:45结束，共10条，其关键特征为TCP协议，目标为$EXTERNAL_NET|特定的TLS握手指纹——前14字节匹配|10 61 62 16 03 01 00 ee 01 00 00 ea 03 03|，为Hydrochasma Fast Reverse Proxy通信特征|流量方向为内网到外网，且已建立连接（flow:established,to_server），用于命令控制目的",
      "第5步攻击：T1114: 检测到恶意软件尝试通过邮件方式收集和导出密码文件（pwd.txt）的内容。该行为属于电子邮件内容收集，并使用脚本邮件客户端（Blat）自动封装敏感数据。  从09/17/2024-13:23:54开始到09/17/2024-13:23:54结束，共2条，其关键特征为TCP协议，经过邮件协议路径（to_server, established）|邮件主题包含 'Contents of file: pwd.txt'，表明是凭证文件内容|自定义邮件头 'X-Mailer: Blat v'，说明使用Blat工具进行自动化发信"
    ],
    "此攻击链关联的原因": "以TTPs顺序（发现→横向移动→防御规避→C2→数据收集）串联，时序明确。2020087与前后有一段时间间隔，为POTENTIAL_GAP。T1572、T1114均为内网到外网的渗透/外发行为，具备攻击链合理连续性。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击首先利用ZxShell进行端口扫描（发现阶段），随后通过WMIC完成远程命令和横向移动，进一步通过netsh相关命令禁用主机防火墙实现隐蔽（可能存在时间间隔），随后建立Fast Reverse Proxy自定义协议的C2通信以维持远控，最终通过邮件协议自动外发凭证文件，形成了完整的内网渗透、控制到数据泄露攻击链。"
  },
  "chain_5358": {
    "alerts_info": [
      "第1步攻击：T1205: 恶意软件利用HTTP POST请求，以模仿正常的Web流量实现对C2服务器的通信和安装报告，这有助于规避流量检测和防御措施。  从08/23/2024-05:01:12开始到08/23/2024-05:01:12结束，共1条，其关键特征为HTTP协议POST方法，指向外部网络（$EXTERNAL_NET）|请求体中包含字段 'to='，常用于邮件或配置参数字段|'Optix Pro v' 和 'Server Online' 字样，指示此为Optix Pro远控木马安装成功后的主动汇报行为",
      "第2步攻击：T1620: 此告警检测到了针对iPhone安装的恶意植入工具（implant）与C2服务器通信的特征，属于攻击者在目标移动设备上成功执行恶意二进制或脚本的环节。该implan能在手机上远程运行命令，并将后续命令与数据作为multipart/form-data格式，通过边界字符串进行发送。  从08/26/2024-20:47:09开始到08/27/2024-11:33:01结束，共3条，其关键特征为HTTP请求头包含'multipart/form-data; charset=utf-8; boundary=9ff7172192b7'|流量方向为内部iOS设备访问外部服务器（已建立，to_server）|命中iOS implant相关威胁情报（参考Project Zero分析文章）",
      "第3步攻击：T1071.001: Lodu Stealer使用定制的User-Agent字符串（如R2i2c5h2i6e5）通过HTTP协议与外部C2服务器通信，实现命令接收或信息回传。  从09/20/2024-13:22:56开始到10/07/2024-07:43:15结束，共7条，其关键特征为HTTP协议流量，方向为内网客户端到外部服务器（to_server）|自定义User-Agent字段，字符串内容为R2i2c5h2i6e5|流量建立于已建立的HTTP会话，目标为EXTERNAL_NET"
    ],
    "此攻击链关联的原因": "三条告警主TTP均表现为通过HTTP协议与外部C2通信。T1205（恶意流量规避）→T1620（implant已执行与C2交互）→T1071.001（以HTTP建立隐蔽C2会话），时间线递进，主链条合理，但部分环节存在POTENTIAL_GAP/MISSING_STEP，行为特征均落在C2、远控及渗透阶段。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链展现为针对不同受害终端（Optix Pro木马、iPhone implant、Lodu Stealer）通过HTTP通道与外部C2服务器交互，流量伪装和协议行为隐蔽，表现出植入-控制-数据回传的完整攻击流程，覆盖了恶意植入、持久远控及凭证或数据窃取等关键阶段。"
  },
  "chain_14710": {
    "alerts_info": [
      "第1步攻击：T1566.001: 攻击者通过电子邮件等渠道发送带有隐藏恶意宏的Office XML文档，诱导受害者打开，以实现初始访问。  从08/23/2024-09:02:21开始到08/23/2024-09:02:21结束，共1条，其关键特征为HTTP协议通信，内容从外部网络回应至内部网络，方向为from_server|文件数据中包含“<?xml”和“<?mso-application progid=\"Word.Document\"?>”信息，显示为Office XML格式|文档中声明“macrosPresent=\"yes\"”，表明文件内部嵌入了宏，存在潜在风险",
      "第2步攻击：T1204.002: 该告警检测到主机通过HTTP协议下载可疑可执行文件（bitcoin-miner.exe），符合攻击者利用钓鱼或其他手段诱导用户下载和执行恶意可执行文件的执行阶段战术。  从08/24/2024-12:22:15开始到08/24/2024-13:45:29结束，共4条，其关键特征为HTTP流量中uri包含/bitcoin-miner.exe，且使用正则表达式精确匹配下载请求|HTTP请求头部包含Connection字段，但不包含常见的Accept、Referer、User-Agent头，表现为非正常自动化下载流量|已知恶意文件（MSIL/Downcoin.B）的下载请求，对应hash: 6ad385f2b1161f2cff4e6ccc10e648b6",
      "第3步攻击：T1059.005: 攻击者通过利用恶意VBScript（如'poc.vbs'），结合'cscript'命令行工具执行脚本，达成初步代码执行。Hunter Exploit Kit的落地页可能诱导浏览器/脚本引擎下载并执行VBS恶意代码，实现主机控制。  从08/26/2024-10:30:18开始到08/26/2024-10:30:18结束，共3条，其关键特征为HTTP流量，通过GET方式获取'poc.vbs'脚本|内容包含关键字符串'ADODB.Stream'与'cscript'，指向脚本写文件与执行功能|流量为源自外网到内网，且HTTP响应阶段file_data触发，符合Exploit Kit常见传递载荷落地行为",
      "第4步攻击：T1574.002: 攻击者利用目标系统对deskpan.dll库的不安全加载行为（即未严格指定库的完整路径），通过在目标易加载目录下放置恶意deskpan.dll，实现代码执行并绕过防御。  从08/28/2024-18:10:55开始到08/28/2024-18:10:55结束，共1条，其关键特征为流量方向为内网主机到外部网络的SMB（端口139）会话，操作发生在已建立的会话中。|SMB请求包中包含deskpan.dll文件名，SMB Unicode格式，使用特定payload（offset:4, depth:5, |ff|SMB|a2|标识）。|payload定位与deskpan.dll关键字结合，并带有CVE-2011-1991相关特征，利用Windows组件库加载漏洞。",
      "第5步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/07/2024-16:19:22开始到09/07/2024-16:19:22结束，共2条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递",
      "第6步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从09/04/2024-11:55:12开始到09/04/2024-11:55:12结束，共4条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第7步攻击：T1113: 该规则检测到通过伪装为PNG图片的HTTP GET请求下载恶意文档（Maldoc），这是用于初期收集和传送载荷的一种手法。攻击者常利用此手法绕过内容过滤或检测，将恶意文档藏于图片流量中，暗中将其提供给受害主机。  从09/04/2024-11:59:59开始到09/04/2024-11:59:59结束，共4条，其关键特征为HTTP协议，GET方法|URI包含“.PNG?”特征路径，伪装为图片请求|HTTP请求头部无Referer字段，异常请求来源",
      "第8步攻击：T1573.001: 告警检测到APT28（奇幻熊/Fancy Bear）利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从09/11/2024-21:43:48开始到09/11/2024-21:43:48结束，共5条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "链条以钓鱼邮件（T1566.001）为起点，后续出现诱导下载与执行（T1204.002,T1059.005）、持久化（T1574.002,T1053.005）、输入捕获与敏感数据收集（T1056.001,T1113），直至加密C2通信（T1573.001），TTP序列完整且时间递进。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击活动以通过嵌入恶意宏的钓鱼文档达成初始访问，进而诱导用户下载并执行恶意可执行文件和VBS脚本。攻击者利用DLL劫持与高权限计划任务实现持久化，随后部署键盘记录器和伪装图片的恶意文档收集敏感信息。最终，恶意流量被加密并通过C2渠道回传，形成一条完整的递进式多阶段APT攻击链。"
  },
  "chain_14598": {
    "alerts_info": [
      "第1步攻击：T1203: 该告警检测的是通过Metasploit框架传递特定payload实现客户端代码执行的行为，攻击者通过HTTP POST方式提交特征编码的数据，意图触发目标客户端执行恶意代码。  从08/23/2024-10:14:04开始到08/23/2024-10:14:04结束，共1条，其关键特征为HTTP协议中的POST方法，向外部网络发送请求。|请求体中存在Base64编码特征字符串（如'b3NfbmFtZT'），表明数据被编码传输。|正则表达式匹配大块Base64内容，结合指定payload命名与Metasploit攻击相关。",
      "第2步攻击：T1140: 该告警检测到恶意程序通过出站流量发送环境变量（如ALLUSERSPROFILE、APPDATA等）信息，这类行为常见于恶意代码试图解码或解析本地环境信息以规避检测，调整自身行为，或定制后续攻击载荷。  从08/24/2024-09:41:06开始到08/24/2024-09:41:06结束，共1条，其关键特征为请求内容包含多个Windows主机环境变量（ALLUSERSPROFILE=、APPDATA=、CLIENTNAME=等）|流量方向为内部主机到外部主机(Outbound, to_server)，协议为TCP|典型出现在恶意软件或后门试图建立C2通信或泄露环境凭据时",
      "第3步攻击：T1547.001: 检测到Win32.TrojanProxy类木马下载其配置文件，这通常用于实现或维持该恶意软件的持久化。在目标主机上持续运行代理型木马程序，通常会通过配置文件下发命令和C2信息，保证木马自动启动与反复控制。  从08/26/2024-14:02:48开始到08/26/2024-14:02:48结束，共1条，其关键特征为HTTP协议传输，流量方向为服务器到客户端（from_server）|配置文件内容含有标志性字符串“@$@”，并紧接base64编码结构（详见正则规则）|敏感文件传递常出现在POST响应体或文件型URL路径",
      "第4步攻击：T1082: OceanLotus（APT32）通过恶意JavaScript（如linkStorage.x00SOCKET）收集受害主机的配置信息和系统环境，用于后续攻击阶段或更有针对性地部署有效载荷。攻击者通常伪装这些恶意脚本以绕过检测并收集关键信息，包括操作系统、浏览器、硬件及网络状态等。  从08/28/2024-08:33:17开始到08/28/2024-08:33:17结束，共1条，其关键特征为HTTP流量，目标为web客户端（HTTP到客户端，已建立连接）|JS内容特征——出现linkStorage.x00SOCKET字符串，表明涉及特定恶意JavaScript（与OceanLotus相关）|通信方向为外部到内部（$EXTERNAL_NET -> $HOME_NET），通常为系统探针型恶意载荷",
      "第5步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从09/06/2024-18:48:52开始到09/06/2024-18:48:52结束，共3条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端",
      "第6步攻击：T1497.001: 攻击者利用脚本或命令行（如PowerShell）访问系统信息（如Win32_ComputerSystem）以判断环境是否为虚拟机，从而实现反沙箱或反虚拟化检测，规避自动化安全分析。  从09/30/2024-09:17:18开始到09/30/2024-09:17:18结束，共2条，其关键特征为HTTP响应状态码为200，表示服务端有响应且请求内容成功返回。|PowerShell关键字Get-WmiObject调用，用于远程获取WMI对象信息。|内含Win32_ComputerSystem和-match \"VIRTUAL\"字样，在检测主机是否虚拟化方面具有特定针对性。",
      "第7步攻击：T1119: 攻击者利用恶意工具（HYPERSCRAPE）实现自动化方式从受害终端收集数据。在本规则中，外发特定HTTP GET请求用于与攻击者控件通信，可能携带了被盗取或自动收集的数据。  从10/14/2024-11:22:09开始到10/14/2024-11:22:09结束，共2条，其关键特征为HTTP请求方法为GET|请求URI路径为/Index.php?vubc=，暗示为攻击工具特征化路径|特殊HTTP请求头顺序（Host, Accept-Encoding，与工具通信特征有关）",
      "第8步攻击：T1573.001: 告警检测到APT28（奇幻熊/Fancy Bear）利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从11/18/2024-15:34:42开始到12/14/2024-20:54:10结束，共7条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。",
      "第9步攻击：T1071.001: 该Snort规则检测到PCRat/Gh0st远控木马在被控主机上通过TCP协议与外部C2服务器通信，特征内容表明属于基于应用层协议（如HTTP/WebSocket/tcp定制协议）的数据通道。此行为符合攻击者通过已感染主机与C2服务器实现持续通信与远程控制的战术。  从01/25/2025-06:25:29开始到01/25/2025-06:25:29结束，共2条，其关键特征为检测到已知的PCRat/Gh0st C2通信特征码 |7d 94|，并在特定位置（偏移8处）。|TCP出站流量，通信方向为本地受害主机到外部潜在C2服务器；同时要求已建立的会话（flow:established,to_server）。|消息体长数据包判据，固定模式的payload正则匹配:pcre:\"/^.{4}[\\x20-\\x7e]+?.{4}\\x7d\\x94/s\"，用于归定位于该恶意家族的通信模式。"
    ],
    "此攻击链关联的原因": "基于TTP时序推进和语义衔接：初始执行（T1203）、环境解码（T1140）、持久化（T1547.001）、信息收集（T1082）、凭证与数据收集（T1056.001/T1119）、虚拟化规避（T1497.001）、加密C2与数据出站（T1573.001/T1071.001）。部分步骤间存在MISSING_STEP及POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链从Metasploit远程代码执行（初始访问），到恶意程序环境变量解码与主机探测，木马配置持久化、恶意脚本收集系统信息、键盘记录与数据外传，再经反虚拟化检测。后续包含工具化高频数据打包，APT专用加密C2通道，最终通过远控木马与外部持续通信。覆盖完整攻击生命周期，显现高度自动化与隐蔽性。"
  },
  "chain_9838": {
    "alerts_info": [
      "第1步攻击：T1027.002: 该告警匹配到Yoda's Protector 打包工具生成的特征码，属于恶意软件通过打包程序混淆恶意二进制，从而逃避防病毒软件或安全检测的常见方式。  从08/23/2024-10:17:12开始到08/23/2024-10:35:01结束，共6条，其关键特征为检测到Yoda's Protector打包特征字节流：E8 03 00 00 00 EB 01 和 BB 55 00 00 00 E8 03 00 00 00 EB 01|流方向为已建立连接且数据流来自服务器（from_server）|针对通过TCP协议任意端口，通常与恶意软件下发或回传阶段有关",
      "第2步攻击：T1057: 攻击者利用PowerShell（通过winmgmts对Win32_Process类的InstancesOf调用）列举目标主机上正在运行的进程，以收集系统情报，支持后续操作。例如，可用于检测安全软件、发现感兴趣的进程，或辅助提权及持久化。  从08/24/2024-07:03:11开始到08/24/2024-07:03:11结束，共2条，其关键特征为HTTP协议流量，响应码为200，方向为服务器到客户端（from_server）|HTTP响应体以字符串“winmgmts:.InstancesOf(\"Win32_Process”开头，表明使用WMI和PowerShell枚举进程|内容排除常见网页HTML文档（!DOCTYPE html），更像是PowerShell脚本输出",
      "第3步攻击：T1071.001: 检测到内部主机尝试访问ICQ服务，ICQ常被用于C2通信，攻击者可能通过HTTP协议中的自定义User-Agent字段与外部ICQ服务器进行隐蔽通信。  从08/29/2024-23:18:57开始到08/30/2024-01:05:47结束，共7条，其关键特征为HTTP协议流量|HTTP头部User-Agent包含\"ICQ\"字符串|通信方向为内向外（to_server），目标为EXTERNAL_NET",
      "第4步攻击：T1053.005: 检测到利用schtasks命令在受害系统上创建计划任务并以SYSTEM权限执行，通常用于维持持久性、规避权限限制、自动执行恶意载荷。  从09/03/2024-04:30:44开始到09/03/2024-04:30:44结束，共1条，其关键特征为检测到下发schtasks /create /RL HIGHEST /RU SYSTEM命令，说明试图高权限创建Windows计划任务|流量为已建立TCP会话，方向为to_client，且不是典型HTTP数据流（非HTTP/1.标识头部）|未检测到常规Web服务端头部（如Server:），说明可能为定制C2通信或二进制协议传递"
    ],
    "此攻击链关联的原因": "按照TTP链路顺序推断，先检测到恶意二进制混淆（T1027.002），之后通过PowerShell枚举主机进程（T1057），再用HTTP-ICQ进行外部通信（T1071.001），最终通过schtasks创建高权限持久任务（T1053.005）；虽然部分阶段存在间隔，整体语义与行为相符，但存在POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "本攻击链描述了恶意软件首先通过Yoda's Protector混淆自身，规避检测，随后用PowerShell枚举主机进程以收集情报，继而与外部ICQ服务通过HTTP通信实现C2控制，并最终在主机上创建高权限计划任务以维持持久化访问。阶段间虽有时间跨度，但符合APT活动的渐进模式。"
  },
  "chain_14889": {
    "alerts_info": [
      "第1步攻击：T1059.005: 攻击者通过利用WScript.Shell对象和Run方法，在目标主机上执行Visual Basic脚本代码。这通常用于通过脚本远程执行恶意命令或加载其他威胁载荷。  从08/23/2024-14:35:21开始到08/23/2024-14:40:58结束，共7条，其关键特征为包含WScript.Shell关键字，表明攻击目标为Windows脚本宿主对象|出现.Run方法调用，是恶意脚本常用于执行系统命令的特征|利用CreateObject函数实例化WScript.Shell对象，通常与远程命令注入、渗透脚本执行相关",
      "第2步攻击：T1055: 本告警检测到了对存在漏洞的 Microsoft Windows cmd.exe 的远程访问横幅信息，说明攻击者可能通过利用远程命令执行漏洞获取了高级权限。此类行为常用于权限提升，通过漏洞或者后门以管理员权限执行命令。  从09/13/2024-10:19:45开始到09/13/2024-10:19:45结束，共2条，其关键特征为检测到TCP会话中包含'String: Microsoft Windows '与版权信息，表明响应内容为Windows命令行界面横幅|起始端口号非21-23（排除了FTP和Telnet常见端口），暗示访问为非标准服务暴露|流量方向属于内网主机出站至外部（$HOME_NET -> $EXTERNAL_NET），可能表明内网主机被攻击后进行外部交互",
      "第3步攻击：T1068: 该规则检测到利用Windows Print Spooler组件（CVE-2016-3239）本地权限提升漏洞的攻击行为，攻击者可通过特定手段，将自身权限从普通用户提升为系统级别权限。  从10/24/2024-18:02:23开始到11/27/2024-03:51:03结束，共2条，其关键特征为检测HTTP流量方向为from_server,established，通常与客户端主动请求服务器相关；|包含字符串特征'C:\\Windows\\System32\\spool\\PRINTERS'，明确指向Spooler系统路径；|恶意内容中包含'SPL'与'NtSetInformationFile'，指向在数据包中操控或篡改打印文件对象的低层系统调用，关联漏洞利用。"
    ],
    "此攻击链关联的原因": "主链以命令执行（T1059.005）为起点，权限提升（T1055、T1068）为后续，符合TA0002→TA0004逐步升级攻防链。T1055通过sec_ttps（T1059.003）衔接前一节点，形成合理TTP推进，时间顺序连贯，但第一步到第二步关联略弱，已标记辅助TTP关联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过VBScript脚本（T1059.005）实现主机命令执行，随后进一步远程访问Windows cmd.exe利用异常漏洞实现初步权限提升（T1055），最终利用Print Spooler组件漏洞（T1068）获得系统级权限，形成一条完整的深入渗透与权限升高攻击链，覆盖主机脚本攻击、远程命令利用与操作系统本地提权。"
  },
  "chain_24206": {
    "alerts_info": [
      "第1步攻击：T1556.002: 攻击者通过模拟浏览器内弹出的伪造认证窗口，诱骗受害者输入敏感信息（如凭证），实现窃取。该方法通常用于鱼叉式钓鱼，令用户误以为自己正在与合法服务进行交互。  从08/24/2024-03:15:21开始到08/31/2024-09:42:01结束，共6条，其关键特征为HTTP响应状态码为200（成功响应）|内容包含可映射BITB攻击的JS变量名（如ileft、itop、draggable、addClass、window、exit、titleBar）|流量方向为外部到内部，HTTP响应，内容特征符合完全模拟浏览器伪登录窗口的JavaScript实现",
      "第2步攻击：T1078.002: 攻击者利用SQL服务器的UNC路径处理漏洞，可将数据库备份操作引导到攻击者控制的远程共享（UNC路径），以潜在地获取或持久化对目标环境的访问。此攻击可绕过传统的安全防护，建立持久后门。  从09/12/2024-13:24:56开始到09/23/2024-18:41:17结束，共3条，其关键特征为TCP流量，方向为EXTERNAL_NET→HOME_NET，且为已建立的会话，流向服务器|SQL语句内容包含'BACKUP'、'TO'、'DISK'等关键字|SQL命令中DISK目标为形如'\\\\<任意UNC路径>'（即远程Windows共享）",
      "第3步攻击：T1048.003: 该告警检测到恶意软件利用SMTP协议（端口587，常用于邮件传输）将收集到的敏感信息（如凭证）通过电子邮件发出，实现数据渗出。  从10/08/2024-01:34:16开始到01/14/2025-14:47:41结束，共12条，其关键特征为目的端口为587（SMTP Submission），与邮件相关的应用层协议|邮件内容中存在特定字符串如“PassReg”和“BlatBoundary”，与已知恶意软件行为特征相符|内容字段“name=\"pass.””出现，结合Blat工具特征，说明可能是通过脚本或工具批量提交凭证"
    ],
    "此攻击链关联的原因": "基于TTP链条（钓鱼欺骗登录→利用SQL漏洞持久化→通过SMTP进行数据出境）及时间先后，三条告警推测构成同一攻击链。第二步与第一步TTP有跳跃，疑似存在MISSING_STEP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过伪造浏览器登录窗口进行鱼叉钓鱼，诱导受害者泄露凭证，随后利用数据库UNC漏洞实现持久性访问，并最终通过SMTP协议批量发送收集到的敏感信息用于数据出境。整个过程涵盖初始渗透、后门建立及敏感数据外流等关键阶段。"
  },
  "chain_17393": {
    "alerts_info": [
      "第1步攻击：T1059.003: 检测到远程主机打开了基于 CMD 的远程 Shell 通信，这通常用于攻击者远程执行命令，操作目标主机。  从08/24/2024-09:22:14开始到08/24/2024-09:22:17结束，共5条，其关键特征为TCP协议，主机已建立到服务器方向的连接|特定二进制内容：'00 00 00 13|CMD session opened|2e 00 00 00 01 00 00 00'|流量载荷包含 'qMicrosoft Windows' 标识，表明与Windows系统相关",
      "第2步攻击：T1547.001: 攻击者通过下发或修改含Winlogon相关注册表项的.reg文件，尝试改变系统登录行为或实现持久化，在用户登录时自动启动恶意程序。  从08/25/2024-01:12:38开始到08/25/2024-01:12:38结束，共1条，其关键特征为.reg文件以HTTP传输，文件内容以Unicode格式包含Winlogon注册表路径（含HKEY_LOCAL_MACHINE\\...\\Winlogon）|HTTP响应码为200（从外部下发/服务器响应成功）|注册表内容中明确指定explorer.exe作为启动程序，指纹特征聚焦Winlogon自动登录、Shell启动相关",
      "第3步攻击：T1055: 检测到MSIL/ChaosBounce RAT远控木马通过processManager模块下发KILL命令，可能用于终止安全产品或其他系统进程，实现防御绕过或维持持久控制。  从09/02/2024-18:43:51开始到10/14/2024-03:10:45结束，共6条，其关键特征为TCP流量（established,from_server方向）数据包长度小于300字节|内容包含关键字顺序：|00|, Packet, processManager, List, Kill|关联ChaosBounce RAT家族，出现在未知来源到内网主机的会话中，具系统进程管理能力",
      "第4步攻击：T1573.001: 告警检测到APT28（奇幻熊/Fancy Bear）利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从11/26/2024-20:38:09开始到01/13/2025-13:09:22结束，共8条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "基于TTP顺序与长期时间线推断形成攻击链（远程Shell初始执行→Winlogon注册表持久化→内存操作/进程控制（远控RAT）→加密C2通信）。部分阶段间存在时间跨度（POTENTIAL_GAP），主要依赖攻击战术逻辑与相符行为特征关联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过远程Shell成功获得主机控制，随后利用Winlogon注册表实现系统层持久化。后续通过RAT远控模块进行进程管理及控制，最终使用定制SSL证书建立加密C2通道，确保数据和指令安全流转，形成一条贯穿初始渗透、持久化、控制到隐蔽通信的完整APT攻击链。"
  },
  "chain_12756": {
    "alerts_info": [
      "第1步攻击：T1040: 攻击者试图通过修改ADSL路由器的DNS设置，将网络流量重定向到恶意DNS服务器，从而实现对凭据或敏感数据的窃取。此举允许攻击者在用户不知情的情况下进行中间人攻击。  从08/25/2024-09:15:33开始到08/25/2024-09:18:19结束，共4条，其关键特征为HTTP请求中包含参数dnsPrimary=与dnsSecondary=，指示试图修改主/备DNS服务器。|包含Enable_DNSFollowing=1参数，这是设备配置中典型的DNS跟随功能启用标志。|请求针对D-Link DSL-2640R等ADSL路由器管理接口，主要定位于IoT设备。",
      "第2步攻击：T1059.001: 攻击者利用PowerShell脚本在受害主机上远程执行恶意代码。此技术常被用于下载、解密和运行恶意Payload。  从09/03/2024-03:41:01开始到10/11/2024-07:22:37结束，共17条，其关键特征为文件传输中包含字符串 powershell.exe，指明为PowerShell脚本交付/执行行为|检测到Base64编码的字符串 'LgBEAGUAZgBsAGEAdABlAFMAdAByAGUAYQBt'，为混淆后的PowerShell命令数据|HTTP协议 file_data 匹配，流量来源为外部到内部主机，方向为from_server，暗示下载行为"
    ],
    "此攻击链关联的原因": "推断链条基于攻击TTP的时间顺序与行为递进，前序路由器DNS篡改（T1040）为后续PowerShell恶意代码远程执行（T1059.001）创造持久流量劫持条件，存在TTP语义及阶段衔接。中间步骤缺失，符合高级威胁跳跃情形（MISSING_STEP）。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先以HTTP协议远程更改ADSL路由器DNS，实现对流量的劫持和中间人攻击。随后利用劫持完成恶意PowerShell脚本远程下载与执行，进一步入侵内网主机。链路覆盖了初始入侵、网络操控到持久化植入，体现典型多阶段入侵路径。"
  },
  "chain_21565": {
    "alerts_info": [
      "第1步攻击：T1204: 该告警检测到通过HTTP协议的可执行文件传输，特征串涉及Windows API函数，表明可能存在通过利用CVE-2016-3219（MS16-051，Internet Explorer内存破坏漏洞）触发恶意代码执行的攻击。此攻击需要用户或浏览器主动解析恶意内容，属于用户执行场景。  从08/26/2024-11:18:09开始到08/26/2024-11:34:51结束，共3条，其关键特征为涉及HTTP协议，方向为外部到内部（EXTERNAL_NET -> HOME_NET）|检测到文件内容中包含多个Windows API函数名称：如SHGetKnownFolderPath、GetModuleFileName、QueryDosDevice、GetFileAttributes等|利用CVE-2016-3219，指向Internet Explorer内存破坏漏洞，通过HTTP下载可执行内容",
      "第2步攻击：T1621: 恶意软件通过HTTP POST请求将被感染设备的通讯录（联系人姓名及电话号码）上传至远程服务器，实现对隐私数据的窃取与外泄。  从09/02/2024-09:57:25开始到09/02/2024-09:57:25结束，共1条，其关键特征为HTTP POST请求，目标URI包含/api/contacts/，用于上传联系人信息。|User-Agent字段为okhttp/，表明使用Android常见HTTP库发起通信。|HTTP请求体中包含JSON字段'name'与'phone_number'，且缺少Referer头部。",
      "第3步攻击：T1517: 攻击者通过移动恶意软件收集受害者的设备敏感信息，如IMEI、电话号、SIM信息等，通过HTTP请求发送到远程服务器。  从10/10/2024-19:14:48开始到10/10/2024-19:14:48结束，共1条，其关键特征为HTTP GET请求，路径包含 /mailing/insertar_user_app.php?，且带有多个参数如login, pass, imei, phone_number等|User-Agent或其他HTTP头部包含 'Android' 字样，定位为Android恶意软件流量|请求URL长度大于600字符，通常用于携带大量敏感数据进行外发",
      "第4步攻击：T1573: 攻击者通过加密的网络通道（如自定义加密协议或SSL/TLS）与被控终端进行远程管理和通信，以便规避检测和流量分析。本规则检测Win32/XWorm V3恶意家族与C2服务器建立的加密指令通信。  从01/05/2025-16:22:54开始到01/05/2025-16:22:54结束，共4条，其关键特征为匹配特定的十六进制C2通信特征流：c8 63 98 10 09 b8 ef f8 73 99 b0 45 d7 24 32 5c|TCP协议，流量方向从内部主机到外部C2服务器，处于已建立的连接|判定条件中指定该活动每个源IP在300秒内只触发一次，用于抑制重复告警"
    ],
    "此攻击链关联的原因": "基于TTP顺序，时间先后，前期利用浏览器漏洞初始访问（T1204），随后出现Android恶意软件信息收集与隐私数据外泄（T1621/T1517），最终建立加密C2通道（T1573）；中间阶段TTP间存在一定跳跃，部分步骤缺失，链路通过攻击行为语义关联。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击链以通过IE漏洞诱导用户执行恶意代码作为入口，继而在设备上引入Android恶意软件，阶段性实现联系人、设备信息等私密数据的收集与外泄。最后受控终端与外部C2建立加密通道，实现远程操控和进一步信息窃取。整个过程涵盖初始访问、数据收集、隐私外泄至C2通信的多阶段攻击。"
  },
  "chain_10226": {
    "alerts_info": [
      "第1步攻击：T1027: 攻击者通过对有效载荷进行混淆（如Base64编码）并将其伪装为合法的MP3文件（在HTTP响应头部指定Content-Type: audio/mpeg），以试图绕过安全检测与文件类型审查，实现防御规避。  从11/20/2024-18:42:11开始到11/20/2024-19:03:42结束，共4条，其关键特征为HTTP响应状态码为200，内容类型为audio/mpeg，表明文件被伪装为MP3音频。|文件有效载荷以Base64方式包含可执行文件魔数MZ（TVqQ...是MZ头的Base64编码），对应可执行文件特征。|特征内容位于文件前部且与特定哈希匹配，表明有已知的恶意样本关联（reference: md5,25af48964606009b7b158cddac7a0b94）。",
      "第2步攻击：T1218.011: 攻击者利用Windows自带的CertUtil工具来下载和执行恶意可执行文件（.exe），以绕过安全检测并规避防御措施。CertUtil常被合法使用，因此易于被滥用，成为Living-off-the-land Binaries (LOLBins)的一部分。  从08/27/2024-19:16:12开始到08/27/2024-19:16:12结束，共1条，其关键特征为http请求URI结尾为.exe，表明请求可能是用于下载Windows可执行文件|User-Agent字段为'CertUtil URL Agent'，显示是用CertUtil工具发起的HTTP请求|HTTP头部顺序和内容极为特定且缺少Referer、Cookie和Accept-字段，指向自动化、非浏览器工具的下载行为",
      "第3步攻击：T1055: 攻击者可能利用heap spray技术向目标进程的堆内存注入特定的shellcode（如0x0d0d0d0d），以逃避检测绕开安全设备，实现任意代码执行。  从10/09/2024-21:00:55开始到10/09/2024-21:00:55结束，共2条，其关键特征为HTTP协议流量（因flow:established,to_client及alert http）|存在连续的0x0d0d0d0d内容（content:\"0x0d0d0d0d\"）|流量为外部到内部，基于已建立会话",
      "第4步攻击：T1056.001: 该告警检测到Possessor键盘记录器通过HTTP协议将捕获到的按键信息（如用户输入）记录并发送出网络。键盘记录属于输入捕获技术，用于非法收集用户输入的敏感信息。  从09/17/2024-15:26:32开始到09/17/2024-15:26:32结束，共4条，其关键特征为HTTP GET 请求，URI包含 .php?urll=，以及 &msg= 和 &fil= 参数|HTTP 请求包缺少常见头部（User-Agent、Accept、Referer）|已知 Possessor 键盘记录器家族的恶意通信行为，针对 Windows 系统客户端"
    ],
    "此攻击链关联的原因": "链条中各告警以防御规避（如混淆有效载荷、利用LOLBins工具下载）、代码注入及最终敏感数据捕获为主线，TTP顺序基本符合攻击链逻辑，存在行为语义和工具利用的自然过渡。部分环节存在MISSING_STEP，时间上有POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先通过将恶意可执行文件伪装为MP3音频并混淆（防御规避），再利用CertUtil下载工具将恶意文件传至本地。后续通过heap spray技术实现恶意代码注入及逃避检测，最终部署键盘记录器，持续窃取敏感用户输入信息并通过网络外传，整个过程具备高度隐蔽性及持续性。"
  },
  "chain_829": {
    "alerts_info": [
      "第1步攻击：T1140: 检测到HTTP请求URL中存在Base64编码且疑似恶意（字符串“aGFja2Vk”解码后为“hacked”），攻击者常使用Base64编码隐藏命令、有效载荷、或将恶意内容隐藏于通信之中，从而规避检测。  从08/30/2024-01:22:38开始到08/30/2024-01:25:03结束，共4条，其关键特征为HTTP请求的URL中出现Base64编码的字符串（例如“aGFja2Vk”）|HTTP请求未包含Referer头，常见于自动化工具、恶意流量或无Referer的攻击代码|通信方向为$HOME_NET发起至$EXTERNAL_NET，表示内部主机主动访问外部，可能为回连或数据外泄行为",
      "第2步攻击：T1082: 攻击者或恶意代码通过执行如 systeminfo 等命令收集受害主机的详细系统信息，包括主机名、操作系统版本、厂商、系统配置、处理器及安装信息等，以帮助评估目标环境和后续攻击活动。  从09/11/2024-14:06:59开始到09/11/2024-14:06:59结束，共1条，其关键特征为TCP协议，已建立的向外连接（HOME_NET 到 EXTERNAL_NET，to_server）|数据包内容包含典型的 Windows systeminfo 命令输出字段（Host Name、OS Name、OS Version、OS Manufacturer、Microsoft Corporation、Processor(s)等）|行为表现为客户端主机主动向外发送系统环境及配置信息，可能指向恶意代码或远控木马的活动",
      "第3步攻击：T1113: 检测到njRAT/Bladabindi Red Devil 变种正在通过网络发送屏幕截图，这属于恶意软件获取受害者主机屏幕内容进行窃密的行为。  从10/05/2024-09:30:25开始到11/08/2024-16:21:17结束，共8条，其关键特征为TCP已建立连接，目的地为EXTERNAL_NET|数据包负载包含特定标识CAP0101010100和JFIF（JPEG文件头）|malware_family: njrat，已知用于屏幕截图数据传输",
      "第4步攻击：T1105: 本Snort规则监测到以HTTP协议形式，从外部网络向内网主机下发的可疑VBS脚本（可能为木马下载器的Payload），属于攻击者通过命令与控制通道传输工具或恶意负载到受害系统典型行为。  从12/01/2024-23:53:18开始到12/01/2024-23:53:18结束，共4条，其关键特征为HTTP响应体中包含特定标签 <component>|VBS脚本语句出现GetDrive(\"C:\")等本地驱动器操作|Windows Installer相关关键词出现（如windowsinstaller.installer, InstallProduct, SerialNumber）",
      "第5步攻击：T1567: 该规则检测到受感染主机通过SMTP协议（25,587端口）向外部发送包含系统命令(cmd.exe)的数据，属于攻击者利用标准电子邮件协议进行数据渗出的行为。  从01/20/2025-10:44:54开始到01/20/2025-10:44:54结束，共2条，其关键特征为目的端口为25或587（SMTP标准端口），且向外部网络通信|邮件头中含有'X-Mailer: Microsoft CDO for Windows 2000'，说明可能由脚本/恶意程序自动构造并发送邮件|邮件体关键字中包含'[ C:\\WINDOWS\\system32\\cmd.exe ]'，指向与系统命令相关的信息报告"
    ],
    "此攻击链关联的原因": "以TTP时序推断出主线攻击链：先通过Base64编码HTTP通信，实现初始回连与隐藏通信（T1140/TA0005），后出现系统信息收集（T1082/TA0007）、屏幕抓取数据外传（T1113/TA0009），伴随后续恶意工具下载（T1105/TA0011）及最终SMTP协议下的数据外泄（T1567/TA0010）。部分环节间存在MISSING_STEP与POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "该攻击链展示了攻击者通过Base64加密隧道初始通信，成功植入后执行主机探测与屏幕抓取，接着通过C2通道下载VBS Payload工具，最终利用SMTP协议大量泄露主机命令及数据，体现窃密与多阶段渗透特征，攻击从隐蔽初始到数据外流完整闭环。"
  },
  "chain_3728": {
    "alerts_info": [
      "第1步攻击：T1547.014: 攻击者通过 CVE-2016-6662 漏洞可向 MySQL 配置文件注入恶意配置或 shell 命令，进而在目标系统重启或服务重启时获得持久化控制。  从08/30/2024-09:12:14开始到09/02/2024-18:43:39结束，共3条，其关键特征为目标端口为3306，MySQL数据库的默认端口|检测到使用unhex命令，并输入特定16进制内容（如一般日志配置/通用日志文件/配置文件路径等注入行为）|相关内容含67656e6572616c5f6c6f675f66696c65（general_log_file）、2e636e66（.cnf配置后缀）、6e6d616c6c6f635f6c6962（nmalloc_lib）等关键字，用于修改MySQL配置或恶意加载动态库",
      "第2步攻击：T1105: 该告警检测到ZxShell远程控制木马通过服务器向受害主机发送文件下载指令（DownFile -d），属于攻击者通过现有的命令和控制（C2）通道，将工具或恶意文件从外部服务器传送至受害主机的行为。  从09/10/2024-15:03:12开始到09/10/2024-15:03:12结束，共1条，其关键特征为特征流量方向为已建立TCP会话，从外部服务器到内网主机（flow: established,from_server）|HTTP协议内容包含关键字 'DownFile -d'（nocase, depth:11），代表ZxShell远程下发文件命令|流量内容中包含 'http' 字样，暗示利用HTTP协议作为命令与控制通道",
      "第3步攻击：T1071.001: 该告警检测到恶意软件（Win32/Cekar.B）通过HTTP协议与C2服务器进行通信，使用Web协议作为指挥与控制（C2）信道。攻击者利用常见的HTTP请求（如GET）隐藏C2流量，使其难以与普通流量区分。  从09/21/2024-03:21:17开始到09/23/2024-05:55:42结束，共5条，其关键特征为HTTP GET请求，固定长度URI（长度为8），且路径格式为/xxx.|特定HTTP头部结构：User-Agent和Host紧跟在请求头中，并以两个回车换行结束（|0d 0a 0d 0a|）|流量方向为本地网络到外部网络（to_server），且已经建立的HTTP会话",
      "第4步攻击：T1219: DanaBot 恶意软件通过启动VNC模块为攻击者提供远程控制受感染主机能力，这属于利用合法远程访问工具实现持久化与规避检测。  从09/27/2024-22:41:53开始到10/07/2024-01:13:44结束，共9条，其关键特征为TCP流量方向为已建立会话且从服务器端到客户端（可能为C2流量）|大量（dsize > 800 bytes）的数据包，含有VNC协议的特征码（如|00|V|00|N|00|C|00|）|数据包内出现带有DanaBot恶意VNC模块特征的二进制序列和结构化协议指纹",
      "第5步攻击：T1573.001: 告警检测到APT28（奇幻熊/Fancy Bear）利用XTunnel恶意软件，通过定制的SSL证书建立加密通信通道，实现与外部C2服务器的数据传输和远控指令下发，意图规避检测和内容拦截。  从10/14/2024-13:22:27开始到12/01/2024-09:07:03结束，共5条，其关键特征为侦测到流量使用特定SSL证书序列号（00:D2:78:F4:E3:B0:4A:69:3F）进行通信。|证书主题包含异常值，如C=XX，显示自签或仿冒特性。|告警流量方向为外部到内网，协议为TLS，可能为恶意C2通信行为。"
    ],
    "此攻击链关联的原因": "以TTP时间序列为主线，攻击链经历持久化、恶意文件下发与多步C2通信、远控及最终数据加密出网，行为和场景连贯。辅助TTP分析显示前后阶段为权限维持/工具获取、有迹象表明技术链条持续演进。",
    "关联的信心程度": "High",
    "此攻击链的关键事件和行为": "攻击者通过MySQL配置注入（持久化）与可能提权后，利用C2通道下载ZxShell等恶意工具，实现后台隐蔽通信。后续多种C2通信方式（HTTP、TLS）被用于远控或数据外传，期间启动DanaBot的VNC模块远程操作主机，最终通过XTunnel建立加密渠道对外传输数据，形成高度自动化与分阶段混合的APT攻击流程。"
  },
  "chain_4970": {
    "alerts_info": [
      "第1步攻击：T1588.003: 该Snort规则侦测到Havoc或Sliver渗透测试/攻击框架自签名的TLS证书，表明攻击方为了实施后续通信，提前生成并使用了可识别的恶意或伪造数字证书，实现与受害主机的加密通信。  从08/31/2024-15:38:40开始到09/02/2024-08:14:17结束，共3条，其关键特征为检测特定伪造X.509证书指纹（如国家为US、省份为Illinois、城市为Naperville等信息）|基于TLS协议且流向为to_client，表明为由恶意C2服务器返回证书至受害主机|证书特征引用了Havoc/Sliver公开代码仓库中的默认生成模板，易于关联到具体红队/恶意工具家族",
      "第2步攻击：T1027: 特征短小的网络流量和伪装的字符串如“getinfo”，表明恶意软件可能在尝试避免被检测到的数据外泄活动。  从09/09/2024-17:26:54开始到09/09/2024-17:26:54结束，共1条，其关键特征为TCP明文流量，端口4040到内部主机的任意端口|流量数据包长度为7字节，内容为'getinfo'|仅针对已建立连接的to_client流量，适配多代Windows操作系统及客户端终端",
      "第3步攻击：T1558.003: Rubeus是一种常用于Kerberos票据操作的攻击工具，被用于Kerberos TGT票据的窃取或操作。该告警指向此工具针对88端口（Kerberos服务）通信，通过非正常协议行为窃取或伪造Kerberos票据，实现凭据访问。  从10/05/2024-12:19:56开始到10/05/2024-12:19:56结束，共1条，其关键特征为目的端口为88，指向Kerberos服务|内容特征为十六进制|a7 06 02 04 6C 69 6C 00| —— 该特征与Rubeus伪造或操作Kerberos票据通信相关|相关威胁活动与FireEye披露的红队工具和异常Kerberos认证流量有关",
      "第4步攻击：T1021.001: 该规则检测SMB（端口139/445）上的特殊Impacket工具特征，攻击者通过利用远程SMB服务访问目标主机，通常用于横向移动或初始渗透，属于远程服务滥用的一种方式。  从11/02/2024-03:51:33开始到11/13/2024-18:29:44结束，共6条，其关键特征为SMB协议流量（端口139、445）|数据流中SMB协议头特征：|ff 53 4d 42| ('F','S','M','B')|Unicode字符串'Microsoft Security Center'出现在SMB流量内容中，指向Impacket工具的某种变体或obfuscation处理。",
      "第5步攻击：T1562.001: 该告警检测的是对PowerShell防护机制AMSI（Antimalware Scan Interface）的绕过尝试，攻击者常通过对AMSI的绕过来规避检测与拦截，从而隐藏恶意行为。  从01/20/2025-13:57:07开始到01/20/2025-13:57:07结束，共1条，其关键特征为HTTP流量且数据流向客户端（from_server）|含有<script>标签，对应可能恶意的网页脚本注入|包含特定的base64编码字符串（例如EAbQBzAGkASQBuAGkAdABGAGEAaQBsAGUAZ），常见于AMSI绕过payload"
    ],
    "此攻击链关联的原因": "按TTP时间顺序关联：先由C2证书准备（T1588.003），随后利用加密与混淆通信（T1027）；凭据获取（T1558.003）后远程SMB横移（T1021.001）再通过PowerShell-AMSI绕过实施持久化与隐藏（T1562.001）。部分TTP之间存在阶段跳跃，考虑长期渗透及TTP进阶，语义与行为连贯；其中存在TTP跳跃，已标记POTENTIAL_GAP。",
    "关联的信心程度": "Medium",
    "此攻击链的关键事件和行为": "攻击者首先生成伪造C2 TLS证书进行早期准备并搭建隐蔽通信（T1588.003），其后通过加密及轻混淆流量对内信息沟通（T1027），进一步窃取Kerberos票据以获取目标凭据（T1558.003）。随后利用SMB协议实施横向移动及资源渗透（T1021.001），最终通过高级PowerShell与AMSI绕过技术实施恶意代码执行与隐藏（T1562.001），展现较长链的渐进式APT攻击路径。"
  }
}